<view class='help'>
  <button class='kefu-btn' open-type='contact'>
    <view class='xm-kefu'></view>
  </button>
</view>
<view wx:if="{{viewMode}}" style=' background-color: #fff;height: 100%;left:0;top:0;width: 100%;z-index: 99;font-size: 14px;position: fixed;text-align: center;vertical-align: middle;display: inline-block;color: rgb(111, 116, 116);opacity: 1;'>



  <!-- viewmode -->
  <view class='xm-homework-item' style='border-bottom:7px solid #F8F8F8;' wx:if="{{notify.feedback_count>0&&notify.need_feedback}}">
    <view class='xm-homework-cell'>
      <view class='xm-homework-data-detail'>
        <view>
          <view style='float:left;' wx:if="{{avatar_start_more}}">
            <view class='feedback_avatar_view'>
              <view>
                <image wx:if="{{avatar_start_more}}" class='xm-homework-data-detail-image' style='width:30px;height:30px;margin:3px;' src='../../image/popmore.png'></image>
              </view>
            </view>
          </view>
          <block wx:for="{{avatar_between}}" wx:key="id">
            <view style='float:left;' id="{{item.wx_openid}}">
              <view class='feedback_avatar_view'>
                <view>
                  <image wx:if="{{item.wx_openid==select_feedback.wx_openid}}" class='avator-select' src='{{item.wx_avatar}}'></image>
                  <image wx:else class='xm-homework-data-detail-image' style='width:30px;height:30px;margin:3px;' src='{{item.wx_avatar}}'></image>
                </view>
              </view>
            </view>
          </block>
          <view style='float:left;' wx:if="{{avatar_end_more}}">
            <view class='feedback_avatar_view'>
              <view>
                <image wx:if="{{avatar_end_more}}" class='xm-homework-data-detail-image' style='width:30px;height:30px;margin:3px;' src='../../image/popmore.png'></image>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <view class="weui-cells__title msg_tip" style='margin-top:0px;height: 40px;line-height: 40px;background-color:white;margin-bottom:10px;border-bottom:7px solid #F8F8F8;text-align:left;'>左右滑动可翻页，双击屏幕空白处可点赞</view>


  <swiper style='height:100%' current='{{currentSwiper}}' bindchange="bindchange" duration="250" indicator-active-color="#1e90ff">
    <block wx:for="{{accepts}}" wx:for-item="selectFeedback">
      <swiper-item bindtap='doubleTap' item-id="{{selectFeedback.wx_openid}}">
        <view class='container'>

          <view class="feed-item">
            <view class="feed-source">
              <view class="feed-avatar" style=" display: flex;justify-content: space-between;">
                <image style='width:35px;height:35px;' src="{{selectFeedback.wx_avatar}}"></image>
                <view style=" display: flex;flex-direction: column;justify-content: space-between;">
                  <text style="color:black;font-weight:500;font-size:15px;margin-top:2px;">{{selectFeedback.name}}{{selectFeedback.relatives_role}}</text>
                  <text style="font-size:24rpx;color:#c5c0c0;text-align:left;">{{selectFeedback.friendly_create_at}}</text>
                </view>
              </view>
              <view class="feed-time" wx:if="{{selectFeedback.is_ower}}">
                <label style='  padding: 5px;border: 1px solid #1e90ff;color: #1e90ff;border-radius: 6px;font-size:13px' bindtap='resubmit'> 重新提交</label>
              </view>
            </view>
            <view class="feed-content" data-id="{{selectFeedback._id}}">
              <view class="feed-content-text">
                <view wx:if="{{selectFeedback.feedback_text}}" style='text-align:left;'>
                  <text>{{selectFeedback.feedback_text}}</text>
                </view>
              </view>
              <view class="feed-content-image">
                <block wx:for="{{selectFeedback.feedback_photo_url}}" wx:for-index="idx" wx:for-item="it">
                  <image wx:if="{{selectFeedback.feedback_photo_url.length==1}}" data-imgurls="{{selectFeedback.big_feedback_photo_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:120px;margin-left:5px;height:120px;" data-imgUrl="{{selectFeedback.big_feedback_photo_url[idx]}}"
                    src="{{it}}"></image>
                  <image wx:elif="{{selectFeedback.feedback_photo_url.length==2}}" data-imgurls="{{selectFeedback.big_feedback_photo_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;margin-left:5px;width:80px;height:80px;" data-imgUrl="{{selectFeedback.big_feedback_photo_url[idx]}}"
                    src="{{it}}"></image>
                  <image wx:elif="{{selectFeedback.feedback_photo_url.length==3}}" data-imgurls="{{selectFeedback.big_feedback_photo_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;margin-left:5px;width:80px;height:80px;" data-imgUrl="{{selectFeedback.big_feedback_photo_url[idx]}}"
                    src="{{it}}"></image>
                  <image wx:elif="{{selectFeedback.feedback_photo_url.length>3}}" data-imgurls="{{selectFeedback.big_feedback_photo_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;margin-left:5px;height:80px;width:80px" data-imgUrl="{{selectFeedback.big_feedback_photo_url[idx]}}"
                    src="{{it}}"></image>
                </block>
              </view>
              <view wx:if="{{selectFeedback.feedback_video_url}}">
                <view class="feed-content-video">
                   <navigator url='../video/video?src={{selectFeedback.feedback_video_url}}'>
                    <view style='text-align:left;position:relative;width:100px;height:100px'>
                      <image style='width:100px;height:100px' src='{{selectFeedback.feedback_video_url+aliyunVideoCoverExt}}'></image>
                      <image src="/image/play.png" mode="widthFix" style="width:30px;height:30px;position:absolute;top:40%;left:40%;;background-position: center center; background-repeat: no-repeat; " />
                    </view>
                  </navigator>
                </view>
              </view>

              <view style='margin-top:5px;' wx:if="{{selectFeedback.feedback_record_url}}">
                <view style='margin-left:10px;' data-record_id="{{selectFeedback._id}}" data-record="{{selectFeedback.feedback_record_url}}" data-from="list" class='xm-record-play-btn' bindtap='playStart' hover-class='xm-record-play-btn-hover'>
                  <view wx:if="{{current_record_id==selectFeedback._id}}">
                    <image animation="{{playAnimation}}" style='height:15px;width:15px;' src='../../image/record-msg.png'></image>
                  </view>
                  <view wx:else>
                    <image style='height:15px;width:15px;' src='../../image/record-msg.png'></image>
                  </view>
                  <view>{{selectFeedback.record_duration}}'' </view>
                </view>
              </view>
            </view>

            <view class="feed_footer">
              <view wx:if="{{selectFeedback._id==current_rate_id}}" style='background-color: #666;color: #fff;border-radius: 8px;'>
                <block wx:for="{{[1,2,3,4,5]}}" wx:for-item="i">
                  <text wx:if="{{selectFeedback.rate.value>=i}}" bindtap="setRate" id="{{selectFeedback._id}}" data-rate="{{i}}" class="xm-evaluate-cmd-rate_red"></text>
                  <text wx:else bindtap="setRate" id="{{selectFeedback._id}}" data-rate="{{i}}" class="xm-evaluate-cmd-rate"></text>
                </block>
              </view>
              <view wx:if="{{notify.is_owner}}" hover-class="btn_hover" class="feed-position-wrap" bindtap="showRate" id="{{selectFeedback._id}}">
                <text class="{{selectFeedback.rate.value>0?'xm-evaluate-rated':'xm-evaluate-rate'}}" style='margin-right:10px'></text>
              </view>
              <view hover-class="btn_hover" class="feed-position-wrap" bindtap="like" id="{{selectFeedback._id}}">
                <text class="{{selectFeedback.is_liked?'xm-evaluate-liked':'xm-evaluate-like'}}" style='margin-right:10px'></text>
              </view>
              <view class="feed-action">
                <view wx:if="{{love_icon=='like'}}" class="feed-action-item" style="margin-right:20rpx ">
                  <text wx:if="{{selectFeedback.is_like&&selectFeedback._id==current_id}}" class="liked-text" style="{{style_img}}"> {{selectFeedback.like_count}}</text>
                  <text wx:elif="{{selectFeedback.is_like}}" class="liked-text"> {{selectFeedback.like_count}} </text>
                  <text wx:else class="like-text" bindtap="likePost" data-id="{{selectFeedback._id}}"> {{selectFeedback.like_count}} </text>
                </view>
                <view hover-class="btn_hover" class="feed-action-item" data-id="{{selectFeedback._id}}" catchtap="showComment" hover="true" hover-start-time="1000" hover-start-time="50" hover-class="feed-item-hover">
                  <text class="reply-text" style='color:#1e90ff'> {{selectFeedback.reply_count}}</text>
                </view>
              </view>
            </view>
            <view wx:if="{{selectFeedback.rate.value>0||selectFeedback.reply.length>0||selectFeedback.like.length}}" style='margin-top:8rpx;border-top:1rpx solid #F8F8F8;padding-top:7px;font-size:13px;text-align:left;'>
              <view class="xm-comment-rate" wx:if="{{selectFeedback.rate.value>0}}">{{selectFeedback.rate.from_name}}老师给了本次作业{{selectFeedback.rate.value}}颗星</view>
              <view class="xm-comment-liked" wx:if="{{selectFeedback.like.length>0}}">
                {{selectFeedback.likeStr}}觉得这个作业反馈很赞</view>
              <block wx:for="{{selectFeedback.reply}}" wx:for-item="j">
                <view wx:if="{{j.is_top}}" data-id="{{selectFeedback._id}}" data-dialogid="{{j.dialog_id}}" bindtap="showComment" data-tid="{{j.from_openid}}" data-tname="{{j.from_name}}" data-trole="{{j.from_role}}" class="xm-comment-text">
                  <text style='font-weight: bold'>{{j.from_name}}{{j.from_roleStr}}:</text>{{j.content}}</view>
                <view wx:else class="xm-comment-text" data-id="{{selectFeedback._id}}" data-dialogid="{{j.dialog_id}}" bindtap="showComment" data-tid="{{j.from_openid}}" data-tname="{{j.from_name}}" data-trole="{{j.from_role}}">
                  <text style='font-weight: bold'>{{j.from_name}}{{j.from_roleStr}} : </text>回复
                  <text style='font-weight: bold'>{{j.to_name}}{{j.to_roleStr}}:</text>{{j.content}}</view>
              </block>
            </view>
          </view>

          <view style='padding:10px;text-align:left;width:100%' wx:if="{{notify.is_owner}}">
            <view style='text-align:left;margin-left:15px'>
              <text style='font-size:15px'>评分:</text>
              <block wx:for="{{[1,2,3,4,5]}}" wx:for-item="i">
                <text wx:if="{{selectFeedback.rate.value>=i}}" bindtap="setRate" id="{{selectFeedback._id}}" data-rate="{{i}}" class="xm-rate_red_swiper xm-rate"></text>
                <text wx:else bindtap="setRate" id="{{selectFeedback._id}}" data-rate="{{i}}" class="xm-rate_swiper xm-rate"></text>
              </block>
              <text style='font-size:15px' wx:if="{{selectFeedback.rate.value>0}}">{{selectFeedback.rate.value}} 颗星</text>
            </view>
          </view>
        </view>
        <view style='margin:50px'>
          <text bindtap='closeViewMode' class="category-cell-pub-close"></text>
        </view>



      </swiper-item>
    </block>


  </swiper>


  <image wx:if="{{liking}}" animation="{{likeAnimation}}" style='height:15px;width:15px;top:{{liketop}}px;left:{{likeleft}}px;position:fixed;' src='../../image/liking.png'></image>
</view>


<view class="page" wx:if="{{loaded&&!viewMode}}">
  <view class="page" wx:if="{{mode=='notify'}}">
    <!-- border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6; -->
    <view class='xm-homework-status' wx:if="{{!from}}" style=' border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;display:flex;justify-content:space-between;width:100%;background-color:#fff;font-size:16px;font-weight: bold;'>


      <view hover-class="btn_hover" class='xm-homework-confirm' style="color:#535a60;border-bottom:2px solid #1e90ff;  flex: 1;text-align: center;padding:6px 0px;">
        <view style='border-right:1px solid #e6e6e6;'>{{notify.class_name}}{{notify.type==0?'作业':'通知'}}</view>
      </view>

      <view class='xm-homework-feedback' bindtap='morehomework' hover-class="btn_hover" style='color:#535a60;  flex: 1;text-align: center;padding:6px 0px;'> 回到首页</view>
    </view>

    <view>
      <view class='xm-homework-item'>

        <view class='xm-homework-cell' bindtap="detail" id="{{notify._id}}">
          <view class='xm-homework-title' style='display:flex;width:100%;line-height:35px;'>
            <view style='flex:3'>{{notify.title}}</view>
            <view style='flex:1;display:flex;' wx:if="{{notify.is_owner}}">

              <button style='  border: 0px solid #353535;display: inline;padding-left: 3px;padding-right: 0px;font-size: 16px;' class='xm-member-tip_button' bindtap='showRemark' plain="true" size="mini"> </button>
              <button style='  border: 0px solid #353535;display: inline;padding-left: 3px;padding-right: 0px;font-size: 16px;' class='xm-member-share_button' open-type="share" plain="true" size="mini"> </button>
              <button style='  border: 0px solid #353535;display: inline;padding-left: 3px;padding-right: 0px;font-size: 16px;' class='xm-member-del_button' bindtap='delNotify' plain="true" size="mini"> </button>
            </view>
          </view>
        </view>
        <view class='xm-homework-cell' wx:if="{{notify.text_content}}" bindtap="detail" id="{{notify._id}}">
          <view class='xm-homework-text_content1' style='width:100%'>
            <text style='line-height:30px'>{{notify.text_content}}</text>

          </view>
        </view>




        <view class='xm-homework-cell' wx:if="{{notify.photo_content_url.length>0}}">
          <view>
            <block wx:for="{{notify.photo_content_url}}" wx:for-index="idx" wx:for-item="it">
              <image wx:if="{{notify.photo_content_url.length==1}}" data-imgurls="{{notify.big_photo_content_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:120px;height:120px;" data-imgUrl="{{notify.big_photo_content_url[idx]}}" src="{{it}}"></image>
              <image wx:elif="{{notify.photo_content_url.length==2}}" data-imgurls="{{notify.big_photo_content_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;height:90px;width:90px;margin-left:5px;" data-imgUrl="{{notify.big_photo_content_url[idx]}}"
                src="{{it}}"></image>
              <image wx:elif="{{notify.photo_content_url.length==3}}" data-imgurls="{{notify.big_photo_content_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;height:90px;width:90px;margin-left:5px;" data-imgUrl="{{notify.big_photo_content_url[idx]}}"
                src="{{it}}"></image>
              <image wx:elif="{{notify.photo_content_url.length>4}}" data-imgurls="{{notify.big_photo_content_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;height:90px;width:90px;margin-left:5px;" data-imgUrl="{{notify.big_photo_content_url[idx]}}"
                src="{{it}}"></image>
            </block>
          </view>
        </view>

        <view class='xm-homework-cell' wx:if="{{notify.record_content_url}}">

          <view style='margin-left:10px;width:100%' data-record_id="{{notify._id}}" data-record="{{notify.record_content_url}}" data-from="notify" class='xm-record-play-btn' bindtap='playStart' hover-class='xm-record-play-btn-hover'>
            <image animation="{{playAnimation}}" style='height:15px;width:15px;' src='../../image/record-msg.png'></image>
            <view>{{notify.record_duration}}'' </view>
          </view>

        </view>


        <view class='xm-homework-cell' wx:if="{{notify.video_content_url}}">
        <view wx:if="{{notify.video_content_url}}">
                <view class="feed-content-video">
                  <navigator url='../video/video?src={{notify.video_content_url}}'>
                    <view style='text-align:left;position:relative;width:150px;height:150px'>
                      <image style='width:150px;height:150px' src='{{notify.video_content_url+aliyunVideoCoverExt}}'></image>
                      <image src="/image/play.png" mode="widthFix" style="width:40px;height:40px;position:absolute;top:40%;left:40%;;background-position: center center; background-repeat: no-repeat; " />
                    </view>
                  </navigator>
                </view>
              </view>
          <!-- <view style='text-align:center'>
            <video style='width:{{winWidth-25}}px' src='{{notify.video_content_url}}'></video>
          </view> -->
        </view>

        <view wx:if="{{notify.remark}}" class='xm-homework-cell'>
          <view class='xm-homework-tip'> 备注：{{notify.remark}}
            <text style='margin-left:5px' bindtap='showRemark' class='xm-homework-edit-tip'></text>
          </view>
        </view>

        <view wx:if="{{notify.need_feedback}}" class='xm-homework-cell'>
          <view class='xm-homework-feedback_type' style='width:100%'> 反馈方式：{{notify.feedback_typeEx}}
            <!-- <text wx:if="{{notify.feedback_type==4}}" style='font-size:12px;margin-left:10px;color:#282828	'><text style='font-size:15px'>提示</text>(
            <text style='color:#686868'>:由于微信限制,视频长度请保持在1分钟以内</text>)</text> -->
          </view>
        </view>


        <view class='xm-homework-cell'>
          <view class='xm-homework-confirm_rate' style='margin-right:5px;flex:2'> 确认率:
          </view>
          <view style='flex:5'>
            <progress percent="{{accept_rate}}" show-info color="{{accept_rate<30?'#FF0000':(accept_rate<60?'#FF9966':'#32CD32')}}" stroke-width="15" active="true" style='width:100%;' />
          </view>
          <view style='flex:1'>({{notify.accept_count}}/{{notify.cls_all_parent_number}})</view>
        </view>

        <view class='xm-homework-cell' wx:if="{{notify.need_feedback}}">
         <view class='xm-homework-confirm_rate' style='margin-right:5px;flex:2'> 反馈率:
          </view>
          <view style='flex:5'>
            <progress percent="{{feedback_rate}}"  show-info color="{{feedback_rate<30?'#FF0000':(feedback_rate<60?'#FF9966':'#32CD32')}}" stroke-width="15" active="true" style='width:100%;' />
          </view>

          <view style='flex:1'>({{notify.feedback_count}}/{{notify.cls_all_parent_number}})</view>


        </view>


        <view class='xm-homework-cell' wx:if="{{!show_more}}">
          <view class='xm-homework-show' bindtap='showMore' style="text-align: center;width: 100%;">展示更多</view>
        </view>



        <view class='xm-homework-cell' wx:if="{{show_more}}">
          <view class='xm-homework-class_name'> 班级：{{notify.class_name}}</view>
        </view>


        <view wx:if="{{notify.need_feedback&&show_more}}" class='xm-homework-cell'>
          <view class='xm-homework-end_day'> 截止日期：{{notify.end_day}}</view>
        </view>


        <view class='xm-homework-cell' wx:if="{{show_more}}">
          <view class='xm-homework-hide' bindtap='showMore' style="text-align: center;width: 100%;">收起</view>
        </view>


      </view>

      <!-- 错题名单 -->
      <view class='xm-homework-item' wx:if="{{selected_category}}">
        <view class='xm-homework-cell'>
          <view class='xm-homework-wrong-anwser-name' catchlongpress="copyNames" style='font-size:15px'>
            第
            <label style='font-size:19px'>{{selected_category}}</label>题做错的名单如下
            <!-- (<label style='font-size:12px'>长按名单可以复制</label>) -->
            <view style='margin-top:10px'>
              {{selected_category_names}}
              <label bindtap='copyNames' style='font-size:12px;color:#4285f4'>复制名单</label>
            </view>
          </view>
        </view>
      </view>


      <view class="container" wx:if="{{notify.feedback_count>0&&notify.need_check}}">
        <view class="title">
          错误情况统计
        </view>
        <canvas canvas-id="columnCanvas" bindtouchstart="touchHandler" class="canvas"></canvas>
        <view style="text-align:center;font-size:14px;color:#859098">点击数据每一项查看答错学生名单</view>
      </view>



      <!-- 家长确认列表 -->
      <view class='xm-homework-item' wx:if="{{notify.accept_count>0}}">
        <view class='xm-homework-cell'>
          <view class='xm-homework-data-detail'>
            <view>{{notify.accept_count}}位家长确认收到{{notify.type==0?'作业':'通知'}}</view>
            <view>
              <block wx:for="{{notify.accepts}}" wx:key="id">
                <view style='float:left;'>
                  <view class='feedback_avatar_view'>
                    <view>
                      <image class='xm-homework-data-detail-image' src='{{item.wx_avatar}}'></image>
                    </view>
                    <view style='font-size:11px'>{{item.name}}{{item.relatives_role}}</view>
                  </view>
                </view>
              </block>
            </view>
          </view>
        </view>
      </view>



      <!-- 家长确认列表 -->
      <view class='xm-homework-item' wx:if="{{notify.need_feedback&&notify.feedback_count>0}}">
        <view class='xm-homework-cell'>
          <view class='xm-homework-data-detail'>
            <view>{{notify.cls_all_parent_number-notify.feedback_count}}位家长未反馈

              <label bindtap='unFeedbackTipOneClick' wx:if="{{(notify.cls_now_parent_number)>(notify.feedback_count)&&notify.is_owner}}" style=' margin-right:5px;margin-left:5px; padding: 3px;border: 1px solid #1e90ff;color: #1e90ff;border-radius: 6px;font-size:12px' class="weui-msg__link" hover-class='xm-record-play-btn-hover'>一键提醒</label>

              <label bindtap='copyUnfeedback' wx:if="{{(notify.cls_now_parent_number)>(notify.feedback_count)&&notify.is_owner}}" style='font-size:12px;margin-right:5px' class="weui-msg__link">复制名单</label>

              <label bindtap='goUnfeedbackTip' wx:if="{{(notify.cls_all_parent_number)>(notify.cls_now_parent_number)&&notify.is_owner}}" style='font-size:12px' class="weui-msg__link">查看说明</label>
            </view>
            <view>
              <block wx:for="{{notify.unfeedbacks}}" wx:key="id">
                <view style='float:left;'>
                  <view class='feedback_avatar_view'>
                    <view>
                      <image wx:if="{{item.wx_avatar}}" class='xm-homework-data-detail-image' src='{{item.wx_avatar}}'></image>
                      <image wx:else class='xm-homework-data-detail-image' src='http://campus002.oss-cn-beijing.aliyuncs.com/weijiaru2.png'></image>
                    </view>
                    <view style='font-size:11px'>{{item.name}}家长</view>
                  </view>
                </view>
              </block>

              <view style='float:left;' bindtap='goUnfeedbackTip' wx:if="{{(notify.cls_all_parent_number)>(notify.cls_now_parent_number)}}">
                <view class='feedback_avatar_view'>
                  <view>
                    <image wx:if="{{item.wx_avatar}}" class='xm-homework-data-detail-image' src='{{item.wx_avatar}}'></image>
                    <image wx:else class='xm-homework-data-detail-image' src='../../image/weizhi.png'></image>
                  </view>
                  <view style='font-size:11px'>..??家长</view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>





      <!-- 家长反馈列表 -->
      <view class='xm-homework-item' wx:if="{{notify.feedback_count>0&&notify.need_feedback&&!viewMode}}">
        <view class='xm-homework-cell'>
          <view class='xm-homework-data-detail'>
            <view>{{notify.feedback_count}}位家长已反馈
              <!-- 已经反馈或者是老师角色同时不是视频反馈类型 -->
              <label wx:if="{{(notify.is_feedback||role=='teacher')&&notify.feedback_type!=4}}" style='font-size:13px;color:#859098'>(点击头像可看反馈内容)</label>
            </view>
            <view>
              <block wx:for="{{accepts}}" wx:key="id">
                <view style='float:left;' bindtap='setViewMode' id="{{item.wx_openid}}">
                  <view class='feedback_avatar_view'>
                    <view>
                      <image class='xm-homework-data-detail-image' src='{{item.wx_avatar}}'></image>
                    </view>
                    <view style='font-size:11px'>{{item.name}}{{item.relatives_role}}</view>
                  </view>
                </view>
              </block>
            </view>
          </view>
        </view>
      </view>




      <view wx:if="{{!viewMode&&notify.feedback_count>0&&(notify.is_feedback||role=='teacher')}}" class="container" style='font-size:14px;padding-bottom: 30px;margin-top:5px'>
        <view style='font-size:17px'>反馈情况</view>
        <view style='margin:10px;'>
          <label wx:if="{{notify.is_owner}}" style=' margin-right:3px; padding: 5px;border: 1px solid #1e90ff;color: #1e90ff;border-radius: 6px;font-size:12px' bindtap='likeOneClick'> 已反馈作业一键点赞</label>
          <label style=' margin-left:3px;  padding: 5px;border: 1px solid #1e90ff;color: #1e90ff;border-radius: 6px;font-size:12px' bindtap='setViewMode'> 切换为左右滑动模式</label>

        </view>
        <block wx:for="{{accepts}}" wx:for-item="item">

          <view class="feed-item">
            <view class="feed-source">
              <view class="feed-avatar" style=" display: flex;justify-content: space-between;">
                <image src="{{item.wx_avatar}}"></image>
                <view style=" display: flex;flex-direction: column;justify-content: space-between;">
                  <text style="color:black;font-weight:500;font-size:31rpx;margin-top:2px;">{{item.name}}{{item.relatives_role}}</text>
                  <text style="font-size:24rpx;color:#c5c0c0">{{item.friendly_create_at}}</text>
                </view>
              </view>
              <view class="feed-time" wx:if="{{item.is_ower}}">
                <label style='  padding: 5px;border: 1px solid #1e90ff;color: #1e90ff;border-radius: 6px;font-size:13px' bindtap='resubmit'> 重新提交</label>
              </view>
            </view>
            <view class="feed-content" data-id="{{item._id}}">
              <view class="feed-content-text">
                <view wx:if="{{item.feedback_text}}">
                  <text>{{item.feedback_text}}</text>
                </view>
              </view>
              <view class="feed-content-image">
                <block wx:for="{{item.feedback_photo_url}}" wx:for-index="idx" wx:for-item="it">
                  <image wx:if="{{item.feedback_photo_url.length==1}}" data-imgurls="{{item.big_feedback_photo_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:120px;margin-left:4px;height:120px;" data-imgUrl="{{item.big_feedback_photo_url[idx]}}" src="{{it}}"></image>
                  <image wx:elif="{{item.feedback_photo_url.length==2}}" data-imgurls="{{item.big_feedback_photo_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;margin-left:4px;height:80px;width:80px;" data-imgUrl="{{item.big_feedback_photo_url[idx]}}"
                    src="{{it}}"></image>
                  <image wx:elif="{{item.feedback_photo_url.length==3}}" data-imgurls="{{item.big_feedback_photo_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;margin-left:4px;height:80px;width:80px;" data-imgUrl="{{item.big_feedback_photo_url[idx]}}"
                    src="{{it}}"></image>
                  <image wx:elif="{{item.feedback_photo_url.length>3}}" data-imgurls="{{item.big_feedback_photo_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;margin-left:4px;height:80px;width:80px;" data-imgUrl="{{item.big_feedback_photo_url[idx]}}"
                    src="{{it}}"></image>
                </block>
              </view>
              <view wx:if="{{item.feedback_video_url}}">
                <view class="feed-content-video">
                  <navigator url='../video/video?src={{item.feedback_video_url}}'>
                    <view style='text-align:left;position:relative;width:150px;height:150px'>
                      <image style='width:150px;height:150px' src='{{item.feedback_video_url+aliyunVideoCoverExt}}'></image>
                      <image src="/image/play.png" mode="widthFix" style="width:40px;height:40px;position:absolute;top:40%;left:40%;;background-position: center center; background-repeat: no-repeat; " />
                    </view>
                  </navigator>
                </view>
              </view>

              <view style='margin-top:5px;' wx:if="{{item.feedback_record_url}}">
                <view style='margin-left:10px;' data-record_id="{{item._id}}" data-record="{{item.feedback_record_url}}" data-from="list" class='xm-record-play-btn' bindtap='playStart' hover-class='xm-record-play-btn-hover'>
                  <view wx:if="{{current_record_id==item._id}}">
                    <image animation="{{playAnimation}}" style='height:15px;width:15px;' src='../../image/record-msg.png'></image>
                  </view>
                  <view wx:else>
                    <image style='height:15px;width:15px;' src='../../image/record-msg.png'></image>
                  </view>
                  <view>{{item.record_duration}}'' </view>
                </view>
              </view>

            </view>

            <view class="feed_footer">
              <view wx:if="{{item._id==current_rate_id}}" style='background-color: #666;color: #fff;border-radius: 8px;'>
                <block wx:for="{{[1,2,3,4,5]}}" wx:for-item="i">
                  <text wx:if="{{item.rate.value>=i}}" bindtap="setRate" id="{{item._id}}" data-rate="{{i}}" class="xm-evaluate-cmd-rate_red"></text>
                  <text wx:else bindtap="setRate" id="{{item._id}}" data-rate="{{i}}" class="xm-evaluate-cmd-rate"></text>
                </block>
              </view>
              <view wx:if="{{notify.is_owner}}" hover-class="btn_hover" class="feed-position-wrap" bindtap="showRate" id="{{item._id}}">
                <text class="{{item.rate.value>0?'xm-evaluate-rated':'xm-evaluate-rate'}}" style='margin-right:10px'></text>
              </view>
              <view hover-class="btn_hover" class="feed-position-wrap" bindtap="like" id="{{item._id}}">
                <text class="{{item.is_liked?'xm-evaluate-liked':'xm-evaluate-like'}}" style='margin-right:10px'></text>
              </view>
              <view class="feed-action">
                <view wx:if="{{love_icon=='like'}}" class="feed-action-item" style="margin-right:20rpx ">
                  <text wx:if="{{item.is_like&&item._id==current_id}}" class="liked-text" style="{{style_img}}"> {{item.like_count}}</text>
                  <text wx:elif="{{item.is_like}}" class="liked-text"> {{item.like_count}} </text>
                  <text wx:else class="like-text" bindtap="likePost" data-id="{{item._id}}"> {{item.like_count}} </text>
                </view>
                <view hover-class="btn_hover" class="feed-action-item" data-id="{{item._id}}" bindtap="showComment" hover="true" hover-start-time="1000" hover-start-time="50" hover-class="feed-item-hover">
                  <text class="reply-text" style='color:#1e90ff'> {{item.reply_count}}</text>
                </view>
              </view>
            </view>
            <view wx:if="{{item.rate.value>0||item.reply.length>0||item.like.length}}" style='margin-top:8rpx;border-top:1rpx solid #F8F8F8;padding-top:7px;font-size:13px;'>
              <view class="xm-comment-rate" wx:if="{{item.rate.value>0}}">{{item.rate.from_name}}老师给了本次作业{{item.rate.value}}颗星</view>
              <view class="xm-comment-liked" wx:if="{{item.like.length>0}}">
                {{item.likeStr}}觉得这个作业反馈很赞</view>
              <block wx:for="{{item.reply}}" wx:for-item="j">
                <view wx:if="{{j.is_top}}" data-id="{{item._id}}" data-dialogid="{{j.dialog_id}}" bindtap="showComment" data-tid="{{j.from_openid}}" data-tname="{{j.from_name}}" data-trole="{{j.from_role}}" class="xm-comment-text">
                  <text style='font-weight: bold'>{{j.from_name}}{{j.from_roleStr}}:</text>{{j.content}}</view>
                <view wx:else class="xm-comment-text" data-id="{{item._id}}" data-dialogid="{{j.dialog_id}}" bindtap="showComment" data-tid="{{j.from_openid}}" data-tname="{{j.from_name}}" data-trole="{{j.from_role}}">
                  <text style='font-weight: bold'>{{j.from_name}}{{j.from_roleStr}} : </text>回复
                  <text style='font-weight: bold'>{{j.to_name}}{{j.to_roleStr}}:</text>{{j.content}}</view>
              </block>
            </view>
          </view>

        </block>
        <view class="black_padding"></view>
      </view>
      <view wx:else>
        <view class="black_padding"></view>
      </view>





      <view class='confirm-fixed' style='background-color:white' wx:if="{{role=='parent'&&!notify.is_accept}}">
        <form report-submit="true" bindsubmit="confirm">
          <button class="weui-btn btn_confirm_info btn_without_border" type="primary" id="{{notify._id}}" formType="submit" style='background-color:#1e90ff;width:{{winWidth}}px;border-radius:opx;box-sizing:content-box'> 确认收到{{notify.type==1?'通知':'作业'}}</button>
        </form>
      </view>


      <view  id="{{notify._id}}"  class='confirm-fixed' hover-class='confirm-fixed-hover' wx:elif="{{role=='parent'&&notify.type==0&&!notify.is_feedback&&notify.need_feedback}}">
        <!-- <view>已完成作业？点击这里反馈</view> -->
        <form report-submit="true" bindsubmit="feedback">
          <button class="weui-btn btn_confirm_info btn_without_border" data-feedback_type="{{notify.feedback_type}}" type="primary" id="{{notify._id}}" formType="submit" style='background-color:#1e90ff;width:{{winWidth}}px;border-radius:opx;box-sizing:content-box'>已完成作业？点击这里反馈</button>
        </form>
      </view>

      <view bindtap='answer' id="{{notify._id}}" class='confirm-fixed' hover-class='confirm-fixed-hover' wx:elif="{{role=='parent'&&notify.type==0&&notify.need_check&&!notify.is_checked}}">
        <view>点击这里完成对错题的标注</view>
      </view>
    </view>
  </view>



  <view class="page" wx:if="{{false&&notify.feedback_type==0&&mode=='photo'}}" xmlns:wx="http://www.w3.org/1999/xhtml">
    <form bindsubmit="submit" report-submit="true">
      <view class="page__bd">
        <view class="weui-cells__title">点击这里进行拍照反馈</view>
        <view class="weui-cells weui-cells_after-title">
          <view class="weui-cell">
            <view class="weui-cell__bd">
              <textarea class="weui-textarea" name="feedback_text" placeholder="请输入内容" style="height: 3.3em" />
              <!-- <view class="weui-textarea-counter">0/200</view> -->
            </view>
          </view>
          <view class="weui-uploader__bd" style='padding:2px 7px'>
            <view class="weui-uploader__files" id="uploaderFiles">
              <block wx:for="{{selectedImgs}}" wx:key="*this">
                <view class="weui-uploader__file" bindtap="previewImage" id="{{item}}" style='position:relative'>
                  <image style='width:60px;height:60px;border:1px solid #ddd;' class="weui-uploader__img" src="{{item}}" mode="aspectFill" />
                  <view class="weui-badge" id="{{item}}" catchtap='removeImg' style='position:absolute;top:-0.1em;right:-0.4em;background-color:#bbb8b8;'>X</view>
                </view>
              </block>
            </view>
            <view class="weui-uploader__input-box" style='width:60px;height:60px'>
              <view class="weui-uploader__input" bindtap="chooseImage"></view>
            </view>
          </view>
        </view>
        <view class="weui-btn-area">
          <button class="weui-btn btn_save_info" data-file_type="images" disabled="{{disabled}}" type="primary" formType="submit" style='background-color:#1e90ff'> 确认提交</button>
        </view>
      </view>
    </form>
  </view>



  <view class="page" style='background-color:#fff;' wx:if="{{mode=='check'}}" xmlns:wx="http://www.w3.org/1999/xhtml">
    <form bindsubmit="answerSubmit" report-submit="true">
      <view class="weui-cells__title">下方为本次作业的正确答案</view>
      <view class='xm-homework-item'>

        <view class='xm-homework-cell' bindtap="detail" id="{{notify._id}}">
          <view class='xm-homework-text_content'> {{notify.answer_text_content}}</view>
        </view>

        <view class='xm-homework-cell' wx:if="{{notify.answer_photo_content_url.length>0}}">
          <block wx:for="{{notify.answer_photo_content_url}}" wx:for-index="idx" wx:for-item="it">
            <image wx:if="{{notify.answer_photo_content_url.length==1}}" data-imgurls="{{notify.big_answer_photo_content_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:50%;height:160px;" data-imgUrl="{{notify.big_answer_photo_content_url[idx]}}"
              src="{{it}}"></image>
            <image wx:elif="{{notify.answer_photo_content_url.length==2}}" data-imgurls="{{notify.big_answer_photo_content_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;height:90px;" data-imgUrl="{{notify.big_answer_photo_content_url[idx]}}"
              src="{{it}}"></image>
            <image wx:elif="{{notify.answer_photo_content_url.length==3}}" data-imgurls="{{notify.big_answer_photo_content_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;height:90px;" data-imgUrl="{{notify.big_answer_photo_content_url[idx]}}"
              src="{{it}}"></image>
            <image wx:elif="{{notify.answer_photo_content_url.length==4}}" data-imgurls="{{notify.big_answer_photo_content_url}}" catchtap="ListpreviewImage" mode="aspectFit" style="width:27%;height:90px;" data-imgUrl="{{notify.big_answer_photo_content_url[idx]}}"
              src="{{it}}"></image>
          </block>
        </view>
      </view>
      <view class="weui-cells__title">对比上方正确答案,按照题号.标出答错的题</view>
      <view class="weui-cells weui-cells_after-title">
        <checkbox-group bindchange="checkboxChange">
          <label class="weui-cell weui-check__label" wx:for="{{stats_list}}" wx:key="name">
            <checkbox class="weui-check" value="{{item.category}}" checked="{{item.checked}}" />
            <view class="weui-cell__bd">{{item.category}}</view>
            <view class="weui-cell__ft weui-cell__ft_in-radio status_check" wx:if="{{item.checked}}">
            </view>
            <view class="weui-cell__ft weui-cell__ft_in-radio status_not_check" wx:else>
            </view>
          </label>
        </checkbox-group>
      </view>
      <!-- <canvas canvas-id="columnCanvas" class="canvas" bindtouchstart="touchHandler"></canvas> -->
      <view class="weui-btn-area">
        <button class="weui-btn btn_save_info" type="primary" disabled="{{disabled}}" formType="submit" style='background-color:#1e90ff;width:80%'> 确认提交</button>
      </view>
    </form>
  </view>




  <view class="page" style='background-color:white;height:{{winHeight}}px;' wx:if="{{mode=='recording'}}" xmlns:wx="http://www.w3.org/1999/xhtml">
    <form bindsubmit="submit" report-submit="true">
      <view class="page__bd">
        <view style='text-align:center;padding-top:10px'>
          <image animation="{{recordAnimation}}" style='height:100px;width:100px;' src='../../image/record.png'></image>
        </view>
        <view style='text-align:center;height:30px'>
          <label wx:if="{{time_counter>0}}" style='font-size:20px;color:#38f;font-weight:600;font-weight: bolder;'>{{time_counter}}s</label>
        </view>
        <view style='text-align:center;display:flex;justify-content: center;'>
          <view wx:if="{{!recording}}" class='xm-record-btn' hover-class='xm-record-hover-btn' bindtap='record'>开始录音</view>
          <view wx:else class='xm-record-btn xm-record-hover-btn' bindtap='record'>结束录音</view>
        </view>
      </view>
    </form>
  </view>






  <view class="page" wx:if="{{mode=='photo'||mode=='record'||mode=='photo_record'||mode=='video'}}" style='height:{{winHeight}}px;' xmlns:wx="http://www.w3.org/1999/xhtml">
    <form bindsubmit="submit" report-submit="true">
      <view class="page__bd">
        <view class="weui-cells weui-cells_after-title">
          <view class="weui-cell">
            <view class="weui-cell__bd">
              <textarea class="weui-textarea" name="feedback_text" bindblur='bindFeedbackTextAreaBlur' value='{{feedback_text}}' placeholder="写备注或说明,如没有可不填" style="height: 8.3em" />

              <!-- 下方是已经上传的图片和录音 -->
              <view wx:if="{{tmp_record}}" style='display:flex;margin-bottom:10px;margin-top:10px;'>
                <view bindtap='playStart' class='xm-record-play-btn' style='margin:0 0;padding:5px 7px;padding-top:7px;width:70px;position:relative' hover-class='xm-record-play-btn-hover'>
                  <view>
                    <image animation="{{playAnimation}}" style='height:15px;width:15px;' src='../../image/record-msg.png'></image>
                  </view>
                  <view>{{duration}}'' </view>
                  <view class="weui-badge" id="{{item}}" catchtap='removeRecord' style='position:absolute;top:-0.6em;right:-0.7em;background-color:#bbb8b8;'>X</view>
                </view>
              </view>


              <view style='display:flex'>
                <view class="weui-uploader__files" id="uploaderFiles">
                  <block wx:for="{{selectedImgs}}" wx:key="*this">
                    <view class="weui-uploader__file" bindtap="previewImage" id="{{item}}" style='position:relative'>
                      <image style='width:80px;height:80px;border:1px solid #ddd;' class="weui-uploader__img" src="{{item}}" mode="aspectFill" />
                      <view class="weui-badge" id="{{item}}" catchtap='removeImg' style='position:absolute;top:-0.1em;right:-0.4em;background-color:#bbb8b8;'>X</view>
                    </view>
                  </block>
                </view>
              </view>


              <view style='text-align:center;position:relative' wx:if="{{tmp_video}}">
                <video controls="true" style='width:{{winWidth-30}}px;height:{{winHight}}px' src='{{tmp_video}}'></video>
                <view class="weui-badge" catchtap='removeVideo' style='position:absolute;top:-0.6em;right:-0.7em;background-color:#bbb8b8;'>X</view>
              </view>
              <!-- 下方是录音和图片列表 -->
              <view style='display:flex'>

                <view wx:if="{{mode=='photo'||mode=='photo_record'}}" class="xm-photo-logo" style='margin-right:20px' bindtap='chooseImage'> </view>
                <view wx:if="{{mode=='record'||mode=='photo_record'}}" class="xm-record-logo" bindtap='rerecord'> </view>

                <view wx:if="{{mode=='video'}}" class="xm-video-logo" bindtap='revideo'> </view>

              </view>
            </view>
          </view>
        </view>
        <view class="weui-cells__title"> 提示:
          <view bindtap='goHelp' class="weui-msg__link">视频或拍照出现问题?点击这里</view>
        </view>
        <view style='margin-top:20px'>
          <button class="weui-btn btn_save_info" data-file_type="photo_record" disabled="{{disabled}}" formType="submit" type="primary" style='background-color:#1e90ff;width:95%;margin-bottom:20px'> 提交反馈</button>
        </view>
      </view>
    </form>
  </view>



  <view class="container" style='height:400px;background-color:#F8F8F8;' wx:if="{{notify.feedback_type==1&&mode=='sign'}}">
    <form bindsubmit="submit" report-submit="true">
      <!--画布区域-->
      <view class="weui-cells__title">请在下方空白地方签上你的名字</view>
      <view class="canvas_area">
        <!--注意：同一页面中的 canvas-id 不可重复，如果使用一个已经出现过的 canvas-id，该 canvas 标签对应的画布将被隐藏并不再正常工作-->
        <canvas canvas-id="myCanvas" class="myCanvas" style='height:400px;width:{{winWidth}}px;background-color:white;' disable-scroll="false" bindtouchstart="touchStart" bindtouchmove="touchMove" bindtouchend="touchEnd">
        </canvas>
      </view>
      <view class="weui-btn-area">
        <button class="weui-btn btn_save_info" type="primary" data-file_type="sign" disabled="{{disabled}}" formType="submit" style='background-color:#1e90ff;width:80%'> 提交签名</button>
      </view>
      <view class="weui-btn-area" style='padding:10px;'>
        <button class="weui-btn" type="default" bindtap='clearCanvas' style='width:80%'>重新签名</button>
      </view>
      <!--画布工具区域-->
      <view class="canvas_tools">
        <view class="box box1" bindtap="penSelect" data-param="5"></view>
        <view class="box box2" bindtap="penSelect" data-param="15"></view>
        <view class="box box3" bindtap="colorSelect" data-param="#cc0033"></view>
        <view class="box box4" bindtap="colorSelect" data-param="#ff9900"></view>
        <view class="box box5" bindtap="clearCanvas"></view>
      </view>
    </form>
  </view>
</view>





<view class="comment-fixed" wx:if="{{current_comment_id}}">
   <form bindsubmit="putComment" report-submit="true">
  <view class="cf-box">
    <input class="cf-content" placeholder='{{comment_placeholder}}' bindinput="bindKeyInput" style='height:35px' auto-height="true" cursor-spacing="10" auto-focus="true" />

      <button class="cf-send touch-active"  id="{{current_comment_id}}"  formType="submit" type="primary" style='background-color:#1e90ff'> 提交</button>
    <!-- <text class="cf-send touch-active" id="{{current_comment_id}}" bindtap="putComment">提交</text> -->
  </view>
   </form>
</view>







<view class="page" wx:if="{{mode=='remark'}}" style='height:{{winHeight}}px;' xmlns:wx="http://www.w3.org/1999/xhtml">
  <form bindsubmit="putRemark" report-submit="true">
    <view class="page__bd">
      <view class="weui-cells weui-cells_after-title">
        <view class="weui-cell">
          <view class="weui-cell__bd">
            <textarea class="weui-textarea" focus='true' value='{{notify.remark}}' name="remark_content" placeholder="追加{{notify.type==1?'通知':'作业'}}备注或说明" style="height: 5.3em" />
          </view>
        </view>
      </view>
      <view style='margin-top:20px'>
        <button class="weui-btn btn_save_info" formType="submit" type="primary" style='background-color:#1e90ff;width:95%;margin-bottom:20px'> 提交</button>
      </view>
    </view>
  </form>
</view>