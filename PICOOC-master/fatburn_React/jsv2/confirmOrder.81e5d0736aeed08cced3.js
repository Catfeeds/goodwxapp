webpackJsonp([14,34],{207:function(e,o,t){"use strict";function a(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function r(){var e=function(){var e={backNum:0,closeWebview:1};return JSON.stringify(e)};getParamByUrl("webver")>2?appFc.deleteHistory(e()):mobileApp.deleteHistory(e())}function n(){$("#couponBoxNew").hide(),$("#confirmOrderNew").show();var e=isMobile();if(getParamByUrl("webver")>2&&"isApp"==e){getCookie("saveCampFrom");appFc.controlLeft(function(){var e={iconType:0,iconColor:"",backNum:1,closeWebview:0,hidden:!1,isHandle:!1,functionName:""};return JSON.stringify(e)}());var o={title:"确认订单",color:"",opacity:"",backgroundColor:"",backgroundOpacity:""};o=JSON.stringify(o),appFc.controlTitle(o)}else{if("isApp"==e&&mobileApp.getShareInfo(function(){var e={title:"确认订单",isShare:!1,backgroundColor:"#2c2f31"};return JSON.stringify(e)}()),document.documentElement.style.webkitTouchCallout="none","isApp"==e){getCookie("saveCampFrom");mobileApp.showLeftBtn(function(){var e={iconType:0,backNum:1,closeWebview:0,iconUrl:"",functionName:""};return JSON.stringify(e)}())}}}function s(){var e=isMobile();if(getParamByUrl("webver")>2&&"isApp"==e){getCookie("saveCampFrom");appFc.controlLeft(function(){var e={iconType:0,iconColor:"",backNum:0,closeWebview:0,hidden:!1,isHandle:!0,functionName:"clientFunA"};return JSON.stringify(e)}());var o={title:"我的优惠券",color:"",opacity:"",backgroundColor:"",backgroundOpacity:""};o=JSON.stringify(o),appFc.controlTitle(o)}else{if("isApp"==e&&mobileApp.getShareInfo(function(){var e={title:"我的优惠券",isShare:!1,backgroundColor:"#2c2f31"};return JSON.stringify(e)}()),document.documentElement.style.webkitTouchCallout="none","isApp"==e){getCookie("saveCampFrom");mobileApp.showLeftBtn(function(){var e={iconType:0,backNum:0,closeWebview:0,iconUrl:"",isHandle:!0,functionName:"clientFunA"};return JSON.stringify(e)}())}}}var c,i,l,u=t(0),m=t(2),p=t(3),d=t(63),g={SCategory_SQueRenDingDan:5080200,SQueRenDingDan_ShouJiHao:5080201,SQueRenDingDan_WeiXinHao:5080202,SQueRenDingDan_TongShouJiHao:5080203,SQueRenDingDan_XuanZeYouHuiQuan:5080204,SQueRenDingDan_TiJiaoDingDan:5080205},h=!1,f="",y=null,v="",N=!1,b=u.createClass((c={displayName:"ConfirmOrder",getInitialState:function(){return delCookie("youHuiState"),n(),{beginTime_year:"",beginTime_month:"",beginTime_day:"",originPrice:"",currentPrice:"",goodsName:"",infoImg:"",headImg:"",userName:"",onerror:"",couponInfo:[],phoneNum:"",wechatNum:"",selectImg:"image/confirmOrder/order-3.png",goodsId:"",goodReminder:"",sex:""}},componentWillMount:function(){var e=this,o=ajaxLink+"/v1/api/campSell/confirmOrder"+window.location.search;console.log(o),$.ajax({type:"get",url:o,dataType:"json",success:function(t){if(console.log(o),200==t.code){$("body").show(),$(".good .infoDesc .goodsName").ellipsis({english:!1,lineNum:2}),i=t.resp.goodsInfo.hasLimit;var a=1==t.resp.goodsInfo.hasLimit?t.resp.goodsInfo.especialPrice:t.resp.goodsInfo.curentPrice,r=t.resp.goodsInfo.beginTime.split("-");e.setState({beginTime_year:r[0],beginTime_month:r[1],beginTime_day:r[2],originPrice:t.resp.goodsInfo.originPrice,currentPrice:1==t.resp.goodsInfo.hasLimit?t.resp.goodsInfo.especialPrice:t.resp.goodsInfo.curentPrice,infoImg:t.resp.roleInfo.headPortraitUrl,goodsName:t.resp.goodsInfo.gradeName,goodsId:t.resp.goodsInfo.id,goodReminder:t.resp.goodsInfo.goodReminder,sex:t.resp.roleInfo.sex}),PubSub.subscribe("currentPrice",function(o,a){e.setState({currentPrice:a});var r="",n=t.resp.couponInfo.length>0?t.resp.couponInfo[0].id:null;console.log(n);var s="",c="";0==t.resp.roleInfo.sex?(s=t.resp.roleInfo.headPortraitUrl,c="this.src="+arrHeadImg[0]):1==t.resp.roleInfo.sex&&(s=t.resp.roleInfo.headPortraitUrl,c="this.src="+arrHeadImg[1]);var i=t.resp.roleInfo.name;i.length>5&&(i=i.substring(0,5)+"..."),e.setState({headImg:s,userName:i,onerror:c,couponInfo:t.resp.couponInfo});var l="",u="",m="";0==t.resp.couponInfo.length?(l="无可使用的优惠",u="-¥0",m="¥"+a):1==t.resp.couponInfo[0].expire||1==t.resp.couponInfo[0].isUse?(l="无可使用的优惠",u="-¥0",m="¥"+a):(l="¥"+t.resp.couponInfo[0].value,u="-¥"+t.resp.couponInfo[0].value,0!=a&&(r=a-t.resp.couponInfo[0].value,r=Math.round(100*r)/100,m="¥"+r));var p={youhuiText:l,youHuiMoney:u,realyPay:m,currentPriceNew:r,firstCouponId:n};console.log(p),PubSub.publish("youhuiData",p)});var n="",s=t.resp.couponInfo.length>0?t.resp.couponInfo[0].id:null;console.log(s);var c="",l="";0==t.resp.roleInfo.sex?(c=t.resp.roleInfo.headPortraitUrl,l=arrHeadImg[0]):1==t.resp.roleInfo.sex&&(c=t.resp.roleInfo.headPortraitUrl,l=arrHeadImg[1]);var u=t.resp.roleInfo.name;u.length>5&&(u=u.substring(0,5)+"..."),e.setState({headImg:c,userName:u,onerror:l,couponInfo:t.resp.couponInfo});var m="",p="",d="";0==t.resp.couponInfo.length?(m="无可使用的优惠",p="-¥0",d="¥"+a):1==t.resp.couponInfo[0].expire||1==t.resp.couponInfo[0].isUse?(m="无可使用的优惠",p="-¥0",d="¥"+a):(m="¥"+t.resp.couponInfo[0].value,p="-¥"+t.resp.couponInfo[0].value,0!=a&&(n=a-t.resp.couponInfo[0].value,n=Math.round(100*n)/100,d="¥"+n));var g={youhuiText:m,youHuiMoney:p,realyPay:d,currentPriceNew:n,firstCouponId:s};console.log(g),PubSub.publish("youhuiData",g)}else $(".error-main-t").html(t.result.message),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)},error:function(){$(".error-main-t").html("啊哦，您的网络不太给力~"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)}})},componentWillUnmount:function(){this.serverRequest.abort()},componentDidMount:function(){var e,o,t=getCookie("confirmOrderPhone"),a=getCookie("confirmOrderWechat"),r=getCookie("userUserId"),n=getCookie("userRoleId");r==getParamByUrl("userId")&&n==getParamByUrl("roleId")?(e=t,o=a):(delCookie("confirmOrderPhone"),delCookie("confirmOrderWechat"),e="",o=""),this.setState({phoneNum:e,wechatNum:o}),setCookie("userUserId",getParamByUrl("userId"),1),setCookie("userRoleId",getParamByUrl("roleId"),1)},PhoneNumFoucs:function(e){e.stopPropagation(),setMaiDian(g.SCategory_SQueRenDingDan,g.SQueRenDingDan_ShouJiHao)},WechatNumFoucs:function(e){e.stopPropagation(),setMaiDian(g.SCategory_SQueRenDingDan,g.SQueRenDingDan_WeiXinHao)},PhoneNumInput:function(e){e.stopPropagation();var o=e.currentTarget,t=($(o).val(),"");$(o).val().length>0?$(".check").css("display","block"):$(".check").css("display","none"),t=$("#phoneNum").val()==$("#wechatNum").val()&&""!=$("#phoneNum").val()&&""!=$("#wechatNum").val()?"image/confirmOrder/order-4.png":"image/confirmOrder/order-3.png",this.setState({phoneNum:$(o).val(),selectImg:t}),setCookie("confirmOrderPhone",$(o).val(),1)}},a(c,"WechatNumFoucs",function(e){e.stopPropagation();var o=e.currentTarget,t=($(o).val(),"");t=$("#phoneNum").val()==$("#wechatNum").val()&&""!=$("#phoneNum").val()&&""!=$("#wechatNum").val()?"image/confirmOrder/order-4.png":"image/confirmOrder/order-3.png",this.setState({wechatNum:$(o).val(),selectImg:t}),setCookie("confirmOrderWechat",$(o).val(),1)}),a(c,"SelectStatus",function(e){e.stopPropagation();var o=(e.currentTarget,"");h?(o="image/confirmOrder/order-3.png",this.setState({wechatNum:"",selectImg:o}),h=!1):(o="image/confirmOrder/order-4.png",this.setState({phoneNum:$("#phoneNum").val(),wechatNum:$("#phoneNum").val(),selectImg:o}),h=!0),setMaiDian(g.SCategory_SQueRenDingDan,g.SQueRenDingDan_TongShouJiHao),setCookie("confirmOrderWechat",$("#wechatNum").val(),1)}),a(c,"render",function(){console.log(this);var e=this.state.beginTime_year,o=this.state.beginTime_month,t=this.state.beginTime_day,a=this.state.originPrice,r=this.state.currentPrice,n=(this.state.infoImg,this.state.headImg),s=this.state.userName,c=(this.state.onerror,this.state.goodsName),i=this.state.couponInfo,l=this.state.goodsId,m=this.state.phoneNum,g=this.state.wechatNum,h=this.state.selectImg,f=this.state.goodReminder,y=this.state.sex,v={goodsId:l,phoneNo:m,weChat:g,origPrice:a};return m.length>0&&$(".check").css("display","block"),m==g&&""!=m&&""!=g&&(h="image/confirmOrder/order-4.png"),u.createElement("div",null,u.createElement("section",{className:"container",id:"confirmOrderNew"},u.createElement("aside",{className:"row common info"},u.createElement("div",{className:"col-xs-12 col-sm-12 buy"},u.createElement("div",{className:"col-xs-12 col-sm-12"},u.createElement("span",null,"参营人："),u.createElement("img",{className:"avatar",src:n,onError:imgError.bind(this,y),alt:""}),u.createElement("span",{className:"userName"},s)))),u.createElement("aside",{className:"row common infoInput phone"},u.createElement("div",{className:"row col-xs-12 col-sm-12"},u.createElement("div",{className:"col-xs-2 col-sm-2 logo"},u.createElement("img",{src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/confirmOrder/phone.png"})),u.createElement("div",{className:"col-xs-10 col-sm-10 tiaoZheng"},u.createElement("input",{id:"phoneNum",type:"tel",placeholder:"您的手机号",onFocus:this.PhoneNumFoucs,onInput:this.PhoneNumInput,value:m})))),u.createElement("aside",{className:"row common infoInput wechat"},u.createElement("div",{className:"row col-xs-12 col-sm-12"},u.createElement("div",{className:"col-xs-2 col-sm-2 logo"},u.createElement("img",{src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/confirmOrder/wechat.png"})),u.createElement("div",{className:"row col-xs-10 col-sm-10 sameHeight"},u.createElement("div",{className:"col-xs-8 col-sm-8 tiaoZheng"},u.createElement("input",{id:"wechatNum",type:"text",placeholder:"您的微信号",onFocus:this.WechatNumFoucs,onInput:this.WechatNumFoucs,value:g})),u.createElement("div",{className:"row col-xs-4 col-sm-4 right check"},u.createElement("img",{id:"samePhone",src:h,onClick:this.SelectStatus})," 同手机号")))),u.createElement("aside",{className:"row common good"},u.createElement("div",{className:"row col-xs-12 col-sm-12 aboutInfo"},u.createElement("div",{className:"col-xs-3 col-sm-3 infoImg"},u.createElement("img",{src:f})),u.createElement("div",{className:"col-xs-9 col-sm-9 infoDesc"},u.createElement("div",{className:"goodsName"},u.createElement("p",null,c)),u.createElement("p",{className:"open beginTime"},"开营时间：",u.createElement("span",{className:"year"},e),"年",u.createElement("span",{className:"month"},o),"月",u.createElement("span",{className:"day"},t),"日"),u.createElement("p",{className:"price"},"¥",u.createElement("span",{className:"new-price"},r))))),u.createElement(I,{couponInfo:i,currentPrice:r,goods:v}),u.createElement(p,null)),u.createElement(d,null))}),c)),I=u.createClass({displayName:"PriceCont",getInitialState:function(){return{youhuiData:{}}},componentDidMount:function(){var e=this,o=$(window).height(),t=$(".empty").offset().top;$("body").css("height",o+"px"),$(".pay").show(),t+$(".pay").height()>o&&$(window).scroll(function(){var e=$(window).scrollTop();$(".empty").css("marginBottom","50px"),$(".pay").css("bottom",-e+"px")}),PubSub.subscribe("youhuiData",function(e,o){this.setState({youhuiData:o})}.bind(this)),PubSub.subscribe("test",function(o,t){var a=e.state.youhuiData,r=e.props.currentPrice,s="",c="",i="",l="";y=setInterval(function(){console.log("1",getCookie("youHuiState")),f=t,v=getCookie("currentCouponId"),void 0==f||""==f?(s="不使用优惠券",c="-¥0",i="¥"+r):(s="¥"+f,c="-¥"+f,0!=r&&(l=r-f,l=Math.round(100*l)/100,i="¥"+l)),a.youhuiText=s,a.youHuiMoney=c,a.realyPay=i,a.currentPriceNew=l,PubSub.publish("youhuiData",a),clearInterval(y),n(),$("#couponBoxNew").hide(),$("#confirmOrderNew").show(),console.log(a)},100)})},toggleCoupon:function(){var e=this.state.youhuiData,o=this.props.currentPrice,t="",a="",r="",n="";y=setInterval(function(){console.log("1",getCookie("youHuiState")),f=getCookie("youHuiState"),v=getCookie("currentCouponId"),null!=f&&(console.log(3),"undefined"==f?(t="不使用优惠券",a="-¥0",r="¥"+o):(t="¥"+f,a="-¥"+f,0!=o&&(n=o-f,n=Math.round(100*n)/100,r="¥"+n)),e.youhuiText=t,e.youHuiMoney=a,e.realyPay=r,e.currentPriceNew=n,PubSub.publish("youhuiData",e),clearInterval(y)),console.log(e)},100)},SelectYhuiClick:function(e){e.stopPropagation(),setMaiDian(g.SCategory_SQueRenDingDan,g.SQueRenDingDan_XuanZeYouHuiQuan),delCookie("youHuiState"),s(),$("#confirmOrderNew").hide(),$("#couponBoxNew").css("min-height",$(window).height()),$("#couponBoxNew").css("display","block")},SubmitOrder:function(e){var o=this;if(console.log(o),1==N)o.realSubmitFun();else{var t=ajaxLink+"/v1/api/campSell/confirmOrder"+window.location.search;$.ajax({type:"get",url:t,dataType:"json",success:function(e){console.log(e),200==e.code?(l=e.resp.goodsInfo.hasLimit,i==l?o.realSubmitFun():1==i||0==l?(PubSub.publish("currentPrice",e.resp.goodsInfo.curentPrice),$("#nowPrice").html("您选择的商品价格发生了变化，当前价格为："+e.resp.goodsInfo.curentPrice+"元，是否继续提交订单？"),$(".payOrNotBox").show()):0!=i&&1!=l||(PubSub.publish("currentPrice",e.resp.goodsInfo.especialPrice),$("#nowPrice").html("您选择的商品价格发生了变化，当前价格为："+e.resp.goodsInfo.especialPrice+"元，是否继续提交订单？"),$(".payOrNotBox").show())):($(".error-main-t").html(e.result.message),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2))},error:function(){$(".error-main-t").html("啊哦，您的网络不太给力~"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)}})}},realSubmitFun:function(){event.stopPropagation(),setMaiDian(g.SCategory_SQueRenDingDan,g.SQueRenDingDan_TiJiaoDingDan);var e=this.props.goods,o=e.phoneNo,t=(e.goodsId,e.weChat),a=e.origPrice,r=this.props.currentPrice,n=this.state.youhuiData.currentPriceNew,s=this.state.youhuiData.youHuiMoney.substring(2),c=this.state.youhuiData.firstCouponId,i=/^(((13[0-9]{1})|(14[0-9]{1})|(15[0-9]{1})|(16[0-9]{1})|(17[0-9]{1})|(18[0-9]{1})|(19[0-9]{1}))+\d{8})$/;if(void 0==o||null==o||""==o)$(".alerts").eq(3).stop(!0).fadeIn(200).delay(2e3).fadeOut(200);else if(i.test(o)){var l=ajaxLink+"/v1/api/campSell/getClassStock"+window.location.search;console.log(l),$.ajax({type:"get",url:l,dataType:"json",success:function(e){if(console.log(3,e),200==e.code){if(console.log("data.resp="+e.resp),1==e.resp)$(".alerts").eq(0).stop(!0).fadeIn(200).delay(2e3).fadeOut(200);else if(2==e.resp)$(".alerts").eq(1).stop(!0).fadeIn(200).delay(2e3).fadeOut(200);else if(3==e.resp||5==e.resp)$(".alerts").eq(2).stop(!0).fadeIn(200).delay(2e3).fadeOut(200);else if(7==e.resp||10==e.resp)$(".alerts").eq(5).html("您在当前所选时间内已经参营啦，换个时间吧～").stop(!0).fadeIn(200).delay(2e3).fadeOut(200);else if(8==e.resp||9==e.resp)$(".alerts").eq(5).html("您在当前所选时段内已有订单啦，处理后再来试试吧～").stop(!0).fadeIn(200).delay(2e3).fadeOut(200);else if(4==e.resp&&"0"==$(".submit span").attr("data-clicked")){$(".submit span").attr("data-clicked","1");var i="";i=1==getParamByUrl("refer")?"appBanner":2==getParamByUrl("refer")?"push":3==getParamByUrl("refer")?"kaiPing":4==getParamByUrl("refer")?"orderDetail":6==getParamByUrl("refer")?"woDe":5==getParamByUrl("refer")?"wenzhang":"other";var l={linkId:parseInt(getParamByUrl("linkId")),goodsId:parseInt(getParamByUrl("classId")),userId:parseInt(getParamByUrl("userId")),roleId:parseInt(getParamByUrl("roleId")),phoneNo:o,weChat:t,origPrice:a,currentPrice:s>0?n:r,couponPrice:parseInt(s),isCoupon:s>0?1:0,couponId:s>0?""==f?c:v:null,sourceType:"燃脂营APP",trafficSource:i};console.log("goodsInfo ",l);var u=ajaxLink+"/v1/api/campOrder/generateOrder"+window.location.search;$.ajax({type:"POST",url:u,dataType:"json",contentType:"application/json",data:JSON.stringify(l),success:function(e){if(console.log(4,e),200==e.code){console.log(absoluteUrl+"orderSuccess.html"+window.location.search+"&orderId="+e.resp);if("isApp"==isMobile()){var o=function(){var o={orderId:e.resp,url:absoluteUrl+"orderSuccess.html"+window.location.search+"&orderId="+e.resp,price:l.currentPrice,isRefresh:!0,function:"gobackToGood"};return JSON.stringify(o)};getParamByUrl("webver")>2?appFc.gotoPay(o()):mobileApp.gotoPay(o())}setCookiePath("toOrderSuccess","0",1,"/;domain=picooc.com")}else $(".error-main-t").html(e.message),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)}})}}else $(".error-main-t").html(e.result.message),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)},error:function(){$(".error-main-t").html("啊哦，您的网络不太给力~"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)}})}else $(".alerts").eq(4).stop(!0).fadeIn(200).delay(2e3).fadeOut(200)},render:function(){var e=this,o=this.props.currentPrice,t=this.state.youhuiData.youhuiText,a=this.state.youhuiData.youHuiMoney,r=this.state.youhuiData.realyPay;return u.createElement("div",null,u.createElement("aside",{className:"row common sameHeight youhui",onClick:this.SelectYhuiClick},u.createElement("div",{className:"col-xs-12 col-sm-12"},u.createElement("div",{className:"col-xs-6 col-sm-6 status"},u.createElement("img",{src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/confirmOrder/youhui.png"})," ",u.createElement("span",{className:"aboutYouhui"},"优惠券")),u.createElement("div",{className:"col-xs-6 col-sm-6 right money"},u.createElement("span",null,t)," ",u.createElement("img",{src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/confirmOrder/more.png"})))),u.createElement("aside",{className:"row common jine"},u.createElement("div",{className:"col-xs-12 col-sm-12 first"},u.createElement("div",{className:"col-xs-6 col-sm-6 status"},"商品金额"),u.createElement("div",{className:"col-xs-6 col-sm-6 right money"},"¥",u.createElement("span",{className:"new-price"},o))),u.createElement("div",{className:"col-xs-12 col-sm-12"},u.createElement("div",{className:"col-xs-6 col-sm-6 status"},"优惠金额"),u.createElement("div",{className:"col-xs-6 col-sm-6 right money youHuiMoney"},a))),u.createElement("aside",{className:"empty"}),u.createElement("aside",{className:"row sameHeight pay",style:{display:"none"}},u.createElement("div",{className:"col-xs-6 col-sm-6 realyPay"},"实付款:  ",u.createElement("span",{className:"money"},r)),u.createElement("div",{className:"col-xs-6 col-sm-6 submit right"},u.createElement("span",{"data-clicked":"0",onClick:this.SubmitOrder},"提交订单"))),u.createElement("aside",{className:"alertBox"},u.createElement("div",{className:"alerts",style:{display:"none"}},"已拍完，但还有人未付款，待会儿再来看看吧～"),u.createElement("div",{className:"alerts",style:{display:"none"}},"手慢了，名额被抢光啦～"),u.createElement("div",{className:"alerts",style:{display:"none"}},"同一账号只能购买一次哦!请核对参营人员信息～"),u.createElement("div",{className:"alerts",style:{display:"none"}},"请填写参营人员手机号码～"),u.createElement("div",{className:"alerts",style:{display:"none"}},"手机号填写有误，请重新核对哦～"),u.createElement("div",{className:"alerts",style:{display:"none"}})),u.createElement("aside",{className:"payOrNotBox",style:{display:"none"}},u.createElement("div",{className:"payOrNot",id:"nowPrice"}),u.createElement("div",{className:"btns row"},u.createElement("div",{className:"col-xs-6 col-sm-6 left",onClick:e.cancelPay},"取消"),u.createElement("div",{className:"col-xs-6 col-sm-6 right",onClick:e.confirmPay},"提交"))))},cancelPay:function(){N=!0,$(".payOrNotBox").hide()},confirmPay:function(){var e=this;N=!0,$(".payOrNotBox").hide(),e.realSubmitFun()}});m.render(u.createElement(b,null),document.getElementById("order_box")),window.gobackToGood=r,window.clientFunA=n,window.clientFunB=s},63:function(e,o,t){"use strict";var a=t(0),r=(t(2),t(3)),n={SCategory_SXuanZeYouHuiQuan:5080300,SXuanZeYouHuiQuan_BuShiYongYouHuiQuan:5080301,SXuanZeYouHuiQuan_ShiYongYouHuiQuan:5080302},s=a.createClass({displayName:"CouponList",CircleClick:function(e){e.stopPropagation(),e.preventDefault(),setMaiDian(n.SCategory_SXuanZeYouHuiQuan,n.SXuanZeYouHuiQuan_BuShiYongYouHuiQuan),PubSub.publish("test",1)},SelectCircle:function(e){e.stopPropagation(),e.preventDefault();var o=this.props.couponList,t=$(".circle1"),a=e.currentTarget;t.removeClass("active"),t.attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle2.png"),$(a).children().children(".circle1").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"),$(a).children().children(".circle1").addClass("active");var r=$(a).find(".value2").html(),s=$(a).attr("data-index"),c=void 0==r?null:o[s-1].id;setCookie("youHuiState",r,1),setCookie("youHuiS",r,1),setCookie("currentCouponId",c,1),setCookie("chooseIndex",$(a).index(),1),"aside"==a.nodeName.toLowerCase()?(setMaiDian(n.SCategory_SXuanZeYouHuiQuan,n.SXuanZeYouHuiQuan_BuShiYongYouHuiQuan),setCookie("chooseIndex","noChoose2",1)):"div"==a.nodeName.toLowerCase()&&(setMaiDian(n.SCategory_SXuanZeYouHuiQuan,n.SXuanZeYouHuiQuan_ShiYongYouHuiQuan),setCookie("chooseIndex",s-1,1)),PubSub.publish("test",r)},deleteHistory:function(){var e=function(){var e={backNum:1,closeWebview:0};return JSON.stringify(e)};getParamByUrl("webver")>2?appFc.deleteHistory(e()):mobileApp.deleteHistory(e())},render:function(){var e=this.props.couponList,o=[],t=!1;if(e.length>0)for(var r=0;r<e.length;r++)0==e[r].isUse?e[r].expire?o.push(a.createElement("div",{className:"row col-xs-12 col-sm-12 avail notAvail",key:r},a.createElement("div",{className:"msg"},a.createElement("div",{className:"col-xs-8 col-sm-8 continue"},a.createElement("img",{className:"circle",src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle2.png"}),"  ",a.createElement("span",null,e[r].name)),a.createElement("div",{className:"col-xs-4 col-sm-4 value"},a.createElement("span",{className:"value1"},"¥")," ",a.createElement("span",{className:"value2"},e[r].value))),a.createElement("div",{className:"col-xs-12 col-sm-12 term"},"有效期：",e[r].beginTime+"-",e[r].endTime),a.createElement("div",{className:"col-xs-12 col-sm-12 require"},e[r].rule),a.createElement("img",{className:"status",src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/expire.png"}))):(t=!0,o.push(a.createElement("div",{className:"row col-xs-12 col-sm-12 avail isAvail",key:r},a.createElement("div",{className:"msg msg2 msgActive",onClick:this.SelectCircle,"data-index":r+1},a.createElement("div",{className:"col-xs-8 col-sm-8 continue"},a.createElement("img",{className:"circle circle1 aboutCircle keYongQuan",src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"}),"  ",a.createElement("span",null,e[r].name)),a.createElement("div",{className:"col-xs-4 col-sm-4 value"},a.createElement("span",{className:"value1"},"¥")," ",a.createElement("span",{className:"value2"},e[r].value))),a.createElement("div",{className:"col-xs-12 col-sm-12 term"},"有效期：",e[r].beginTime+"-",e[r].endTime),a.createElement("div",{className:"col-xs-12 col-sm-12 require"}," ",e[r].rule)))):1==e[r].isUse&&o.push(a.createElement("div",{className:"row col-xs-12 col-sm-12 avail notAvail",key:r},a.createElement("div",{className:"msg"},a.createElement("div",{className:"col-xs-8 col-sm-8 continue"},a.createElement("img",{className:"circle",src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle2.png"}),"  ",a.createElement("span",null,e[r].name)),a.createElement("div",{className:"col-xs-4 col-sm-4 value"},a.createElement("span",{className:"value1"},"¥")," ",a.createElement("span",{className:"value2"},e[r].value))),a.createElement("div",{className:"col-xs-12 col-sm-12 term"},"有效期：",e[r].beginTime+" - ",e[r].endTime),a.createElement("div",{className:"col-xs-12 col-sm-12 require"},e[r].rule),a.createElement("img",{className:"status",src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/used.png"})));return a.createElement("div",null,a.createElement("aside",{className:"row noCoupons msg2",onClick:this.SelectCircle,"data-index":"0"},a.createElement("div",{className:"col-xs-2 col-sm-2 noImg"},a.createElement("img",{className:"circle circle1",src:1==t?"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle2.png":"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"})),a.createElement("div",{className:"col-xs-10 col-sm-10 noUse"},"不使用优惠劵")),a.createElement("aside",{className:"row coupons",style:{display:"block"}},o))}}),c=a.createClass({displayName:"CouponContainer",getInitialState:function(){return{couponList:[]}},componentWillMount:function(){var e=getCookie("chooseIndex");console.log("chooseIndex="+e);var o=ajaxLink+"/v1/api/campCoupon/findCoupon"+window.location.search;this.serverRequest=$.get(o,function(o){if(console.log(1,o),200==o.code)if(console.log("getCookie('youHuiState')",getCookie("youHuiState")),this.setState({couponList:o.resp.couponList}),o.resp.couponList.length>0)0==$(".msg2 .keYongQuan").length&&$(".circle1:first").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"),$(".aboutCircle").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle2.png"),""!=e?"noChoose2"==e?$(".circle1:first").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"):$(".aboutCircle").eq(Number(e)).attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"):$(".aboutCircle:first").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png");else{$(".coupons").html(""),$(".circle1").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png");$(".coupons").append('<div class="row noCoupon">暂无可使用的优惠券～</div>')}else $(".error-main-t").html(o.result.message),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)}.bind(this))},render:function(){var e=this.state.couponList;return a.createElement("section",{className:"container",id:"couponBoxNew",style:{display:"none"}},a.createElement(s,{couponList:e}),a.createElement(r,null))}});e.exports=c}},[207]);