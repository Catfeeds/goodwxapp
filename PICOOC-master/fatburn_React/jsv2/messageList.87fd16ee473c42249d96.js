webpackJsonp([31],{220:function(e,t,a){"use strict";var s=a(0),i=a(1),r=a(3),n={SCategory_SXiaoXiLieBiao:5060600,SXiaoXiLieBiao_QianWangXiaoXiXiangQing:5060601,SXiaoXiLieBiao_ChaKanGengZaoHuiFu:5060602},l=s.createClass({displayName:"MessageList",getInitialState:function(){return{}},setMessageStatus:function(e,t,a){var s=this,i=[];setMaiDian(n.SCategory_SXiaoXiLieBiao,n.SXiaoXiLieBiao_QianWangXiaoXiXiangQing),console.info(t);var r=window.location.protocol+"//"+window.location.host,l=r+"/v1/api/camp/checkState"+window.location.search+"&replyId="+e+"&checkId="+a;$.ajax({type:"get",url:l,success:function(r){if(r.resp.check&&r.resp.reply){var n=window.location.protocol+"//"+window.location.host,l=n+"/v1/api/camp/changeReplyRead"+window.location.search+"&replyId="+e;$.ajax({type:"get",url:l,success:function(e){if(200!=e.code)$(".error-main-t").html("服务器开小差了～"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2);else{"isApp"==isMobile()&&"tanchao"!=getParamByUrl("testtype")?s.openNewWebview(t):window.location.href=t}}})}else{if(r.resp.check){$(".error-main-t").html("该条评论已被删除~"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2);for(var o=0;o<s.props.messageData.resp.replyList.length;o++)s.props.messageData.resp.replyList[o].replyId!=e&&i.push(s.props.messageData.resp.replyList[o]);s.props.getVaildFc(i)}else{$(".error-main-t").html("该条打卡已被删除~"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2);for(var o=0;o<s.props.messageData.resp.replyList.length;o++)s.props.messageData.resp.replyList[o].checkId!=a&&i.push(s.props.messageData.resp.replyList[o]);s.props.getVaildFc(i)}1==$("#noReadMessage li").length&&$("#getDataButton").find("span").click()}}})},openNewWebview:function(e){console.info(e);"isApp"==isMobile()&&"tanchao"!=getParamByUrl("testtype")?appFc.openWebview(function(){var t={link:e,animation:1};return JSON.stringify(t)}()):window.location.href=e},render:function(){var e=this,t=[],a=e.props.messageData;if(console.info("{}"==JSON.stringify(a)),"{}"!=JSON.stringify(a))for(var i=a.resp.replyList.length,r=0;r<i;r++){var n=absoluteUrl+"info.html"+window.location.search+"&checkId="+a.resp.replyList[r].checkId+"&replyId="+a.resp.replyList[r].replyId;t.push(s.createElement("li",{className:"li_border",id:a.resp.replyList[r].checkId,key:r,"data-index":r},s.createElement("div",{className:"tidings_list_header"},s.createElement("img",{src:a.resp.replyList[r].headImg,onError:imgError.bind(this,a.resp.replyList[r].sex)})),s.createElement("div",{className:"tidings_list_right"},s.createElement("div",{onClick:e.setMessageStatus.bind(this,a.resp.replyList[r].replyId,n,a.resp.replyList[r].checkId)},s.createElement("div",{className:"tidings_list_one"},s.createElement("span",{className:"tidings_list_name",style:a.resp.replyList[r].isCoach?{color:"#ffa200"}:{}},a.resp.replyList[r].roleName),"回复了您："),s.createElement("div",{className:"tidings_list_con",dangerouslySetInnerHTML:{__html:a.resp.replyList[r].content}}),s.createElement("div",{className:"tidings_list_time"},a.resp.replyList[r].time),s.createElement("span",{className:"tidings_list_icon"})))))}return s.createElement("ul",{id:"readedMessage"},t)}}),o=s.createClass({displayName:"DateBtn",getInitialState:function(){return{}},getDataBtn:function(){var e=this,t=e.props.messageData;"{}"!=JSON.stringify(t)&&1==t.resp.hasNext&&e.props.getMessageListFc(t.resp.time)},render:function(){var e,t=this,a=t.props.messageData;return"{}"!=JSON.stringify(a)&&(0==a.resp.hasNext?(0==a.resp.replyList.length&&($(".loading").css("display","block"),$(".loading").text("目前没有消息回复哦")),e=s.createElement("li",{className:"tidings_list_prompt noMoreData"},s.createElement("div",{className:"tidings_list_prompt_div"},s.createElement("span",{style:{display:"block"}})))):e=s.createElement("li",{className:"tidings_list_prompt noMoreData"},s.createElement("div",{className:"tidings_list_prompt_div"},s.createElement("span",{style:{display:"block"},onClick:t.getDataBtn},"查看更早的回复 "),"  ",s.createElement("span",{className:"tidings_list_icon2"})))),s.createElement("div",{id:"getDataButton"},e)}}),c=s.createClass({displayName:"MessageListContainer",getInitialState:function(){this.getMessageListFc("-1");var e={title:"消息列表",color:"",opacity:"",backgroundColor:"",backgroundOpacity:""};return e=JSON.stringify(e),appFc.controlTitle(e),{hasNextData:0,messageData:{}}},getVaildFc:function(e){var t=this,a=t.state.messageData;a.resp.replyList=e,console.info(a),t.setState({messageData:a})},getMessageListFc:function(e){var t=this,a=(getParamByUrl("roleId"),getParamByUrl("campId"),window.location.protocol+"//"+window.location.host),s="";s="-1"==e?a+"/v1/api/camp/getReplyList"+window.location.search+"&type=1":a+"/v1/api/camp/getReplyList"+window.location.search+"&count=10&time="+e+"&type=1",console.info(s),$.ajax({type:"get",url:s,dataType:"json",success:function(e){$(".loading").css("display","none"),200==e.code?("{}"!=JSON.stringify(t.state.messageData)&&t.state.messageData.resp.replyList.length>0&&(e.resp.replyList=t.state.messageData.resp.replyList.concat(e.resp.replyList)),t.setState({messageData:e})):($(".error-main-t").html("服务器开小差了～"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2))}})},componentDidUpdate:function(e,t){var a=this,s=a.state.messageData;1==s.resp.hasNext&&0==s.resp.replyList.length&&a.getMessageListFc(0)},getDataClick:function(e){},render:function(){var e=this;return s.createElement("div",{className:"container"},s.createElement("div",{className:"row tidings_list"},s.createElement("span",{className:"loading"},"数据正在努力加载..."),s.createElement(l,{messageData:e.state.messageData,getVaildFc:e.getVaildFc}),s.createElement(o,{messageData:e.state.messageData,getMessageListFc:e.getMessageListFc})))}}),p=s.createClass({displayName:"Component",render:function(){return s.createElement("div",null,s.createElement(c,null),s.createElement(r,null))}});i.render(s.createElement(p,null),document.getElementById("messageMain"))}},[220]);