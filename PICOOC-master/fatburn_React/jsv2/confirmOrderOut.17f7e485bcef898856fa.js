webpackJsonp([13],{121:function(e,o,t){"use strict";var a=t(0),n=(t(2),t(1)),s={SCategory_SXuanZeYouHuiQuan:5080300,SXuanZeYouHuiQuan_BuShiYongYouHuiQuan:5080301,SXuanZeYouHuiQuan_ShiYongYouHuiQuan:5080302},r=a.createClass({displayName:"CouponList",CircleClick:function(e){e.stopPropagation(),e.preventDefault(),setMaiDian(s.SCategory_SXuanZeYouHuiQuan,s.SXuanZeYouHuiQuan_BuShiYongYouHuiQuan),$("#couponBox").css("display","none")},SelectCircle:function(e){e.stopPropagation();var o=this.props.couponList,t=$(".circle1"),a=e.currentTarget;t.removeClass("active"),t.attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle2.png"),$(a).children().children(".circle1").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"),$(a).children().children(".circle1").addClass("active");var r=$(a).find(".value2").html(),c=$(a).attr("data-index"),i=void 0==r?null:o[c-1].id;setCookie("chooseIndex",$(a).index(),1),"aside"==a.nodeName.toLowerCase()?(setMaiDian(s.SCategory_SXuanZeYouHuiQuan,s.SXuanZeYouHuiQuan_BuShiYongYouHuiQuan),setCookie("chooseIndex","noChoose2",1)):"div"==a.nodeName.toLowerCase()&&(setMaiDian(s.SCategory_SXuanZeYouHuiQuan,s.SXuanZeYouHuiQuan_ShiYongYouHuiQuan),setCookie("chooseIndex",c-1,1));var l={youHuiState:r,currentCouponId:i},m=JSON.stringify(l);n.publish("jsonData",m),$("#couponBox").css("display","none")},render:function(){var e=this.props.couponList,o=[],t=!1;if(e.length>0)for(var n=0;n<e.length;n++)0==e[n].isUse?e[n].expire?o.push(a.createElement("div",{className:"row col-xs-12 col-sm-12 avail notAvail",key:n},a.createElement("div",{className:"msg"},a.createElement("div",{className:"col-xs-8 col-sm-8 continue"},a.createElement("img",{className:"circle",src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle2.png"}),"  ",a.createElement("span",null,e[n].name)),a.createElement("div",{className:"col-xs-4 col-sm-4 value"},a.createElement("span",{className:"value1"},"¥")," ",a.createElement("span",{className:"value2"},e[n].value))),a.createElement("div",{className:"col-xs-12 col-sm-12 term"},"有效期：",e[n].beginTime+"-",e[n].endTime),a.createElement("div",{className:"col-xs-12 col-sm-12 require"},e[n].rule),a.createElement("img",{className:"status",src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/expire.png"}))):(t=!0,o.push(a.createElement("div",{className:"row col-xs-12 col-sm-12 avail isAvail",key:n},a.createElement("div",{className:"msg msg2 msgActive",onClick:this.SelectCircle,"data-index":n+1},a.createElement("div",{className:"col-xs-8 col-sm-8 continue"},a.createElement("img",{className:"circle circle1 aboutCircle keYongQuan",src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"}),"  ",a.createElement("span",null,e[n].name)),a.createElement("div",{className:"col-xs-4 col-sm-4 value"},a.createElement("span",{className:"value1"},"¥")," ",a.createElement("span",{className:"value2"},e[n].value))),a.createElement("div",{className:"col-xs-12 col-sm-12 term"},"有效期：",e[n].beginTime+"-",e[n].endTime),a.createElement("div",{className:"col-xs-12 col-sm-12 require"}," ",e[n].rule)))):1==e[n].isUse&&o.push(a.createElement("div",{className:"row col-xs-12 col-sm-12 avail notAvail",key:n},a.createElement("div",{className:"msg"},a.createElement("div",{className:"col-xs-8 col-sm-8 continue"},a.createElement("img",{className:"circle",src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle2.png"}),"  ",a.createElement("span",null,e[n].name)),a.createElement("div",{className:"col-xs-4 col-sm-4 value"},a.createElement("span",{className:"value1"},"¥")," ",a.createElement("span",{className:"value2"},e[n].value))),a.createElement("div",{className:"col-xs-12 col-sm-12 term"},"有效期：",e[n].beginTime+" - ",e[n].endTime),a.createElement("div",{className:"col-xs-12 col-sm-12 require"},e[n].rule),a.createElement("img",{className:"status",src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/used.png"})));return a.createElement("div",{className:"row"},a.createElement("aside",{className:"row noCoupons msg2",onClick:this.SelectCircle,"data-index":"0"},a.createElement("div",{className:"col-xs-2 col-sm-2 noImg"},a.createElement("img",{className:"circle circle1",src:1==t?"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle2.png":"https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"})),a.createElement("div",{className:"col-xs-10 col-sm-10 noUse"},"不使用优惠劵")),a.createElement("aside",{className:"row coupons",style:{display:"block"}},o))}}),c=a.createClass({displayName:"CouponContainer",getInitialState:function(){return{couponList:[]}},componentWillMount:function(){var e=getCookie("chooseIndex");console.log("chooseIndex="+e);var o=ajaxLink+"/v1/api/campCoupon/findCouponOut"+window.location.search;console.log(o),this.serverRequest=$.get(o,function(o){if(console.log(1,o),200==o.code)if(console.log("getCookie('youHuiState')",getCookie("youHuiState")),this.setState({couponList:o.resp.couponList}),o.resp.couponList.length>0)0==$(".msg2 .keYongQuan").length&&$(".circle1:first").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"),$(".aboutCircle").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle2.png"),""!=e?"noChoose2"==e?$(".circle1:first").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"):$(".aboutCircle").eq(Number(e)).attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png"):$(".aboutCircle:first").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png");else{$(".coupons").html(""),$(".circle1").attr("src","https://cdn2.picooc.com/web/res/fatburn/image/sell/chooseCoupon/circle1.png");$(".coupons").append('<div class="row noCoupon">暂无可使用的优惠券～</div>')}else $(".error-main-t").html(o.result.message),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)}.bind(this))},render:function(){var e=this.state.couponList;return a.createElement("section",{id:"couponBox",className:"container"},a.createElement(r,{couponList:e}))}});e.exports=c},208:function(e,o,t){"use strict";function a(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function n(){appFc.deleteHistory(function(){var e={backNum:0,closeWebview:1};return JSON.stringify(e)}())}var s,r,c,i,l,m=t(0),u=t(2),p=t(1),d=t(3),h=t(121),g={SCategory_SQueRenDingDan:5080200,SQueRenDingDan_ShouJiHao:5080201,SQueRenDingDan_WeiXinHao:5080202,SQueRenDingDan_TongShouJiHao:5080203,SQueRenDingDan_XuanZeYouHuiQuan:5080204,SQueRenDingDan_TiJiaoDingDan:5080205},f="",y=!1,v="",N=!1,w=!1,b=getParamByUrl("phoneNo"),I={phoneNum:"",ticket:"",outAppLogin:0!=getCookie("appOutPhone")};window.publicData=I;var E=m.createClass((s={displayName:"ConfirmOrder",getInitialState:function(){delCookie("youHuiState");isMobile();return{beginTime_year:"",beginTime_month:"",beginTime_day:"",originPrice:"",currentPrice:"",goodsName:"",infoImg:"",headImg:"",userName:"",onerror:"",couponInfo:[],phoneNum:"",wechatNum:"",selectImg:"image/confirmOrder/order-3.png",goodsId:"",goodReminder:"",youHuiState:"",currentCouponId:"",leftTime:60,againGetCodeShow:!1}},componentWillMount:function(){if(0==I.outAppLogin)window.location.href="https://a.picooc.com/web/fatburn/productDetails.html?linkId="+getParamByUrl("linkId");else{var e=this,o=ajaxLink+"/v1/api/campSell/confirmOrderOut"+window.location.search;console.log(o),$.ajax({type:"get",url:o,dataType:"json",success:function(t){if(console.log(o),200==t.code){$(".alertsVerify .verifyBox .phone").bind("input propertychange",function(){""!=$.trim($(this).val())?$(".alertsVerify .verifyBox .verifyBtn2").css("background","#00AFF0"):$(".alertsVerify .verifyBox .verifyBtn2").css("background","#999999")}),$(".alertsVerify .verifyBox .code").bind("input propertychange",function(){""!=$.trim($(this).val())?$(".alertsVerify .verifyBox .verifyBtn1").css("background","#00AFF0"):$(".alertsVerify .verifyBox .verifyBtn1").css("background","#999999")}),console.log("confirmOrder",t),$("body").show(),$(".good .infoDesc .goodsName").ellipsis({english:!1,lineNum:2}),i=t.resp.goodsInfo.hasLimit;var a=1==t.resp.goodsInfo.hasLimit?t.resp.goodsInfo.especialPrice:t.resp.goodsInfo.curentPrice,n=t.resp.goodsInfo.beginTime.split("-");e.setState({beginTime_year:n[0],beginTime_month:n[1],beginTime_day:n[2],originPrice:t.resp.goodsInfo.originPrice,currentPrice:1==t.resp.goodsInfo.hasLimit?t.resp.goodsInfo.especialPrice:t.resp.goodsInfo.curentPrice,goodsName:t.resp.goodsInfo.gradeName,goodsId:t.resp.goodsInfo.id,goodReminder:t.resp.goodsInfo.goodReminder}),p.subscribe("currentPrice",function(o,a){e.setState({currentPrice:a});var n="",c="",i="";0==t.resp.couponInfo.length?(n="无可使用的优惠",c="-¥0",i="¥"+a):1==t.resp.couponInfo[0].expire||1==t.resp.couponInfo[0].isUse?(n="无可使用的优惠",c="-¥0",i="¥"+a):(n="¥"+t.resp.couponInfo[0].value,c="-¥"+t.resp.couponInfo[0].value,0!=a&&(s=a-t.resp.couponInfo[0].value,s=Math.round(100*s)/100,i="¥"+s));var l={youhuiText:n,youHuiMoney:c,realyPay:i,currentPriceNew:s,firstCouponId:r};console.log(l),p.publish("youhuiData",l)});var s="",r=t.resp.couponInfo.length>0?t.resp.couponInfo[0].id:null;console.log(r),e.setState({onerror:onerror,couponInfo:t.resp.couponInfo});var c="",l="",m="";0==t.resp.couponInfo.length?(c="无可使用的优惠",l="-¥0",m="¥"+a):1==t.resp.couponInfo[0].expire||1==t.resp.couponInfo[0].isUse?(c="无可使用的优惠",l="-¥0",m="¥"+a):(c="¥"+t.resp.couponInfo[0].value,l="-¥"+t.resp.couponInfo[0].value,0!=a&&(s=a-t.resp.couponInfo[0].value,s=Math.round(100*s)/100,m="¥"+s));var u={youhuiText:c,youHuiMoney:l,realyPay:m,currentPriceNew:s,firstCouponId:r};console.log(u),p.publish("youhuiData",u)}else $(".error-main-t").html(t.result.message),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)},error:function(){$(".error-main-t").html("啊哦，您的网络不太给力~"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)}})}},componentWillUnmount:function(){this.serverRequest.abort()},componentWillUpdate:function(){},componentDidMount:function(){var e,o,t=getCookie("confirmOrderPhone"),a=getCookie("confirmOrderWechat"),n=getCookie("userUserId"),s=getCookie("userRoleId");n==getParamByUrl("userId")&&s==getParamByUrl("roleId")?(e=t,o=a):(delCookie("confirmOrderPhone"),delCookie("confirmOrderWechat"),e="",o=""),this.setState({phoneNum:e,wechatNum:o}),setCookie("userUserId",getParamByUrl("userId"),1),setCookie("userRoleId",getParamByUrl("roleId"),1),p.subscribe("jsonData",function(e,o){var t=JSON.parse(o);f=t.currentCouponId,this.setState({youHuiState:t.youHuiState,currentCouponId:t.currentCouponId})}.bind(this))},PhoneNumFoucs:function(e){e.stopPropagation(),setMaiDian(g.SCategory_SQueRenDingDan,g.SQueRenDingDan_ShouJiHao)},WechatNumFoucs:function(e){e.stopPropagation(),setMaiDian(g.SCategory_SQueRenDingDan,g.SQueRenDingDan_WeiXinHao)},PhoneNumInput:function(e){e.stopPropagation();var o=e.currentTarget,t=($(o).val(),"");$(o).val().length>0?$(".check").css("display","block"):$(".check").css("display","none"),t=$("#phoneNum").val()==$("#wechatNum").val()&&""!=$("#phoneNum").val()&&""!=$("#wechatNum").val()?"image/confirmOrder/order-4.png":"image/confirmOrder/order-3.png",this.setState({phoneNum:$(o).val(),selectImg:t}),setCookie("confirmOrderPhone",$(o).val(),1)}},a(s,"WechatNumFoucs",function(e){e.stopPropagation();var o=e.currentTarget,t=($(o).val(),"");t=$("#phoneNum").val()==$("#wechatNum").val()&&""!=$("#phoneNum").val()&&""!=$("#wechatNum").val()?"image/confirmOrder/order-4.png":"image/confirmOrder/order-3.png",this.setState({wechatNum:$(o).val(),selectImg:t}),setCookie("confirmOrderWechat",$(o).val(),1)}),a(s,"SelectStatus",function(e){e.stopPropagation();var o=(e.currentTarget,"");y?(o="image/confirmOrder/order-3.png",this.setState({wechatNum:"",selectImg:o}),y=!1):(o="image/confirmOrder/order-4.png",this.setState({phoneNum:$("#phoneNum").val(),wechatNum:$("#phoneNum").val(),selectImg:o}),y=!0),setMaiDian(g.SCategory_SQueRenDingDan,g.SQueRenDingDan_TongShouJiHao),setCookie("confirmOrderWechat",$("#wechatNum").val(),1)}),a(s,"render",function(){console.log("主组件currentCouponId="+f);var e=this,o=this.state.beginTime_year,t=this.state.beginTime_month,a=this.state.beginTime_day,n=this.state.originPrice,s=this.state.currentPrice,r=(this.state.infoImg,this.state.headImg,this.state.userName,this.state.onerror,this.state.goodsName),c=this.state.couponInfo,i=this.state.goodsId,l=this.state.phoneNum,u=this.state.wechatNum,p=(this.state.selectImg,this.state.goodReminder),g=this.state.youHuiState,f=this.state.currentCouponId;console.log("youHuiState="+g),console.log("currentCouponId="+f);var y={goodsId:i,phoneNo:l,weChat:u,origPrice:n};l.length>0&&$(".check").css("display","block");getParamByUrl("phoneNo");return m.createElement("section",{className:"container"},m.createElement("div",{className:"row noAppTitle",style:{display:"none"}},m.createElement("div",{className:"col-xs-4 col-sm-4"}),m.createElement("div",{className:"col-xs-4 col-sm-4 middle"},m.createElement("img",{src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/productDetails/logoLeft.png"})),m.createElement("div",{className:"col-xs-4 col-sm-4"})),m.createElement("aside",{className:"row infoInput phone"},m.createElement("div",{className:"row col-xs-12 col-sm-12"},m.createElement("div",{className:"col-xs-2 col-sm-2 logo"},m.createElement("img",{src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/confirmOrder/phone.png"})),m.createElement("div",{className:"col-xs-6 col-sm-6 tiaoZheng"},m.createElement("input",{readOnly:!0,id:"phoneNum",type:"tel",placeholder:"您的手机号",onFocus:this.PhoneNumFoucs,onInput:this.PhoneNumInput,value:1==N?I.phoneNum:getParamByUrl("phoneNo"),unselectable:"on"})),m.createElement("div",{className:"changePhone",style:{display:"block"}},m.createElement("span",{className:"changeText",onClick:e.changePhone},"更换")))),m.createElement("aside",{className:"row common good"},m.createElement("div",{className:"row col-xs-12 col-sm-12 aboutInfo"},m.createElement("div",{className:"col-xs-3 col-sm-3 infoImg"},m.createElement("img",{src:p})),m.createElement("div",{className:"col-xs-9 col-sm-9 infoDesc"},m.createElement("div",{className:"goodsName"},m.createElement("p",null,r)),m.createElement("p",{className:"open beginTime"},"开营时间：",m.createElement("span",{className:"year"},o),"年",m.createElement("span",{className:"month"},t),"月",m.createElement("span",{className:"day"},a),"日"),m.createElement("p",{className:"price"},"¥",m.createElement("span",{className:"new-price"},s))))),m.createElement(x,{youHuiState:g,currentCouponId:f,couponInfo:c,currentPrice:s,goods:y}),m.createElement(d,null),m.createElement(h,null),m.createElement("div",{className:"alertsVerify",style:{display:"none"}},m.createElement("div",{className:"bg"}),m.createElement("div",{className:"row verifyBox",style:{display:"none"}},m.createElement("img",{className:"closeImg",onClick:e.closeVerifyFun,src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/productDetails/close.png",alt:""}),m.createElement("div",{className:"title"},"请验证手机号码"),m.createElement("div",{className:"row col-xs-12 col-sm-12 infoInput"},m.createElement("div",{className:"col-xs-2 col-sm-2 logo"},m.createElement("img",{src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/productDetails/verify.png"})),m.createElement("div",{className:"row col-xs-10 col-sm-10 sameHeight"},m.createElement("div",{className:"col-xs-12 col-sm-12 tiaoZheng"},m.createElement("input",{ref:"code",className:"ipt code",type:"text",placeholder:"4 位验证码"})))),m.createElement("div",{className:"col-xs-12 col-sm-12 verifyBtn verifyBtn1",onClick:e.goToVerify},"验证"),m.createElement("div",{className:"col-xs-12 col-sm-12 warning",style:{display:0==e.state.againGetCodeShow?"block":"none"}},"接收短信大约需要",m.createElement("span",null,e.state.leftTime),"s"),m.createElement("div",{className:"col-xs-12 col-sm-12 warning",style:{display:0==e.state.againGetCodeShow?"none":"block"}},"收不到验证码？",m.createElement("span",{className:"againGetCode",onClick:e.liJiVerifyAgain},"重新获取"))),m.createElement("div",{className:"row verifyBox",style:{display:"block"}},m.createElement("img",{className:"closeImg",onClick:e.closeVerifyFun,src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/productDetails/close.png",alt:""}),m.createElement("div",{className:"title"},"请验证手机号码"),m.createElement("div",{className:"row col-xs-12 col-sm-12 infoInput"},m.createElement("div",{className:"col-xs-2 col-sm-2 logo"},m.createElement("img",{src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/productDetails/phone.png"})),m.createElement("div",{className:"row col-xs-10 col-sm-10 sameHeight"},m.createElement("div",{className:"col-xs-12 col-sm-12 tiaoZheng"},m.createElement("input",{ref:"phoneNum",className:"ipt phone",type:"text",placeholder:"输入手机号"})))),m.createElement("div",{className:"col-xs-12 col-sm-12 verifyBtn verifyBtn2",onClick:e.liJiVerify},"立即验证"),m.createElement("div",{className:"col-xs-12 col-sm-12 warning",style:{visibility:"hidden"}},"**")),m.createElement("div",{id:"TCaptcha"})))}),a(s,"changePhone",function(){$(".alertsVerify").show(),$(".alertsVerify .verifyBox").hide().eq(1).show(),$(".alertsVerify .verifyBox .warning").hide().eq(0).show(),$("html, body").css("overflow","hidden").on("touchmove",function(e){if(e=e||event,!e.preventDefault)return!1;e.preventDefault()})}),a(s,"closeVerifyFun",function(){var e=this;clearInterval(r),clearInterval(c),e.setState({leftTime:60}),$(".alertsVerify").hide(),$("html, body").css("overflow","auto").off("touchmove")}),a(s,"liJiVerify",function(){var e=this;if(I.phoneNum=e.refs.phoneNum.value,""!=$.trim(e.refs.phoneNum.value)){/^(((13[0-9]{1})|(14[0-9]{1})|(15[0-9]{1})|(16[0-9]{1})|(17[0-9]{1})|(18[0-9]{1})|(19[0-9]{1}))+\d{8})$/.test(I.phoneNum)?$.ajax({type:"get",url:ajaxLink+"/v1/api/captcha/getTencentUrlForSms",dataType:"json",success:function(o){if(console.log(o),200==o.result.code){console.log("图形验证码",o),$("#graphJs").show().attr("src",o.resp.url);var t=setInterval(function(){if(void 0!=capInit){var o=function(o){if(0==o.ret){$("#TCaptcha").hide(),console.log("retJson",o),I.ticket=o.ticket,$(".alertsVerify .verifyBox").hide().eq(0).show();var t=59;r=setInterval(function(){0==t&&(clearInterval(r),e.setState({againGetCodeShow:!0})),e.setState({leftTime:t--})},1e3),$.ajax({type:"get",url:ajaxLink+"/v1/api/campSell/sendSmsValidateCode?phoneNo="+I.phoneNum+"&ticket="+I.ticket,dataType:"json",success:function(e){console.log(e)}})}else $("#TCaptcha").hide()};clearInterval(t);var a={callback:o,showHeader:!0};capInit(document.getElementById("TCaptcha"),a),$("#TCaptcha").css({display:"block",overflow:"hidden",position:"fixed",top:"0",left:"0",zIndex:"1000",width:$(window).width(),height:$(window).height()}),$("#TCaptcha, #TCaptcha iframe").css("overflow","hidden")}},100)}}}):$(".alerts").eq(5).html("手机号填写有误，请重新核对哦~").stop(!0).fadeIn(200).delay(2e3).fadeOut(200)}}),a(s,"liJiVerifyAgain",function(){var e=this;/^(((13[0-9]{1})|(14[0-9]{1})|(15[0-9]{1})|(16[0-9]{1})|(17[0-9]{1})|(18[0-9]{1})|(19[0-9]{1}))+\d{8})$/.test(I.phoneNum)?$.ajax({type:"get",url:ajaxLink+"/v1/api/captcha/getTencentUrlForSms",dataType:"json",success:function(o){if(console.log(o),200==o.result.code){console.log("图形验证码",o),$("#graphJs").show().attr("src",o.resp.url);var t=setInterval(function(){if(void 0!=capInit){var o=function(o){if(0==o.ret){$("#TCaptcha").hide(),console.log("retJson",o),I.ticket=o.ticket,$(".alertsVerify .verifyBox").hide().eq(0).show(),e.setState({leftTime:60,againGetCodeShow:!1});var t=59;c=setInterval(function(){0==t&&(clearInterval(c),e.setState({againGetCodeShow:!0})),e.setState({leftTime:t--})},1e3),$.ajax({type:"get",url:ajaxLink+"/v1/api/campSell/sendSmsValidateCode?phoneNo="+I.phoneNum+"&ticket="+I.ticket,dataType:"json",success:function(e){console.log(e)}})}else $("#TCaptcha").hide()};clearInterval(t);var a={callback:o,showHeader:!0};capInit(document.getElementById("TCaptcha"),a),$("#TCaptcha").css({display:"block",overflow:"hidden",position:"fixed",top:"0",left:"0",zIndex:"1000",width:$(window).width(),height:$(window).height()}),$("#TCaptcha, #TCaptcha iframe").css("overflow","hidden")}},100)}}}):$(".alerts").eq(5).html("手机号填写有误，请重新核对哦~").stop(!0).fadeIn(200).delay(2e3).fadeOut(200)}),a(s,"goToVerify",function(){var e=this;e.props.alertBox;""!=$.trim(e.refs.code.value)&&(console.log(ajaxLink+"/v1/api/campSell/verifyCode?phoneNo="+I.phoneNum+"&code="+e.refs.code.value),$.ajax({type:"get",url:ajaxLink+"/v1/api/campSell/verifyCode?phoneNo="+I.phoneNum+"&code="+e.refs.code.value,success:function(e){if(console.log(e),200==e.code){N=!0,$(".alertsVerify").hide(),b=I.phoneNum,console.log("appOutPhone="+I.phoneNum),setCookie("appOutPhone",I.phoneNum,7),console.log("更新appOutPhone="+I.phoneNum),$("html, body").css("overflow","auto").off("touchmove"),removeParamByUrl("phoneNo");for(var o=window.location.search.substring(1),t=o.split("&"),a="?",n=0;n<t.length;n++){var s=t[n].split("=");"phoneNo"!=s[0]&&(a+="&"+s[0]+"="+s[1])}window.location.href="confirmOrderOut.html"+a+"&phoneNo="+I.phoneNum}else N=!1,$(".alerts").eq(5).html("验证码输入错误").stop(!0).fadeIn(200).delay(2e3).fadeOut(200)},error:function(e){console.log(e)}}))}),s)),x=m.createClass({displayName:"PriceCont",getInitialState:function(){return{youhuiData2:{},goodsInfos:{}}},componentDidMount:function(){var e=this,o=$(window).height(),t=$(".empty").offset().top;$("body").css("height",o+"px"),$(".pay").show(),t+$(".pay").height()>o&&$(window).scroll(function(){var e=$(window).scrollTop();$(".empty").css("marginBottom","50px"),$(".pay").css("bottom",-e+"px")}),p.subscribe("youhuiData",function(e,o){this.setState({youhuiData2:o})}.bind(this));var a=JSON.parse(localStorage.getItem("goodsInfos"));"false"!=getParamByUrl("code")&&e.goWechatPay(a)},componentWillUpdate:function(){},SelectYhuiClick:function(e){e.stopPropagation(),setMaiDian(g.SCategory_SQueRenDingDan,g.SQueRenDingDan_XuanZeYouHuiQuan),delCookie("youHuiState"),$("#couponBox").css("min-height",$(window).height()),$("#couponBox").css("display","block")},SubmitOrder:function(e){var o=this;if(console.log(o),1==w)o.realSubmitFun();else{var t=ajaxLink+"/v1/api/campSell/confirmOrderOut"+window.location.search;$.ajax({type:"get",url:t,dataType:"json",success:function(e){console.log(e),200==e.code?(l=e.resp.goodsInfo.hasLimit,i==l?o.realSubmitFun():1==i||0==l?(p.publish("currentPrice",e.resp.goodsInfo.curentPrice),$("#nowPrice").html("您选择的商品价格发生了变化，当前价格为："+e.resp.goodsInfo.curentPrice+"元，是否继续提交订单？"),$(".payOrNotBox").show()):0!=i&&1!=l||(p.publish("currentPrice",e.resp.goodsInfo.especialPrice),$("#nowPrice").html("您选择的商品价格发生了变化，当前价格为："+e.resp.goodsInfo.especialPrice+"元，是否继续提交订单？"),$(".payOrNotBox").show())):($(".error-main-t").html(e.result.message),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2))},error:function(){$(".error-main-t").html("啊哦，您的网络不太给力~"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)}})}},realSubmitFun:function(){var e=this;console.log("submit",e),event.stopPropagation(),setMaiDian(g.SCategory_SQueRenDingDan,g.SQueRenDingDan_TiJiaoDingDan);var o=this.props.goods,t=(o.phoneNo,o.goodsId,o.weChat,o.origPrice),a=this.props.currentPrice,n=this.state.youhuiData2.currentPriceNew,s=this.state.youhuiData2.youHuiMoney.substring(2),r=this.state.youhuiData2.firstCouponId,c=ajaxLink+"/v1/api/campSell/getClassStockOut"+window.location.search;console.log(c),$.ajax({type:"get",url:c,dataType:"json",success:function(o){if(console.log(3,o),200==o.code){if(console.log("data.resp="+o.resp),1==o.resp)$(".alerts").eq(0).stop(!0).fadeIn(200).delay(2e3).fadeOut(200);else if(2==o.resp)$(".alerts").eq(1).stop(!0).fadeIn(200).delay(2e3).fadeOut(200);else if(5==o.resp)$(".alerts").eq(5).html("您在当前所选时段内已有订单啦，处理后再来试试吧～").stop(!0).fadeIn(200).delay(2e3).fadeOut(200);else if((3==o.resp||4==o.resp||7==o.resp||8==o.resp)&&"0"==$(".submit span").attr("data-clicked")){$(".submit span").attr("data-clicked","1");var c="";c=1==getParamByUrl("refer")?"appBanner":2==getParamByUrl("refer")?"push":3==getParamByUrl("refer")?"kaiPing":4==getParamByUrl("refer")?"orderDetail":6==getParamByUrl("refer")?"woDe":5==getParamByUrl("refer")?"wenzhang":"other";var i,l=navigator.userAgent.toLowerCase();i=isOutApp()?"micromessenger"==l.match(/MicroMessenger/i)?"微信":"weibo"==l.match(/WeiBo/i)?"微博":" qq"==l.match(/\sQQ/i)?"QQ":"浏览器":"燃脂营APP";var m={coachId:parseInt(getParamByUrl("coachId")),linkId:parseInt(getParamByUrl("linkId")),goodsId:parseInt(getParamByUrl("classId")),userId:0,phoneNo:b,origPrice:t,currentPrice:s>0?n:a,couponPrice:parseInt(s),isCoupon:s>0?1:0,couponId:s>0?""==v?r:f:null,sourceType:i,trafficSource:c,isOwnPicooc:parseInt(getParamByUrl("isOwnPicooc"))};if(e.setState({goodsInfos:m}),localStorage.setItem("goodsInfos",JSON.stringify(m)),"micromessenger"==l.match(/MicroMessenger/i)){getParamByUrl("code");if("false"==getParamByUrl("code")){removeParamByUrl("phoneNo");for(var u=window.location.search.substring(1),p=u.split("&"),d="?",h=0;h<p.length;h++){var g=p[h].split("=");"phoneNo"!=g[0]&&(d+="&"+g[0]+"="+g[1])}var y=window.location.protocol+"//"+window.location.host+window.location.pathname+d+"&phoneNo="+b,u="https://open.weixin.qq.com/connect/oauth2/authorize?appid=wxa291214cb3348ead&redirect_uri="+encodeURIComponent(y)+"&response_type=code&scope=snsapi_base&state=STATE%23wechat_redirect&connect_redirect=1#wechat_redirect";location.href=u}}else e.goH5WechatPay(m)}}else $(".error-main-t").html(o.result.message),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)},error:function(){$(".error-main-t").html("啊哦，您的网络不太给力~"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".error-main").height()/2)}})},goWechatPay:function(e){$.ajax({url:ajaxLink+"/v1/api/campOrder/generatePublicOrder"+location.search,type:"post",data:JSON.stringify(e),dataType:"json",contentType:"application/json",success:function(e){if(200==e.code){var o=e.resp;removeParamByUrl("phoneNo");for(var t=window.location.search.substring(1),a=t.split("&"),n="?",s=0;s<a.length;s++){var r=a[s].split("=");"phoneNo"!=r[0]&&(n+="&"+r[0]+"="+r[1])}window.location.href="payment.html"+n+"&phoneNo="+b+"&orderId="+o+"&fromGo=1"}else $(".error-main-t").html(e.reap.result),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".fixbg-main").height()/2)},error:function(){$(".error-main-t").html("网络错误"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".fixbg-main").height()/2)}})},goH5WechatPay:function(e){var e=e,o=ajaxLink+"/v1/api/campOrder/generateH5Order"+window.location.search;$.ajax({type:"post",url:o,dataType:"json",contentType:"application/json",data:JSON.stringify(e),success:function(e){if(console.log("goH5WechatPay",e),200==e.code){var o=e.resp.orderUrl,t=e.resp.orderId;removeParamByUrl("phoneNo");for(var a=window.location.search.substring(1),n=a.split("&"),s="?",r=0;r<n.length;r++){var c=n[r].split("=");"phoneNo"!=c[0]&&(s+="&"+c[0]+"="+c[1])}window.location.href="payment.html"+s+"&phoneNo="+b+"&orderUrl="+o+"&orderId="+t+"&fromGo=1"}else $(".error-main-t").html(e.resp.result),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".fixbg-main").height()/2)},error:function(){$(".error-main-t").html("网络错误"),$(".errorAlert").css("display","block"),$(".error-main").css("margin-top",-$(".fixbg-main").height()/2)}})},render:function(){var e=this;console.log("realy",this);var o=this.state.youhuiData2,t=this.props.currentPrice,a="",n="",s="",r="";v=this.props.youHuiState,f=this.props.currentCouponId,""!=v&&(void 0==v?(a="不使用优惠券",n="-¥0",s="¥"+t):(a="¥"+v,n="-¥"+v,0!=t&&(r=t-v,r=Math.round(100*r)/100,s="¥"+r)),o.youhuiText=a,o.youHuiMoney=n,o.realyPay=s,o.currentPriceNew=r);var t=this.props.currentPrice,a=o.youhuiText,n=o.youHuiMoney,s=o.realyPay;return m.createElement("div",null,m.createElement("aside",{className:"row common sameHeight youhui",onClick:this.SelectYhuiClick},m.createElement("div",{className:"col-xs-12 col-sm-12"},m.createElement("div",{className:"col-xs-6 col-sm-6 status"},m.createElement("img",{src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/confirmOrder/youhui.png"})," ",m.createElement("span",{className:"aboutYouhui"},"优惠券")),m.createElement("div",{className:"col-xs-6 col-sm-6 right money"},m.createElement("span",null,a)," ",m.createElement("img",{src:"https://cdn2.picooc.com/web/res/fatburn/image/sell/confirmOrder/more.png"})))),m.createElement("aside",{className:"row common jine"},m.createElement("div",{className:"col-xs-12 col-sm-12 first"},m.createElement("div",{className:"col-xs-6 col-sm-6 status"},"商品金额"),m.createElement("div",{className:"col-xs-6 col-sm-6 right money"},"¥",m.createElement("span",{className:"new-price"},t))),m.createElement("div",{className:"col-xs-12 col-sm-12"},m.createElement("div",{className:"col-xs-6 col-sm-6 status"},"优惠金额"),m.createElement("div",{className:"col-xs-6 col-sm-6 right money youHuiMoney"},n))),m.createElement("aside",{className:"empty"}),m.createElement("aside",{className:"row sameHeight pay",style:{display:"none"}},m.createElement("div",{className:"col-xs-6 col-sm-6 realyPay"},"实付款:  ",m.createElement("span",{className:"money"},s)),m.createElement("div",{className:"col-xs-6 col-sm-6 submit right"},m.createElement("span",{"data-clicked":"0",onClick:this.SubmitOrder},"提交订单"))),m.createElement("aside",{className:"alertBox"},m.createElement("div",{className:"alerts",style:{display:"none"}},"已拍完，但还有人未付款，待会儿再来看看吧～"),m.createElement("div",{className:"alerts",style:{display:"none"}},"手慢了，名额被抢光啦～"),m.createElement("div",{className:"alerts",style:{display:"none"}},"同一账号只能购买一次哦!请核对参营人员信息～"),m.createElement("div",{className:"alerts",style:{display:"none"}},"请填写参营人员手机号码～"),m.createElement("div",{className:"alerts",style:{display:"none"}},"手机号填写有误，请重新核对哦～"),m.createElement("div",{className:"alerts",style:{display:"none"}})),m.createElement("aside",{className:"payOrNotBox",style:{display:"none"}},m.createElement("div",{className:"payOrNot",id:"nowPrice"}),m.createElement("div",{className:"btns row"},m.createElement("div",{className:"col-xs-6 col-sm-6 left",onClick:e.cancelPay},"取消"),m.createElement("div",{className:"col-xs-6 col-sm-6 right",onClick:e.confirmPay},"提交"))))},cancelPay:function(){w=!0,$(".payOrNotBox").hide()},confirmPay:function(){var e=this;w=!0,$(".payOrNotBox").hide(),e.realSubmitFun()}});u.render(m.createElement(E,null),document.getElementById("order_box")),window.gobackToGood=n}},[208]);