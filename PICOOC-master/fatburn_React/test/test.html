<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>react</title>
    <link rel="stylesheet" type="text/css" href="./css/bootstrap.css">
    <style type="text/css">
    table th,
    table td {
        text-align: center;
    }
    </style>
    
    <script>
  
    </script>
    
    <script src="src/react.min.js"></script>
    <script src="src/react-dom.min.js"></script>

    <script src="src/browser.min.js"></script>
    <script src="src/pubsub.js"></script>
<!--<script src="http://cdn.bootcss.com/babel-standalone/6.22.1/babel.min.js"></script>
    <script src="src/pubsub.js"></script>
   
     <script src="https://cdn.bootcss.com/react/15.4.2/react.min.js"></script>
    <script src="https://cdn.bootcss.com/react/15.4.2/react-dom.min.js"></script>
    <script src="https://cdn.bootcss.com/babel-standalone/6.22.1/babel.min.js"></script>
     -->
</head>

<body>
    <div class="container" id="studentInfo"></div>
    <script src="src/a.js"></script>
    <script type="text/babel">
        var data =  [
                        {stName:"1",gender:"女",age:18,height:165,weigth:45,_id:2},
                        {stName:"2",gender:"男",age:35,height:180,weigth:80,_id:0},
                        {stName:"3",gender:"女",age:22,height:171,weigth:60,_id:6},
                        {stName:"4",gender:"男",age:26,height:175,weigth:70,_id:1},
                        {stName:"5",gender:"女",age:18,height:170,weigth:50,_id:3},
                        {stName:"6",gender:"女",age:38,height:166,weigth:50,_id:4},
                        {stName:"7",gender:"男",age:30,height:175,weigth:65,_id:5}
                     ];
        
        var StudentApp=React.createClass({

            aaa:function(){
                    data.push({stName:"8",gender:"男",age:30,height:175,weigth:65,_id:5});
                    console.log(data);
                    this.setState({studentData:data});
                
            },
            bbb:function(e){
                //console.log(document.getElementById("1").value);
                this.setState({genderValue:e.target.value});
                
            },

            getInitialState:function(){

                return {
                    studentData:data,
                    genderValue:"all",
                }
            },
            componentDidMount:function(){
                PubSub.subscribe("delectItem",function(evName,_id){
                    var newArr = this.state.studentData.filter(function(item){
                        return item._id !== _id
                    });
                    this.setState({studentData:newArr});
                }.bind(this)); 
            },
          render: function() {
            
            return (
              <div>
                <h1 onClick={this.aaa} >学员成信息表</h1>
                <div className="bs-example">
                    <div className="form-group">
                        <label>按性别筛选</label>
                        <select className="form-control" id="1" onChange={this.bbb}>
                            <option value="all">all</option>
                            <option value="1">男</option>
                            <option value="0">女</option>
                        </select>
                    </div>
                    <div className="form-group">
                        <label>按名字筛选</label>
                        <input type="text" className="form-control" placeholder="请输入名字" />
                    </div>
                </div>
                <StudentInfoComponent studentData={this.state.studentData}  genderValue={this.state.genderValue} />
              </div>
            );
          }
        });
        var StudentInfoComponent=React.createClass({
           // var studentsss=this.props.studentData;
            
            render:function(){
                var studentsss = this.props.studentData;
                var genderVal = this.props.genderValue;
                var list=[];
                for(var i=0;i<studentsss.length;i++){
                    if(genderVal==1){
                        if(studentsss[i].gender=="男"){
                            list.push( <StudentItemComponent studentItem={studentsss[i]} key={i} /> )
                        }
                    }
                    else if(genderVal==0){
                        if(studentsss[i].gender=="女"){
                            list.push( <StudentItemComponent studentItem={studentsss[i]} key={i} /> )
                        }
                    }
                    else{
                        list.push( <StudentItemComponent studentItem={studentsss[i]} key={i} /> )
                    }
                    
                }
                return (
                    <div className="table-responsive">
                        <table className="table table-bordered table-hover">
                            <thead>
                                <tr>
                                    <th>姓名</th>
                                    <th>性别</th>
                                    <th>年龄</th>
                                    <th>身高（cm）</th>
                                    <th>体重（kg）</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody id="tb">
                                {list}
                            </tbody>
                        </table>
                    </div>
                );
            }
        });
        var StudentItemComponent=React.createClass({
            delectItem:function(){
                PubSub.publish("delectItem",this.props.studentItem._id);
            },
            render:function(){
                var item=this.props.studentItem;
                var index=this.props.i;
                return (
                    <tr>
                        <td>{item.stName}</td>
                        <td>{item.gender}</td>
                        <td>{item.age}</td>
                        <td>{item.height}</td>
                        <td>{item.weigth}</td>
                        <td><a href="javascript:;" onClick = {this.delectItem} >删除</a> </td>
                    </tr>
                );
                
            }
        });
        ReactDOM.render(
            <StudentApp />,
            document.getElementById('studentInfo')
        );
/*ReactDOM.render(
        <h1>Hello, world!</h1>,
        document.getElementById('example')
      );*/
        //ReactDOM.render(<h1>Hello, world!</h1>,document.getElementById('example'));

    </script>
    <!--<div id="example"></div>
    
    <script type="text/babel">
      ReactDOM.render(
        <h1>Hello, world!</h1>,
        document.getElementById('example')
      );
    </script>
    -->
</body>

</html>
