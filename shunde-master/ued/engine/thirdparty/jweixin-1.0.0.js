!function(l,v){"function"==typeof define&&(define.amd||define.cmd)?define(function(){return v(l)}):v(l,!0)}(this,function(l,v){function e(a,c,b){l.WeixinJSBridge?WeixinJSBridge.invoke(a,G(c),function(c){H(a,c,b)}):w(a,b)}function r(a,c,b){l.WeixinJSBridge?WeixinJSBridge.on(a,function(d){b&&b.trigger&&b.trigger(d);H(a,d,c)}):b?w(a,b):w(a,c)}function G(a){return a=a||{},a.appId=k.appId,a.verifyAppId=k.appId,a.verifySignType="sha1",a.verifyTimestamp=k.timestamp+"",a.verifyNonceStr=k.nonceStr,a.verifySignature=
k.signature,a}function H(a,c,b){var d,e;delete c.err_code;delete c.err_desc;delete c.err_detail;d=c.errMsg;if(!d){d=c.err_msg;delete c.err_msg;var f,g,h=x[a];d=(h&&(a=h),f="ok",d&&(g=d.indexOf(":"),f=d.substring(g+1),"confirm"==f&&(f="ok"),"failed"==f&&(f="fail"),-1!=f.indexOf("failed_")&&(f=f.substring(7)),-1!=f.indexOf("fail_")&&(f=f.substring(5)),f=f.replace(/_/g," "),f=f.toLowerCase(),("access denied"==f||"no permission to execute"==f)&&(f="permission denied"),"config"==a&&"function not exist"==
f&&(f="ok"),""==f&&(f="fail")),a+":"+f);c.errMsg=d}switch(b=b||{},b._complete&&(b._complete(c),delete b._complete),d=c.errMsg||"",k.debug&&!b.isInnerInvoke&&alert(JSON.stringify(c)),e=d.indexOf(":"),d.substring(e+1)){case "ok":b.success&&b.success(c);break;case "cancel":b.cancel&&b.cancel(c);break;default:b.fail&&b.fail(c)}b.complete&&b.complete(c)}function I(a){var c,b,d;if(a){c=0;for(b=a.length;b>c;++c)d=a[c],(d=h[d])&&(a[c]=d);return a}}function w(a,c){if(!(!k.debug||c&&c.isInnerInvoke)){var b=
x[a];b&&(a=b);c&&c._complete&&delete c._complete;console.log('"'+a+'",',c||"")}}function M(){0!=g.preVerifyState&&(J||K||k.debug||"6.0.2">y||0>g.systemType||B||(B=!0,g.appId=k.appId,g.initTime=n.initEndTime-n.initStartTime,g.preVerifyTime=n.preVerifyEndTime-n.preVerifyStartTime,t.getNetworkType({isInnerInvoke:!0,success:function(a){g.networkType=a.networkType;a="http://open.weixin.qq.com/sdk/report?v="+g.version+"&o="+g.preVerifyState+"&s="+g.systemType+"&c="+g.clientVersion+"&a="+g.appId+"&n="+g.networkType+
"&i="+g.initTime+"&p="+g.preVerifyTime+"&u="+g.url;(new Image).src=a}})))}function L(a){C&&(l.WeixinJSBridge?a():z.addEventListener&&z.addEventListener("WeixinJSBridgeReady",a,!1))}function N(){t.invoke||(t.invoke=function(a,c,b){l.WeixinJSBridge&&WeixinJSBridge.invoke(a,G(c),b)},t.on=function(a,c){l.WeixinJSBridge&&WeixinJSBridge.on(a,c)})}var h,x,z,u,p,D,J,K,C,A,E,y,B,F,n,g,k,m,q,t;if(!l.jWeixin)return h={config:"preVerifyJSAPI",onMenuShareTimeline:"menu:share:timeline",onMenuShareAppMessage:"menu:share:appmessage",
onMenuShareQQ:"menu:share:qq",onMenuShareWeibo:"menu:share:weiboApp",onMenuShareQZone:"menu:share:QZone",previewImage:"imagePreview",getLocation:"geoLocation",openProductSpecificView:"openProductViewWithPid",addCard:"batchAddCard",openCard:"batchViewCard",chooseWXPay:"getBrandWCPayRequest"},x=function(){var a,c={};for(a in h)c[h[a]]=a;return c}(),z=l.document,u=z.title,p=navigator.userAgent.toLowerCase(),D=navigator.platform.toLowerCase(),J=!(!D.match("mac")&&!D.match("win")),K=-1!=p.indexOf("wxdebugger"),
C=-1!=p.indexOf("micromessenger"),A=-1!=p.indexOf("android"),E=-1!=p.indexOf("iphone")||-1!=p.indexOf("ipad"),y=function(){var a=p.match(/micromessenger\/(\d+\.\d+\.\d+)/)||p.match(/micromessenger\/(\d+\.\d+)/);return a?a[1]:""}(),B=!1,F=!1,n={initStartTime:(new Date).getTime(),initEndTime:0,preVerifyStartTime:0,preVerifyEndTime:0},g={version:1,appId:"",initTime:0,preVerifyTime:0,networkType:"",preVerifyState:1,systemType:E?1:A?2:-1,clientVersion:y,url:encodeURIComponent(location.href)},k={},m={_completes:[]},
q={state:0,data:{}},L(function(){n.initEndTime=(new Date).getTime()}),t={config:function(a){k=a;w("config",a);var c=!1===k.check?!1:!0;L(function(){var a,d,l;if(c)e(h.config,{verifyJsApiList:I(k.jsApiList)},function(){m._complete=function(a){n.preVerifyEndTime=(new Date).getTime();q.state=1;q.data=a};m.success=function(){g.preVerifyState=0};m.fail=function(a){m._fail?m._fail(a):q.state=-1};var a=m._completes;return a.push(function(){M()}),m.complete=function(){for(var c=0,b=a.length;b>c;++c)a[c]();
m._completes=[]},m}()),n.preVerifyStartTime=(new Date).getTime();else{q.state=1;a=m._completes;d=0;for(l=a.length;l>d;++d)a[d]();m._completes=[]}});k.beta&&N()},ready:function(a){0!=q.state?a():(m._completes.push(a),!C&&k.debug&&a())},error:function(a){"6.0.2">y||F||(F=!0,-1==q.state?a(q.data):m._fail=a)},checkJsApi:function(a){e("checkJsApi",{jsApiList:I(a.jsApiList)},function(){return a._complete=function(a){if(A){var b=a.checkResult;b&&(a.checkResult=JSON.parse(b))}var d,b=a.checkResult;for(d in b)(a=
x[d])&&(b[a]=b[d],delete b[d])},a}())},onMenuShareTimeline:function(a){r(h.onMenuShareTimeline,{complete:function(){e("shareTimeline",{title:a.title||u,desc:a.title||u,img_url:a.imgUrl||"",link:a.link||location.href,type:a.type||"link",data_url:a.dataUrl||""},a)}},a)},onMenuShareAppMessage:function(a){r(h.onMenuShareAppMessage,{complete:function(){e("sendAppMessage",{title:a.title||u,desc:a.desc||"",link:a.link||location.href,img_url:a.imgUrl||"",type:a.type||"link",data_url:a.dataUrl||""},a)}},a)},
onMenuShareQQ:function(a){r(h.onMenuShareQQ,{complete:function(){e("shareQQ",{title:a.title||u,desc:a.desc||"",img_url:a.imgUrl||"",link:a.link||location.href},a)}},a)},onMenuShareWeibo:function(a){r(h.onMenuShareWeibo,{complete:function(){e("shareWeiboApp",{title:a.title||u,desc:a.desc||"",img_url:a.imgUrl||"",link:a.link||location.href},a)}},a)},onMenuShareQZone:function(a){r(h.onMenuShareQZone,{complete:function(){e("shareQZone",{title:a.title||u,desc:a.desc||"",img_url:a.imgUrl||"",link:a.link||
location.href},a)}},a)},startRecord:function(a){e("startRecord",{},a)},stopRecord:function(a){e("stopRecord",{},a)},onVoiceRecordEnd:function(a){r("onVoiceRecordEnd",a)},playVoice:function(a){e("playVoice",{localId:a.localId},a)},pauseVoice:function(a){e("pauseVoice",{localId:a.localId},a)},stopVoice:function(a){e("stopVoice",{localId:a.localId},a)},onVoicePlayEnd:function(a){r("onVoicePlayEnd",a)},uploadVoice:function(a){e("uploadVoice",{localId:a.localId,isShowProgressTips:0==a.isShowProgressTips?
0:1},a)},downloadVoice:function(a){e("downloadVoice",{serverId:a.serverId,isShowProgressTips:0==a.isShowProgressTips?0:1},a)},translateVoice:function(a){e("translateVoice",{localId:a.localId,isShowProgressTips:0==a.isShowProgressTips?0:1},a)},chooseImage:function(a){e("chooseImage",{scene:"1|2",count:a.count||9,sizeType:a.sizeType||["original","compressed"],sourceType:a.sourceType||["album","camera"]},function(){return a._complete=function(a){if(A){var b=a.localIds;b&&(a.localIds=JSON.parse(b))}},
a}())},previewImage:function(a){e(h.previewImage,{current:a.current,urls:a.urls},a)},uploadImage:function(a){e("uploadImage",{localId:a.localId,isShowProgressTips:0==a.isShowProgressTips?0:1},a)},downloadImage:function(a){e("downloadImage",{serverId:a.serverId,isShowProgressTips:0==a.isShowProgressTips?0:1},a)},getNetworkType:function(a){e("getNetworkType",{},function(){return a._complete=function(a){var b,d,e=a.errMsg;if(a.errMsg="getNetworkType:ok",b=a.subtype,delete a.subtype,b)a.networkType=b;
else switch(d=e.indexOf(":"),b=e.substring(d+1)){case "wifi":case "edge":case "wwan":a.networkType=b;break;default:a.errMsg="getNetworkType:fail"}},a}())},openLocation:function(a){e("openLocation",{latitude:a.latitude,longitude:a.longitude,name:a.name||"",address:a.address||"",scale:a.scale||28,infoUrl:a.infoUrl||""},a)},getLocation:function(a){a=a||{};e(h.getLocation,{type:a.type||"wgs84"},function(){return a._complete=function(a){delete a.type},a}())},hideOptionMenu:function(a){e("hideOptionMenu",
{},a)},showOptionMenu:function(a){e("showOptionMenu",{},a)},closeWindow:function(a){a=a||{};e("closeWindow",{},a)},hideMenuItems:function(a){e("hideMenuItems",{menuList:a.menuList},a)},showMenuItems:function(a){e("showMenuItems",{menuList:a.menuList},a)},hideAllNonBaseMenuItem:function(a){e("hideAllNonBaseMenuItem",{},a)},showAllNonBaseMenuItem:function(a){e("showAllNonBaseMenuItem",{},a)},scanQRCode:function(a){a=a||{};e("scanQRCode",{needResult:a.needResult||0,scanType:a.scanType||["qrCode","barCode"]},
function(){return a._complete=function(a){var b,d;E&&(b=a.resultStr,b&&(d=JSON.parse(b),a.resultStr=d&&d.scan_code&&d.scan_code.scan_result))},a}())},openProductSpecificView:function(a){e(h.openProductSpecificView,{pid:a.productId,view_type:a.viewType||0,ext_info:a.extInfo},a)},addCard:function(a){var c,b,d,g=a.cardList,f=[];c=0;for(b=g.length;b>c;++c)d=g[c],d={card_id:d.cardId,card_ext:d.cardExt},f.push(d);e(h.addCard,{card_list:f},function(){return a._complete=function(a){var c,b,d,e=a.card_list;
if(e){e=JSON.parse(e);c=0;for(b=e.length;b>c;++c)d=e[c],d.cardId=d.card_id,d.cardExt=d.card_ext,d.isSuccess=d.is_succ?!0:!1,delete d.card_id,delete d.card_ext,delete d.is_succ;a.cardList=e;delete a.card_list}},a}())},chooseCard:function(a){e("chooseCard",{app_id:k.appId,location_id:a.shopId||"",sign_type:a.signType||"SHA1",card_id:a.cardId||"",card_type:a.cardType||"",card_sign:a.cardSign,time_stamp:a.timestamp+"",nonce_str:a.nonceStr},function(){return a._complete=function(a){a.cardList=a.choose_card_info;
delete a.choose_card_info},a}())},openCard:function(a){var c,b,d,g=a.cardList,f=[];c=0;for(b=g.length;b>c;++c)d=g[c],d={card_id:d.cardId,code:d.code},f.push(d);e(h.openCard,{card_list:f},a)},chooseWXPay:function(a){e(h.chooseWXPay,{timeStamp:a.timestamp+"",nonceStr:a.nonceStr,"package":a["package"],paySign:a.paySign,signType:a.signType||"SHA1"},a)}},v&&(l.wx=l.jWeixin=t),t});
