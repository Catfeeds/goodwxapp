module("vizengine_core.js",function(){var B=com.vizengine.core.Object;B.extend("com.vizengine.math.Matrix4",{init:function(){this.elements=[];this.identity()},set:function(b,c,a,e,g,h,d,k,l,m,n,p,q,r,t,u){var f=this.elements;f[0]=b;f[4]=c;f[8]=a;f[12]=e;f[1]=g;f[5]=h;f[9]=d;f[13]=k;f[2]=l;f[6]=m;f[10]=n;f[14]=p;f[3]=q;f[7]=r;f[11]=t;f[15]=u;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},fromArray:function(b,c){null==c&&(c=0);for(var a=0;16>a;a++)this.elements[a]=
b[a+c];return this},toArray:function(b,c){null==b&&(b=[]);null==c&&(c=0);var a=this.elements;b[c]=a[0];b[c+1]=a[1];b[c+2]=a[2];b[c+3]=a[3];b[c+4]=a[4];b[c+5]=a[5];b[c+6]=a[6];b[c+7]=a[7];b[c+8]=a[8];b[c+9]=a[9];b[c+10]=a[10];b[c+11]=a[11];b[c+12]=a[12];b[c+13]=a[13];b[c+14]=a[14];b[c+15]=a[15];return b},equals:function(b){var c=this.elements;b=b.elements;for(var a=0;16>a;a++)if(c[a]!==b[a])return!1;return!0},clone:function(){return(new com.vizengine.math.Matrix4).fromArray(this.elements)},copyFrom:function(b){var c=
this.elements;b=b.elements;for(var a=0;16>a;a++)c[a]=b[a];return this},multiply:function(){var b,c;if(1==arguments.length)b=this,c=arguments[0];else if(2==arguments.length)b=arguments[0],c=arguments[1];else return null;var a=b.elements,e=c.elements;c=this.elements;b=a[0];var g=a[4],h=a[8],d=a[12],k=a[1],l=a[5],m=a[9],n=a[13],p=a[2],q=a[6],r=a[10],t=a[14],u=a[3],f=a[7],w=a[11],a=a[15],x=e[0],y=e[4],z=e[8],A=e[12],v=e[1],C=e[5],D=e[9],E=e[13],F=e[2],G=e[6],H=e[10],I=e[14],J=e[3],K=e[7],L=e[11],e=e[15];
c[0]=b*x+g*v+h*F+d*J;c[4]=b*y+g*C+h*G+d*K;c[8]=b*z+g*D+h*H+d*L;c[12]=b*A+g*E+h*I+d*e;c[1]=k*x+l*v+m*F+n*J;c[5]=k*y+l*C+m*G+n*K;c[9]=k*z+l*D+m*H+n*L;c[13]=k*A+l*E+m*I+n*e;c[2]=p*x+q*v+r*F+t*J;c[6]=p*y+q*C+r*G+t*K;c[10]=p*z+q*D+r*H+t*L;c[14]=p*A+q*E+r*I+t*e;c[3]=u*x+f*v+w*F+a*J;c[7]=u*y+f*C+w*G+a*K;c[11]=u*z+f*D+w*H+a*L;c[15]=u*A+f*E+w*I+a*e;return this},premultiply:function(b){return this.multiply(b,this)},translate:function(b,c,a){return this.multiply((new x).setTranslation(b,c,a))},rotateX:function(b){return this.multiply((new x).setRotationX(b))},
rotateY:function(b){return this.multiply((new x).setRotationY(b))},rotateZ:function(b){return this.multiply((new x).setRotationZ(b))},scale:function(b,c,a){return this.multiply((new x).setScale(b,c,a))},perspective:function(b,c,a,e){return this.multiply((new x).setPerspective(b,c,a,e))},setTranslation:function(b,c,a){this.set(1,0,0,b,0,1,0,c,0,0,1,a,0,0,0,1);return this},setRotationX:function(b){var c=Math.cos(b);b=Math.sin(b);this.set(1,0,0,0,0,c,-b,0,0,b,c,0,0,0,0,1);return this},setRotationY:function(b){var c=
Math.cos(b);b=Math.sin(b);this.set(c,0,b,0,0,1,0,0,-b,0,c,0,0,0,0,1);return this},setRotationZ:function(b){var c=Math.cos(b);b=Math.sin(b);this.set(c,-b,0,0,b,c,0,0,0,0,1,0,0,0,0,1);return this},setScale:function(b,c,a){this.set(b,0,0,0,0,c,0,0,0,0,a,0,0,0,0,1);return this},setFrustum:function(b,c,a,e,g,h){var d=this.elements;d[0]=2*g/(c-b);d[4]=0;d[8]=(c+b)/(c-b);d[12]=0;d[1]=0;d[5]=2*g/(a-e);d[9]=(a+e)/(a-e);d[13]=0;d[2]=0;d[6]=0;d[10]=-(h+g)/(h-g);d[14]=-2*h*g/(h-g);d[3]=0;d[7]=0;d[11]=-1;d[15]=
0;return this},setPerspective:function(b,c,a,e){b=a*Math.tan(b/2);c*=b;return this.setFrustum(-c,c,b,-b,a,e)},setOrthographic:function(b,c,a,e,g,h){var d=this.elements,k=1/(c-b),l=1/(a-e),m=1/(h-g);d[0]=2*k;d[4]=0;d[8]=0;d[12]=-((c+b)*k);d[1]=0;d[5]=2*l;d[9]=0;d[13]=-((a+e)*l);d[2]=0;d[6]=0;d[10]=-2*m;d[14]=-((h+g)*m);d[3]=0;d[7]=0;d[11]=0;d[15]=1;return this},getInverse:function(){var b=new x,c=b.elements,a=this.elements,e=a[0],g=a[1],h=a[2],d=a[3],k=a[4],l=a[5],m=a[6],n=a[7],p=a[8],q=a[9],r=a[10],
t=a[11],u=a[12],f=a[13],w=a[14],a=a[15],B=q*w*n-f*r*n+f*m*t-l*w*t-q*m*a+l*r*a,y=u*r*n-p*w*n-u*m*t+k*w*t+p*m*a-k*r*a,z=p*f*n-u*q*n+u*l*t-k*f*t-p*l*a+k*q*a,A=u*q*m-p*f*m-u*l*r+k*f*r+p*l*w-k*q*w,v=e*B+g*y+h*z+d*A;if(0===v)return console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0"),null;v=1/v;c[0]=B*v;c[1]=(f*r*d-q*w*d-f*h*t+g*w*t+q*h*a-g*r*a)*v;c[2]=(l*w*d-f*m*d+f*h*n-g*w*n-l*h*a+g*m*a)*v;c[3]=(q*m*d-l*r*d-q*h*n+g*r*n+l*h*t-g*m*t)*v;c[4]=y*v;c[5]=(p*w*d-u*r*d+u*h*t-e*w*t-p*h*a+
e*r*a)*v;c[6]=(u*m*d-k*w*d-u*h*n+e*w*n+k*h*a-e*m*a)*v;c[7]=(k*r*d-p*m*d+p*h*n-e*r*n-k*h*t+e*m*t)*v;c[8]=z*v;c[9]=(u*q*d-p*f*d-u*g*t+e*f*t+p*g*a-e*q*a)*v;c[10]=(k*f*d-u*l*d+u*g*n-e*f*n-k*g*a+e*l*a)*v;c[11]=(p*l*d-k*q*d-p*g*n+e*q*n+k*g*t-e*l*t)*v;c[12]=A*v;c[13]=(p*f*h-u*q*h+u*g*r-e*f*r-p*g*w+e*q*w)*v;c[14]=(u*l*h-k*f*h-u*g*m+e*f*m+k*g*w-e*l*w)*v;c[15]=(k*q*h-p*l*h+p*g*m-e*q*m-k*g*r+e*l*r)*v;return b}});var x=com.vizengine.math.Matrix4;B.extend("com.vizengine.math.Vector3",{init:function(b,c,a){this.set(b,
c,a)},set:function(b,c,a){this.x=null==b?0:b;this.y=null==c?0:c;this.z=null==a?0:a},applyMatrix4:function(b){var c=this.x,a=this.y,e=this.z;b=b.elements;this.x=b[0]*c+b[4]*a+b[8]*e+b[12];this.y=b[1]*c+b[5]*a+b[9]*e+b[13];this.z=b[2]*c+b[6]*a+b[10]*e+b[14];return this.multiplyScalar(1/(b[3]*c+b[7]*a+b[11]*e+b[15]))},multiplyScalar:function(b){this.x*=b;this.y*=b;this.z*=b;return this}})});
