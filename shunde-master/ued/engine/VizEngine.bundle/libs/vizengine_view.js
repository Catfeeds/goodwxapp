module("vizengine_animation.js",function(){com.vizengine.view={};var u=com.vizengine.core.Object,r=com.vizengine.core.StringUtil,z=com.vizengine.gesture.TouchPoint,G=com.vizengine.gesture.TapGestureDetector,w=com.vizengine.animation.Animation,t=com.vizengine.animation.TranslateAnimation,H=com.vizengine.gesture.PanGestureDetector,I=com.vizengine.gesture.SweepGestureDetector,q=com.vizengine.animation.DecelerateInterpolator;com.vizengine.view.Layout={VERTICAL:0,HORIZONTAL:1,FRAME:2,FLOW:3,parse:function(a){return"horizontal"==
a?p.HORIZONTAL:"vertical"==a?p.VERTICAL:"flow"==a?p.FLOW:p.FRAME},toString:function(a){return a==p.VERTICAL?"vertical":a==p.HORIZONTAL?"horizontal":a==p.FLOW?"flow":"frame"}};var p=com.vizengine.view.Layout;com.vizengine.view.LayoutConstrain={FILL:-1,MATCH:-2,WRAP:-3,MATCH_HEIGHT:-4,MATCH_WIDTH:-5,NUMBER:-6,parse:function(a){return"fill"==a?m.FILL:"match"==a?m.MATCH:"wrap"==a?m.WRAP:"matchWidth"==a?m.MATCH_WIDTH:"matchHeight"==a?m.MATCH_HEIGHT:m.NUMBER},toString:function(a){return a==m.FILL?"fill":
a==m.MATCH?"match":a==m.WRAP?"wrap":a==m.MATCH_WIDTH?"matchWidth":a==m.MATCH_HEIGHT?"matchHeight":a+""}};var m=com.vizengine.view.LayoutConstrain;com.vizengine.view.Gravity={NONE:0,LEFT:1,TOP:2,RIGHT:4,BOTTOM:8,CENTER_HORIZONTAL:16,CENTER_VERTICAL:32,CENTER:64,isAlignLeft:function(a){return 0!=(a&h.LEFT)?!0:0!=(a&h.RIGHT)||0!=(a&h.CENTER_HORIZONTAL)||0!=(a&h.CENTER)?!1:!0},isAlignRight:function(a){return 0!=(a&h.RIGHT)?!0:!1},isAlignCenterHorizontal:function(a){return h.isAlignLeft(a)||h.isAlignRight(a)?
!1:!0},isAlignTop:function(a){return 0!=(a&h.TOP)?!0:0!=(a&h.BOTTOM)||0!=(a&h.CENTER_VERTICAL)||0!=(a&h.CENTER)?!1:!0},isAlignBottom:function(a){return 0!=(a&h.BOTTOM)?!0:!1},isAlignCenterVertical:function(a){return h.isAlignTop(a)||h.isAlignBottom(a)?!1:!0},parseElement:function(a){return"top"==a?com.vizengine.view.Gravity.TOP:"right"==a?com.vizengine.view.Gravity.RIGHT:"bottom"==a?h.BOTTOM:"left"==a?h.LEFT:"centerHorizontal"==a?h.CENTER_HORIZONTAL:"centerVertical"==a?h.CENTER_VERTICAL:"center"==
a?h.CENTER:h.NONE},toString:function(a){var b=[];0!=(h.TOP&a)&&b.push("top");0!=(h.RIGHT&a)&&b.push("right");0!=(h.BOTTOM&a)&&b.push("bottom");0!=(h.LEFT&a)&&b.push("left");0!=(h.CENTER_HORIZONTAL&a)&&b.push("centerHorizontal");0!=(h.CENTER_VERTICAL&a)&&b.push("centerVertical");0!=(h.CENTER&a)&&b.push("center");a="";for(var d=0;d<b.length;d++)0<d&&(a+="|"),a+=b[d];return a},parse:function(a){if(null==a)return h.NONE;a=a.split(/\|/);var b=h.NONE,d;for(d in a)b|=h.parseElement(a[d]);return b}};var h=
com.vizengine.view.Gravity;u.extend("com.vizengine.view.Rect",{init:function(){var a,b,d,f;4==arguments.length?(a=arguments[0],b=arguments[1],d=arguments[2],f=arguments[3]):1==arguments.length?(a=arguments[0].x,b=arguments[0].y,d=arguments[0].width,f=arguments[0].height):a=b=d=f=0;this.x=a;this.y=b;this.width=d;this.height=f},getLeft:function(){return this.x},getTop:function(){return this.y},getRight:function(){return this.x+this.width},getBottom:function(){return this.y+this.height},hitTest:function(a,
b){return a>=this.x&&a<=this.x+this.width&&b>=this.y&&b<=this.y+this.height}});var A=com.vizengine.view.Rect;u.extend("com.vizengine.view.Space",{init:function(){this.bottom=this.right=this.top=this.left=0},setTRBL:function(a){null!=a&&(a=a.split(/\s+/),null!=a&&0!=a.length&&(this.top=0<a.length?c.parseSize(a[0]):0,this.right=1<a.length?c.parseSize(a[1]):this.top,this.bottom=2<a.length?c.parseSize(a[2]):this.right,this.left=3<a.length?c.parseSize(a[3]):this.bottom))},hspace:function(){return this.left+
this.right},vspace:function(){return this.top+this.bottom}});u.extend("com.vizengine.view.LayoutParam",{init:function(){this.layout=com.vizengine.view.Layout.FRAME;this.layoutInParent=null;this.width=com.vizengine.view.LayoutConstrain.FILL;this.widthWeight=1;this.height=com.vizengine.view.LayoutConstrain.FILL;this.heightWeight=1;this.margin=new com.vizengine.view.Space;this.padding=new com.vizengine.view.Space;this.contentGravity=this.gravity=com.vizengine.view.Gravity.NONE}});var J=com.vizengine.view.LayoutParam;
u.extend("com.vizengine.view.VelocityTracker",{init:function(){u.prototype.init.apply(this,arguments);this.tracks=[]},track:function(a){var b=(new Date).getTime();for(this.tracks.push({time:b,value:a});;)if(1E3<b-this.tracks[0].time)this.tracks.shift();else break},getVelocity:function(){if(0==this.tracks.length)return 0;for(var a=this.tracks[this.tracks.length-1],b=a,d=1;d<this.tracks.length&&!(b=this.tracks[this.tracks.length-1-d],50<a.time-b.time);d++);return 0<a.time-b.time?(a.value-b.value)/(a.time-
b.time):0}});var B=com.vizengine.view.VelocityTracker;u.extend("com.vizengine.view.Color",{init:function(){this.a=this.b=this.g=this.r=0},setByHex:function(a){7==a.length?(this.r=parseInt(a.substring(1,3),16),this.g=parseInt(a.substring(3,5),16),this.b=parseInt(a.substring(5,7),16),this.a=255):9==a.length&&(this.a=parseInt(a.substring(1,3),16),this.r=parseInt(a.substring(3,5),16),this.g=parseInt(a.substring(5,7),16),this.b=parseInt(a.substring(7,9),16))},toString:function(){var a=function(a){return 10>
a?"0"+a:a.toString(16)};return"#"+a(this.a)+a(this.r)+a(this.g)+a(this.b)}});var C=com.vizengine.view.Color;C.parse=function(a){var b=new C;b.setByHex(a);return b};u.extend("com.vizengine.view.View",{init:function(a){null==a&&(a=this._createNativeView());a.setVirtualView(this);this._nativeView=a;this.parentView=this.id=null;this.subViews=[];this.frame=new A;this.layoutParam=new J;this.gone=!1;this.visible=this.touchable=!0;this.opaque=!1;this.gestureDetectors=[];this.onSizeChangeCallback=this.onScrollCallback=
this.onClickCallback=this.onTapGestureDetector=null;this.anchorY=this.anchorX=this.translateY=this.translateX=0;this.alpha=1;this.blur=0;this.contextPath=this.animation=null;this.velocityTrackerX=new B;this.velocityTrackerY=new B;this.measuredHeight=this.measuredWidth=null;this.isLayoutDirty=!0;this.isLayouting=!1;this.zorder=0;this.zorderUpdateRequested=!1;this.scaleY=this.scaleX=1;this.focusable=this.focus=!1;this.setHover(!1)},_createNativeView:function(){return createNativeObject("NativeView")},
snapshot:function(a){this._nativeView.snapshot(a)},getContextPath:function(){return null!=this.contextPath?this.contextPath:null!=this.parentView?this.parentView.getContextPath():null},resolvePath:function(a){return a=c.resolvePath(this.getContextPath(),a)},setHover:function(a){(this.hover=c.parseBoolean(a))&&this.setVisible(!1)},getHover:function(){return this.hover},setFocus:function(a){this.focus=c.parseBoolean(a);this._requestFocus(this,this.focus)},onFocusChanged:function(){this.setVisible(this.focus)},
_requestFocus:function(a,b){b?window.rootView.focusedView!=a&&(null!=window.rootView.focusedView&&(window.rootView.focusedView.focus=!1,window.rootView.focusedView.onFocusChanged()),window.rootView.focusedView=a,a.onFocusChanged()):window.rootView.focusedView==a&&(window.rootView.focusedView=null,a.onFocusChanged())},setFocusable:function(a){(this.focusable=c.parseBoolean(a))&&this.setVisible(!1)},setId:function(a){this.id=a;this._nativeView.setId(a)},setTouchable:function(a){this.touchable=c.parseBoolean(a)},
setOpaque:function(a){this.opaque=c.parseBoolean(a);this._nativeView.setOpaque(this.opaque?1:0)},getId:function(){return this.id},setLatitude:function(a){this.latitude=a},setLongitude:function(a){this.longitude=a},setBlur:function(a){this.blur=a=c.parseFloat(a);this._nativeView.setBlur(a)},setCameraDistance:function(a){a=c.parseSize(a);this._nativeView.setCameraDistance(a)},setAnchorX:function(a){this.anchorX=a=c.parseFloat(a);this._nativeView.setAnchorX(a)},setAnchorY:function(a){this.anchorY=a=
c.parseFloat(a);this._nativeView.setAnchorY(a)},setRotateX:function(a){a=c.parseFloat(a);this._nativeView.setRotateX(a)},setRotateY:function(a){a=c.parseFloat(a);this._nativeView.setRotateY(a)},setRotateZ:function(a){a=c.parseFloat(a);this._nativeView.setRotateZ(a)},setScaleX:function(a){this.scaleX=a=c.parseFloat(a);this._nativeView.setScaleX(a)},setScaleY:function(a){this.scaleY=a=c.parseFloat(a);this._nativeView.setScaleY(a)},setAlpha:function(a){this.alpha=a=c.parseFloat(a);this._nativeView.setAlpha(a)},
setBorderCorner:function(a){a=c.parseSize(a);this._nativeView.setBorderCorner(a)},setBorderWidth:function(a){a=c.parseSize(a);this._nativeView.setBorderWidth(a)},setBorderColor:function(a){this._nativeView.setBorderColor(a)},setClipToBounds:function(a){a=c.parseBoolean(a);this._nativeView.setClipToBounds(a?1:0)},onScroll:function(a,b){if(null!=this.onScrollCallback)this.onScrollCallback(a,b)},setTranslateX:function(a){a=c.parseSize(a);this.velocityTrackerX.track(a);var b=this.translateX;this.translateX=
a;this._nativeView.setTranslateX(a);this.onScroll(this.translateX-b,0)},setTranslateY:function(a){a=c.parseSize(a);this.velocityTrackerY.track(a);var b=this.translateY;this.translateY=a;this._nativeView.setTranslateY(a);this.onScroll(0,this.translateY-b)},setVisible:function(a){this.visible=c.parseBoolean(a);this._nativeView.setVisible(this.visible?1:0);this.requestDraw()},setGone:function(a){this.gone=c.parseBoolean(a);this.setVisible(this.gone?!1:!0);this.requestLayout()},setLayout:function(a){this.layoutParam.layout=
p.parse(a);this.requestLayout()},getLayout:function(){return p.toString(this.layoutParam.layout)},setWidth:function(a){a=a.split(/\s+/);null==a||1>a.length||(this.layoutParam.widthWeight=1<a.length?c.parseFloat(a[1],1):1,this.layoutParam.width=c.parseSize(a[0]),this.requestLayout())},getWidth:function(){return c.sizeToString(this.layoutParam.width)+(1!=this.layoutParam.widthWeight?" "+this.layoutParam.widthWeight:"")},setHeight:function(a){a=a.split(/\s+/);null==a||1>a.length||(this.layoutParam.heightWeight=
1<a.length?c.parseFloat(a[1],1):1,this.layoutParam.height=c.parseSize(a[0]),this.requestLayout())},getHeight:function(){return c.sizeToString(this.layoutParam.height)+(1!=this.layoutParam.heightWeight?" "+this.layoutParam.heightWeight:"")},setMargin:function(a){this.layoutParam.margin.setTRBL(a);this.requestLayout()},setMarginTop:function(a){this.layoutParam.margin.top=c.parseSize(a);this.requestLayout()},getMarginTop:function(){return this.layoutParam.margin.top+""},setMarginRight:function(a){this.layoutParam.margin.right=
c.parseSize(a);this.requestLayout()},getMarginRight:function(){return this.layoutParam.margin.right+""},setMarginBottom:function(a){this.layoutParam.margin.bottom=c.parseSize(a);this.requestLayout()},getMarginBottom:function(){return this.layoutParam.margin.bottom+""},setMarginLeft:function(a){this.layoutParam.margin.left=c.parseSize(a);this.requestLayout()},getMarginLeft:function(){return this.layoutParam.margin.left+""},setPadding:function(a){this.layoutParam.padding.setTRBL(a);this.requestLayout()},
setPaddingTop:function(a){this.layoutParam.padding.top=c.parseSize(a);this.requestLayout()},getPaddingTop:function(){return this.layoutParam.padding.top+""},setPaddingRight:function(a){this.layoutParam.padding.right=c.parseSize(a);this.requestLayout()},getPaddingRight:function(){return this.layoutParam.padding.right+""},setPaddingBottom:function(a){this.layoutParam.padding.bottom=c.parseSize(a);this.requestLayout()},getPaddingBottom:function(){return this.layoutParam.padding.bottom+""},setPaddingLeft:function(a){this.layoutParam.padding.left=
c.parseSize(a);this.requestLayout()},getPaddingLeft:function(){return this.layoutParam.padding.left+""},setGravity:function(a){this.layoutParam.gravity=h.parse(a);this.requestLayout()},getGravity:function(){return h.toString(this.layoutParam.gravity)},setContentGravity:function(a){this.layoutParam.contentGravity=h.parse(a);this.requestLayout()},getContentGravity:function(){return h.toString(this.layoutParam.contentGravity)},$:function(a){null==this._index_cache&&(this._index_cache={});return null!=
this._index_cache[a]?this._index_cache[a]:this._index_cache[a]=this.findViewById(a)},findViewByXY:function(a,b){for(var d=this.subViews.length-1;0<=d;d--){var f=this.subViews[d];if(f.hitTest(a,b)&&f.visible)return f.findViewByXY(a-f.frame.x-f.translateX,b-f.frame.y-f.translateY)}return this},findViewsByXY:function(a,b,d){for(var f=this.subViews.length-1;0<=f;f--){var e=this.subViews[f];e.hitTest(a,b)&&(d.push(e),e.findViewsByXY(a-e.frame.x-e.translateX,b-e.frame.y-e.translateY,d))}},_findViewByIdInParentExceptMe:function(a){if(null==
this.parentView)return null;for(var b=0;b<this.parentView.subViews.length;b++){var d=this.parentView.subViews[b];if(d.id==a||d!=this&&(d=d.findViewByIdInMyScope(a),null!=d))return d}return this.parentView._findViewByIdInParentExceptMe(a)},findViewByIdInMyScope:function(a){if(this.id==a)return this;for(var b=0;b<this.subViews.length;b++){var d=this.subViews[b];if(d.id==a)return d;d=this.subViews[b].findViewByIdInMyScope(a);if(null!=d)return d}return null},findViewById:function(a){return this.findViewByIdInMyScope(a)},
findViewByIdInTree:function(a){var b=this.findViewByIdInMyScope(a);null==b&&(b=this._findViewByIdInParentExceptMe(a));return b},addView:function(a,b,d){if(null!=a){null==b&&(b=this.subViews.length);null==d&&(d=!0);a.parentView=this;if(b<this.subViews.length){var f=this.subViews.slice(0,b),e=this.subViews.slice(b);f.push(a);this.subViews=f.concat(e)}else this.subViews.push(a);this._nativeView.addNativeView(a._nativeView,b);d&&this.requestLayout();return this}},removeViewAt:function(a,b){if(0>a||a>=
this.subViews.length)return null;null==b&&(b=!0);var d=this.subViews[a];this._nativeView.removeNativeViewAt(a);this.subViews.splice(a,1);b&&this.requestLayout();this._index_cache={};return d},removeView:function(a,b){var d=-1,f;for(f in this.subViews)if(this.subViews[f]==a){d=f;break}return this.removeViewAt(d,b)},clearViews:function(a){for(;0<this.subViews.length;)this.removeViewAt(0,a)},setBackground:function(a){this.background=a;this._nativeView.setBackground(a)},getBackground:function(){return this.background},
setZorder:function(a){this.zorder=a;this.parentView&&this.parentView._requestUpdateChildrenByZorder()},_requestUpdateChildrenByZorder:function(){if(!this.zorderUpdateRequested){this.zorderUpdateRequested=!0;var a=this;setTimeout(function(){a._updateChildrenByZorder()},0)}},_bubbleSort:function(a,b){for(var d=a.length,f,e;0<d;){for(f=0;f<d-1;f++)0<b(a[f],a[f+1])&&(e=a[f],a[f]=a[f+1],a[f+1]=e);d--}return a},_updateChildrenByZorder:function(){this.zorderUpdateRequested=!1;var a=this.subViews.concat([]);
this._bubbleSort(a,function(a,b){return a.zorder-b.zorder});this.clearViews(!1);for(var b=0;b<a.length;b++)this.addView(a[b],b,!1)},startAnimation:function(a,b){null==b&&(b=!0);b&&null!=this.animation&&com.vizengine.animation.Animation.terminateAnimation(this);this.animation=a;null!=this.animation&&com.vizengine.animation.Animation.requestAnimation(this)},dispatchDraw:function(){},trigerClick:function(a){return this.triggerClick(a)},triggerClick:function(a){var b=!1;null!=this.onClickCallback&&(b=
!0,this.onClickCallback.call(this,a));return b},setOnClick:function(a){if(null==a)null!=this.onTapGestureDetector&&(this.removeGestureDetector(this.onTapGestureDetector),this.onTapGestureDetector=null),this.onClickCallback=null;else{a instanceof Function&&(this.onClickCallback=a,null!=this._nativeView.div&&(this._nativeView.div.style.cursor="pointer"));var b=this;null==this.onTapGestureDetector&&(this.onTapGestureDetector=new G,this.onTapGestureDetector.callback=function(a){return b.triggerClick(a)},
this.gestureDetectors.push(this.onTapGestureDetector))}},addGestureDetector:function(a){this.gestureDetectors.push(a)},removeGestureDetector:function(a){for(var b=0;b<this.gestureDetectors;b++)if(this.gestureDetectors[b]==a){this.gestureDetectors.splice(b,1);break}},onTouch:function(a){var b=!1,d;for(d in this.gestureDetectors)this.gestureDetectors[d].detect(a)&&(b=!0);return b},getFrameInView:function(a){var b=this.getFrameInRootView();a=a.getFrameInRootView();b.x-=a.x;b.y-=a.y;return b},getRootView:function(){for(var a=
this;null!=a.parentView;)a=a.parentView;return a},getFrameInRootView:function(){for(var a=new A(this.frame),b=this;null!=b.parentView;)a.x+=b.translateX+b.parentView.frame.x,a.y+=b.translateY+b.parentView.frame.y,b=b.parentView;return a},_transformEventToChild:function(a,b){var d=new com.vizengine.math.Matrix4;d.identity();var f=new com.vizengine.math.Matrix4;f.setTranslation(a.frame.width*a.anchorX,a.frame.height*a.anchorY,0);d.multiply(f);f=new com.vizengine.math.Matrix4;f.setScale(1/a.scaleX,1/
a.scaleY,1);d.multiply(f);f=new com.vizengine.math.Matrix4;f.setTranslation(-a.frame.x-a.translateX-a.frame.width*a.anchorX,-a.frame.y-a.translateY-a.frame.height*a.anchorY,0);d.multiply(f);return b.applyMartix4(d)},dispatchKey:function(a){if(!this.visible)return!1;for(var b=0;b<this.subViews.length;b++){var d=this.subViews[b];d.visible&&d.dispatchKey(a)}},dispatchTouch:function(a){if(!this.touchable||!this.visible)return!1;if(this.isTouchInside(a)){this.touching||1!=a.state||(a=a.offsetCopy(0,0));
this.touching=2>a.state;for(var b=!1,d=!1,f=this.subViews.length,e=0;e<f;e++){var g=this.subViews[f-1-e];if(g.visible){var c=this._transformEventToChild(g,a);if(g.dispatchTouch(c)){d=!0;break}}}d||(b=this.onTouch(a));return b||d}if(this.touching){this.touching=!1;a=a.offsetCopy(0,0);a.state=3;d=b=!1;f=this.subViews.length;for(e=0;e<f;e++)if(g=this.subViews[f-1-e],g.visible&&(c=a.offsetCopy(-g.frame.x-g.translateX,-g.frame.y-g.translateY),g.dispatchTouch(c))){d=!0;break}d||(b=this.onTouch(a));return b||
d}},isTouchInside:function(a){var b=0+this.frame.width,d=0+this.frame.height,f;for(f in a.touchPoints){var e=a.touchPoints[f];if(0<e.x&&0<e.y&&e.x<b&&e.y<d)return!0}return!1},hitTest:function(a,b){return this.frame.hitTest(a-this.translateX,b-this.translateY)},dispatchLayout:function(){this.gone||(this._nativeView.setFrame(this.frame.x,this.frame.y,this.frame.width,this.frame.height),0<this.subViews.length&&(this.layoutParam.layout==p.FRAME?this.layoutChildrenByFrame():this.layoutParam.layout==p.VERTICAL?
this.layoutChildrenByVertical():this.layoutParam.layout==p.FLOW?this.layoutChildrenByFlow():this.layoutChildrenByHorizontal()),null!=this.onSizeChangeCallback&&this.onSizeChangeCallback.call(this,this.frame.width,this.frame.height))},layoutChildrenByFlow:function(){var a=this.frame.width-this.layoutParam.padding.hspace();this.layoutParam.padding.vspace();var b=this.subViews,d=this.layoutParam.padding.left,f=this.layoutParam.padding.top,e=0,g=[[]],c;for(c in b){var k=b[c],m=k.measureWidth(),n=k.measureHeight(),
p=m+k.layoutParam.margin.hspace(),q=n+k.layoutParam.margin.vspace();if(d+p>a||p>a&&d==this.layoutParam.padding.left)g[g.length-1].maxLineHeight=e,g[g.length-1].offsetY=f,g[g.length-1].offsetX=d,d=this.layoutParam.padding.left,f+=e,e=0,g.push([]);q>e&&(e=q);k.frame.x=d+k.layoutParam.margin.left;k.frame.y=f+k.layoutParam.margin.top;k.frame.width=m;k.frame.height=n;g[g.length-1].push(k);d+=p}null==g[g.length-1].maxLineHeight&&(g[g.length-1].maxLineHeight=e,g[g.length-1].offsetY=f,g[g.length-1].offsetX=
d);if(0!=(this.layoutParam.contentGravity&h.BOTTOM))for(b=this.frame.height-this.layoutParam.padding.bottom-(g[g.length-1].maxLineHeight+g[g.length-1].offsetY),c=0;c<g.length;c++)for(a=0;a<g[c].length;a++)d=g[c][a],d.frame.y+=b;else if(0!=(this.layoutParam.contentGravity&h.CENTER)||0!=(this.layoutParam.contentGravity&h.CENTER_VERTICAL))for(b=this.frame.height-this.layoutParam.padding.bottom-(g[g.length-1].maxLineHeight+g[g.length-1].offsetY),b/=2,c=0;c<g.length;c++)for(a=0;a<g[c].length;a++)d=g[c][a],
d.frame.y+=b;if(0!=(this.layoutParam.contentGravity&h.RIGHT))for(c=0;c<g.length;c++)for(b=g[c],d=this.frame.width-this.layoutParam.padding.right-b.offsetX,a=0;a<b.length;a++)b[a].frame.x+=d;else if(0!=(this.layoutParam.contentGravity&h.CENTER)||0!=(this.layoutParam.contentGravity&h.CENTER_HORIZONTAL))for(c=0;c<g.length;c++)for(b=g[c],d=this.frame.width-this.layoutParam.padding.right-b.offsetX,d/=2,a=0;a<b.length;a++)b[a].frame.x+=d;for(c=0;c<this.subViews.length;c++)k=this.subViews[c],k.dispatchLayout()},
layoutChildrenByFrame:function(){var a=this.frame.width,b=this.frame.height,d=a-this.layoutParam.padding.hspace(),f=b-this.layoutParam.padding.vspace(),e=this.subViews,g;for(g in e){var c=e[g];if(!c.gone){var k=c.measureWidth(),h=c.measureHeight(),m=0,n=0,m=c.isAlignLeft()?this.layoutParam.padding.left+c.layoutParam.margin.left:c.isAlignRight()?a-this.layoutParam.padding.right-c.layoutParam.margin.right-k:this.layoutParam.padding.left+(d-k-c.layoutParam.margin.hspace())/2+c.layoutParam.margin.left,
n=c.isAlignTop()?c.layoutParam.margin.top+this.layoutParam.padding.top:c.isAlignBottom()?b-this.layoutParam.padding.bottom-c.layoutParam.margin.bottom-h:this.layoutParam.padding.top+(f-h-c.layoutParam.margin.vspace())/2+c.layoutParam.margin.top;c.frame.x=m;c.frame.y=n;c.frame.width=k;c.frame.height=h;c.dispatchLayout()}}},layoutChildrenByVertical:function(){var a=this.frame.width,b=this.frame.height,d=a-this.layoutParam.padding.hspace(),f=b-this.layoutParam.padding.vspace(),e=this.layoutParam.padding.top,
c=this.subViews,l;for(l in c){var k=c[l];if(!k.gone){var m=k.measureWidth(),n=k.measureHeight();k.frame.width=m;k.frame.height=n;k.frame.y=e+k.layoutParam.margin.top;e+=n+k.layoutParam.margin.vspace();k.isAlignLeft()?k.frame.x=this.layoutParam.padding.left+k.layoutParam.margin.left:k.isAlignRight()?k.frame.x=a-this.layoutParam.padding.right-k.layoutParam.margin.right-m:k.frame.x=this.layoutParam.padding.left+(d-m-k.layoutParam.margin.hspace())/2+k.layoutParam.margin.left}}if(0==(this.layoutParam.contentGravity&
h.TOP))if(0!=(this.layoutParam.contentGravity&h.BOTTOM))for(l in b=b-this.layoutParam.padding.bottom-e,c)a=c[l],a.frame.y+=b;else if(0!=(this.layoutParam.contentGravity&h.CENTER)||0!=(this.layoutParam.contentGravity&h.CENTER_VERTICAL))for(l in b=(f-e+this.layoutParam.padding.top)/2,c)a=c[l],a.frame.y+=b;for(l in c)a=c[l],a.gone||a.dispatchLayout()},layoutChildrenByHorizontal:function(){var a=this.frame.width,b=this.frame.height,d=a-this.layoutParam.padding.hspace(),f=b-this.layoutParam.padding.vspace(),
e=this.layoutParam.padding.left,c=this.subViews,l;for(l in c){var k=c[l];if(!k.gone){var m=k.measureWidth(),n=k.measureHeight();k.frame.width=m;k.frame.height=n;k.frame.x=e+k.layoutParam.margin.left;e+=m+k.layoutParam.margin.hspace();k.isAlignTop()?k.frame.y=this.layoutParam.padding.top+k.layoutParam.margin.top:k.isAlignBottom()?k.frame.y=b-this.layoutParam.padding.bottom-k.layoutParam.margin.bottom-n:k.frame.y=this.layoutParam.padding.top+(f-n-k.layoutParam.margin.vspace())/2+k.layoutParam.margin.top}}if(0==
(this.layoutParam.contentGravity&h.LEFT))if(0!=(this.layoutParam.contentGravity&h.RIGHT))for(l in b=a-this.layoutParam.padding.right-e,c)a=c[l],a.frame.x+=b;else if(0!=(this.layoutParam.contentGravity&h.CENTER)||0!=(this.layoutParam.contentGravity&h.CENTER_HORIZONTAL))for(l in b=(d-e+this.layoutParam.padding.left)/2,c)a=c[l],a.frame.x+=b;for(l in c)a=c[l],a.gone||a.dispatchLayout()},isAlignLeft:function(){if(0!=(this.layoutParam.gravity&h.LEFT))return!0;if(0!=(this.layoutParam.gravity&h.RIGHT)||0!=
(this.layoutParam.gravity&h.CENTER_HORIZONTAL)||0!=(this.layoutParam.gravity&h.CENTER))return!1;var a=this.parentView;return null==a||0!=(a.layoutParam.contentGravity&h.LEFT)?!0:0!=(a.layoutParam.contentGravity&h.RIGHT)||0!=(a.layoutParam.contentGravity&h.CENTER_HORIZONTAL)||0!=(a.layoutParam.contentGravity&h.CENTER)?!1:!0},isAlignTop:function(){if(0!=(this.layoutParam.gravity&h.TOP))return!0;if(0!=(this.layoutParam.gravity&h.BOTTOM)||0!=(this.layoutParam.gravity&h.CENTER_VERTICAL)||0!=(this.layoutParam.gravity&
h.CENTER))return!1;var a=this.parentView;return null==a||0!=(a.layoutParam.contentGravity&h.TOP)?!0:0!=(a.layoutParam.contentGravity&h.BOTTOM)||0!=(a.layoutParam.contentGravity&h.CENTER_VERTICAL)||0!=(a.layoutParam.contentGravity&h.CENTER)?!1:!0},isAlignRight:function(){if(0!=(this.layoutParam.gravity&h.RIGHT))return!0;if(0!=(this.layoutParam.gravity&h.LEFT)||0!=(this.layoutParam.gravity&h.CENTER_HORIZONTAL)||0!=(this.layoutParam.gravity&h.CENTER))return!1;var a=this.parentView;return null==a?!1:
0!=(a.layoutParam.contentGravity&h.RIGHT)?!0:!1},isAlignBottom:function(){if(0!=(this.layoutParam.gravity&h.BOTTOM))return!0;if(0!=(this.layoutParam.gravity&h.TOP)||0!=(this.layoutParam.gravity&h.CENTER_VERTICAL)||0!=(this.layoutParam.gravity&h.CENTER))return!1;var a=this.parentView;return null==a?!1:0!=(a.layoutParam.contentGravity&h.BOTTOM)?!0:!1},setMinWidth:function(a){this.minWidth=null!=a?c.parseSize(a):null;this.requestLayout()},setMaxWidth:function(a){this.maxWidth=null!=a?c.parseSize(a):
null;this.requestLayout()},setMaxHeight:function(a){this.maxHeight=null!=a?c.parseSize(a):null;this.requestLayout()},measureWidth:function(){if(null!=this.measuredWidth)return this.measuredWidth;var a=this._measureWidth();null!=this.minWidth&&a<this.minWidth&&(a=this.minWidth);null!=this.maxWidth&&a>this.maxWidth&&(a=this.maxWidth);return this.measuredWidth=a},_measureWidth:function(){var a=this.parentView,b=this.subViews,d=null==a?null:a.subViews;if(this.gone)return 0;if(this.layoutParam.width==
m.MATCH)return null==a?this.measuredWidth=this.frame.width:a.measureWidth()*this.layoutParam.widthWeight;if(this.layoutParam.width==m.FILL){if(null==a)return this.frame.width;if(a.layoutParam.layout==p.FRAME||a.layoutParam.layout==p.VERTICAL)return a.measureContentWidth()-this.layoutParam.margin.hspace();var b=a.measureContentWidth(),f=0,e=0,c;for(c in d)a=d[c],a.gone||(a.layoutParam.width==m.FILL?(e+=a.layoutParam.widthWeight,f+=a.layoutParam.margin.hspace()):f+=a.measureBoxWidth());return(b-f)*
this.layoutParam.widthWeight/e}if(this.layoutParam.width==m.WRAP){d=0;if(this.layoutParam.layout==p.FRAME||this.layoutParam.layout==p.VERTICAL){for(c in b)a=b[c],a.gone||a.layoutParam.width==m.FILL||a.layoutParam.width==m.MATCH||(a=a.measureBoxWidth(),a>d&&(d=a));return d+this.layoutParam.padding.hspace()}for(c in b)a=b[c],a.gone||a.layoutParam.width==m.FILL||a.layoutParam.width==m.MATCH||(a=a.measureBoxWidth(),d+=a);return d+this.layoutParam.padding.hspace()}return this.layoutParam.width==m.MATCH_HEIGHT?
this.measureHeight()*this.layoutParam.widthWeight:this.layoutParam.width},measureHeight:function(){if(null!=this.measuredHeight)return this.measuredHeight;var a=this._measureHeight();null!=this.minHeight&&a<this.minHeight&&(a=this.minHeight);null!=this.maxHeight&&a>this.maxHeight&&(a=this.maxHeight);return this.measuredHeight=a},_measureHeight:function(){if(null!=this.measuredHeight)return this.measuredHeight;var a=this.parentView,b=this.subViews,d=null==a?null:a.subViews;if(this.gone)return 0;if(this.layoutParam.height==
m.MATCH)return null==a?this.measuredHeight=this.frame.height:this.measuredHeight=a.measureHeight()*this.layoutParam.heightWeight;if(this.layoutParam.height==m.FILL){if(null==a)return this.frame.height;if(a.layoutParam.layout==p.FRAME||a.layoutParam.layout==p.HORIZONTAL)return this.measuredHeight=a.measureContentHeight()-this.layoutParam.margin.vspace();var b=a.measureContentHeight(),f=0,e=0,c;for(c in d)a=d[c],a.gone||(a.layoutParam.height==m.FILL?(e+=a.layoutParam.heightWeight,f+=a.layoutParam.margin.vspace()):
f+=a.measureBoxHeight());return this.measuredHeight=(b-f)*this.layoutParam.heightWeight/e}if(this.layoutParam.height==m.WRAP){d=0;if(this.layoutParam.layout==p.FRAME||this.layoutParam.layout==p.HORIZONTAL){for(c in b)a=b[c],a.layoutParam.height!=m.FILL&&a.layoutParam.height!=m.MATCH&&(a=a.measureBoxHeight(),a>d&&(d=a));return this.measuredHeight=d+this.layoutParam.padding.vspace()}if(this.layoutParam.layout==p.FLOW){var d=this.measureContentWidth(),f=this.layoutParam.padding.vspace(),l=e=0;for(c in b){var a=
b[c],k=a.measureBoxWidth(),a=a.measureBoxHeight(),e=e+k;if(e>d||k>d&&0==e)f+=l,l=a,e=k;a>l&&(l=a)}return this.measuredHeight=f+l}for(c in b)a=b[c],a.layoutParam.height!=m.FILL&&a.layoutParam.height!=m.MATCH&&(a=a.measureBoxHeight(),d+=a);return this.measuredHeight=d+this.layoutParam.padding.vspace()}return this.layoutParam.height==m.MATCH_WIDTH?(d=this.measureWidth(),this.measuredHeight=d*this.layoutParam.heightWeight):this.measuredHeight=this.layoutParam.height},measureContentWidth:function(){return this.gone?
0:this.measureWidth()-this.layoutParam.padding.hspace()},measureContentHeight:function(){return this.gone?0:this.measureHeight()-this.layoutParam.padding.vspace()},measureBoxWidth:function(){return this.gone?0:this.measureWidth()+this.layoutParam.margin.hspace()},measureBoxHeight:function(){return this.gone?0:this.measureHeight()+this.layoutParam.margin.vspace()},requestLayout:function(){this.resetMeasureCache();null!=this.parentView&&this.parentView.requestLayout()},resetMeasureCache:function(){if(null!=
this.measuredWidth||null!=this.measuredHeight){this.measuredHeight=this.measuredWidth=null;for(var a=0;a<this.subViews.length;a++){var b=this.subViews[a];b.layoutParam.height!=m.FILL&&b.layoutParam.height!=m.MATCH&&b.layoutParam.width!=m.FILL&&b.layoutParam.width!=m.MATCH||b.resetMeasureCache()}}},requestDraw:function(){},getPage:function(){return this instanceof n?this:null!=this.parentView?this.parentView.getPage():null},set__template__path__:function(a){a=com.vizengine.moduleManager[a];null!=a&&
a.applyTemplateScripts(this)}});var c=com.vizengine.view.View;c.dip2px=function(a){return Math.round(a*window.devicePixelRatio)};c.px2dip=function(a){return Math.round(a/window.devicePixelRatio)};c.parseFloat=function(a,b){null==b&&(b=0);var d=parseFloat(a);return isNaN(d)?b:d};c.parseInt=function(a,b){null==b&&(b=0);var d=parseInt(a);return isNaN(d)?b:d};c.parseSize=function(a){if(null==a||""==a)return 0;if("number"==typeof a)return a;var b=m.parse(a);return b!=m.NUMBER?b:r.endsWith(a,"px")||r.endsWith(a,
"PX")?c.px2dip(c.parseFloat(a.substring(0,a.length-2))):r.endsWith(a,"dp")||r.endsWith(a,"DP")?c.parseFloat(a.substring(0,a.length-2)):c.parseFloat(a)};c.sizeToString=function(a){return m.toString(a)};c.parseBoolean=function(a){return null==a?!1:"string"==typeof a?"true"==a:a};c.deleteComment=function(a){return null==a?a:a.replace(/("([^\\\"]*(\\.)?)*")|('([^\\\']*(\\.)?)*')|(\/{2,}.*?(\r|\n|$))|(\/\*(\n|.)*?\*\/)/g,function(a){return/^\/{2,}/.test(a)||/^\/\*/.test(a)?"":a})};c.parseJson=function(a){a=
c.deleteComment(a);return JSON.parse(a)};c.inject=function(a,b,d){if(null!=a){var f=a["set"+r.firstToUpper(b)];null!=f&&f instanceof Function?f.call(a,d):a[b]=d}};c._resolveClass=function(a){if(a instanceof Function)return a;var b=eval("try{eval('com.vizengine.view."+a+"')}catch(e){}");if(null!=b&&b instanceof Function)return b;a=eval("try{eval('"+a+"')}catch(e){}");return null!=a&&a instanceof Function?a:null};c.resolvePath=function(a,b){if(null==a||null==b||""==b||r.startsWith(b,"http")||r.startsWith(b,
"/")||r.startsWith(b,"data:"))return b;r.endsWith(a,"/")&&(a=a.substring(0,a.length-1));var d=a.lastIndexOf("/");0<=d&&(a=a.substring(0,d+1));return a+b};var D=function(a,b){var d=a.attributes;return null!=d&&null!=d[b]?d[b]:a[b]},E=function(a,b){var d=a.attributes;null!=d&&null!=d[b]&&delete d[b];delete a[b]};c._resolveInstance=function(a,b){null==a&&(a="View");if("include"==a)return null;var d=c._resolveClass(a);if(null==d)throw new TypeError("can't resolve class :"+a);if(b instanceof d)return b;
d=new d;if(null==d)throw new TypeError("can't make instance for class :"+a);if(null!=b)for(var f in b)b[f]instanceof Function||c.inject(d,f,b[f]);return d};c.parse=function(a,b,d,f){"string"==typeof a&&(a=c.parseJson(a));var e=a.type;null==e&&(e="View");if("include"==e){var e=D(a,"src"),g=D(a,"data");E(a,"src");E(a,"data");null!=g&&(g=g.replace(/\'/g,'"'),g=c.parseJson(g),d=com.vizengine.mergeObject(d,g));if(com.vizengine.Module.isViewTemplate(e)){b=com.vizengine.view.View.resolvePath(f,e);b=com.vizengine.moduleManager[b].packageObject(d);
for(var l in a.attributes)"src"!=l&&"data"!=l&&c.inject(b,l,a.attributes[l])}}else b=c._resolveInstance(e,b);for(var k in a)if("type"!=k&&"children"!=k&&"__template__path__"!=k)if("attributes"==k)for(l in e=a[k],e)g=e[l],c.inject(b,l,g);else g=a[k],c.inject(b,k,g);for(k in a)if("type"!=k&&"style"!=k&&"children"==k)if(l=a[k],l instanceof Array)for(g=0;g<l.length;g++){var h=l[g],e=h.type,e=c._resolveInstance(e);null!=e?(b.addView(e),c.parse(h,e,d,f)):(e=c.parse(h,null,d,f),b.addView(e))}else h=l,e=
h.type,e=c._resolveInstance(e),null!=e?(b.addView(e),c.parse(h,e,d,f)):(e=c.parse(h,null,d,f),b.addView(e));null!=a.__template__path__&&(g=a.__template__path__,c.inject(b,"__template__path__",g));return b};c.extend("com.vizengine.view.ImageView",{init:function(){c.prototype.init.apply(this,arguments);this.crop=0;this.src=null},_createNativeView:function(){return createNativeObject("NativeImageView")},dispatchLayout:function(){this._nativeView.setPadding(this.layoutParam.padding.left,this.layoutParam.padding.top,
this.layoutParam.padding.right,this.layoutParam.padding.bottom);c.prototype.dispatchLayout.apply(this,arguments)},setRatio:function(a){this._nativeView.setRatio(c.parseFloat(a));this.requestLayout()},_measureWidth:function(){if(this.layoutParam.width==m.WRAP){var a=this._nativeView.getImageWidth(),b=this._nativeView.getImageHeight();if(this.layoutParam.height==m.WRAP){var d=b,f=a;this.maxHeight&&d>this.maxHeight&&(d=this.maxHeight);this.maxWidth&&f>this.maxWidth&&(f=this.maxWidth);a=b/a;d/f<a&&(f=
d/a);return f+this.layoutParam.padding.hspace()}if(0==b||0==a)return 0;d=this.measureHeight();return d/(b/a)}if(this.layoutParam.width==m.FILL&&this.crop){d=this.parentView.measureContentWidth();f=this.parentView.measureContentHeight();a=this._nativeView.getImageWidth();b=this._nativeView.getImageHeight();if(0==f||0==b)return 0;a/=b;return d/f>a?1==this.crop?d:f*a:1==this.crop?f*a:d}return c.prototype._measureWidth.apply(this,arguments)},_measureHeight:function(){if(this.layoutParam.height==m.WRAP){var a=
this._nativeView.getImageWidth(),b=this._nativeView.getImageHeight();if(this.layoutParam.width==m.WRAP){var d=b,f=a;this.maxHeight&&d>this.maxHeight&&(d=this.maxHeight);this.maxWidth&&f>this.maxWidth&&(f=this.maxWidth);a=b/a;d/f>a&&(d=f*a);return d+this.layoutParam.padding.vspace()}if(0==b||0==a)return 0;d=this.measureWidth();return b/a*d}if(this.layoutParam.height==m.FILL&&this.crop){d=this.parentView.measureContentWidth();f=this.parentView.measureContentHeight();a=this._nativeView.getImageWidth();
b=this._nativeView.getImageHeight();if(0==f||0==b)return 0;a/=b;return d/f>a?1==this.crop?d/a:f:1==this.crop?f:d/a}return c.prototype._measureHeight.apply(this,arguments)},setDefaultSrc:function(a){var b=this;this._nativeView.setDefaultSrc(c.resolvePath(this.getContextPath(),a),function(){b.requestLayout()})},setSrc:function(a,b){a=c.resolvePath(this.getContextPath(),a);if(a!=this.src){this.src=a;var d=this;this._nativeView.setSrc(a,function(){d.requestLayout();b&&b()})}},getSrc:function(){return this.src},
setCrop:function(a){this.crop=c.parseInt(a)},getCrop:function(){return this.crop},setStretchX:function(a){if(!r.endsWith(a,"px"))throw new TypeError("stretch should specified by px");a=c.parseInt(a.substring(0,a.length-2));this._nativeView.setStretchX(a)},setStretchWidth:function(a){if(!r.endsWith(a,"px"))throw new TypeError("stretch should specified by px");a=c.parseInt(a.substring(0,a.length-2));this._nativeView.setStretchWidth(a)},setStretchY:function(a){if(!r.endsWith(a,"px"))throw new TypeError("stretch should specified by px");
a=c.parseInt(a.substring(0,a.length-2));this._nativeView.setStretchY(a)},setStretchHeight:function(a){if(!r.endsWith(a,"px"))throw new TypeError("stretch should specified by px");a=c.parseInt(a.substring(0,a.length-2));this._nativeView.setStretchHeight(a)}});ImageView=com.vizengine.view.ImageView;c.extend("com.vizengine.view.Button",{init:function(){c.prototype.init.apply(this,arguments);this.setLayout("frame")},setBackgroundNormal:function(a){var b=new c;b.setBackground(a);0==this.subViews.length?
this.addView(b,0):this.addView(b,1)},setBackgroundPressed:function(a){var b=new c;b.setBackground(a);this.addView(b,0)},addView:function(){var a=c.prototype.addView.apply(this,arguments);1<this.subViews.length&&(this.subViews[1].setVisible(!0),this.subViews[0].setVisible(!1));return a},dispatchTouch:function(a){var b=c.prototype.dispatchTouch.apply(this,arguments);(this.isTouchInside(a)||2<=a.state)&&1<this.subViews.length&&(0==a.state?(this.subViews[1].setVisible(!1),this.subViews[0].setVisible(!0)):
2<=a.state&&(this.subViews[1].setVisible(!0),this.subViews[0].setVisible(!1)));return b}});c.extend("com.vizengine.view.ToggleButton",{init:function(){c.prototype.init.apply(this,arguments);this.setLayout("frame");this.toggle=!1;this.onToggleChangeCallback=null},setToggleChangeCallback:function(a){this.onToggleChangeCallback=a},setToggle:function(a){this.toggle=c.parseBoolean(a);if(null!=this.onToggleChangeCallback)this.onToggleChangeCallback(this.toggle);this.updateVisible()},getToggle:function(){return this.toggle},
updateVisible:function(){1<this.subViews.length&&(this.toggle?(this.subViews[0].setVisible(!0),this.subViews[1].setVisible(!1)):(this.subViews[0].setVisible(!1),this.subViews[1].setVisible(!0)))},dispatchTouch:function(a){var b=c.prototype.dispatchTouch.apply(this,arguments);if(!this.touchable)return b;this.parentView instanceof K||this.isTouchInside(a)&&2<=a.state&&this.setToggle(!this.toggle);return b}});var F=com.vizengine.view.ToggleButton;c.extend("com.vizengine.view.ToggleButtonGroup",{init:function(){c.prototype.init.apply(this,
arguments);this.onToggleChangeCallback=null;this.toggle=-1},dispatchLayout:function(a){c.prototype.dispatchLayout.apply(this,arguments);0>this.toggle&&this.setToggle(0)},setOnToggleChangeCallback:function(a){this.onToggleChangeCallback=a},setToggle:function(a){for(var b=0,d=0;d<this.subViews.length;d++){var f=this.subViews[d];if(f instanceof F){if(b==a){if(f.setToggle(!0),this.toggle=a,null!=this.onToggleChangeCallback)this.onToggleChangeCallback(a)}else f.setToggle(!1);b++}}},getToggle:function(){return this.toggle},
dispatchTouch:function(a){for(var b=c.prototype.dispatchTouch.apply(this,arguments),d=0,f=0;1!=a.status&&f<this.subViews.length;f++){var e=this.subViews[f];if(e instanceof F){0==a.state&&(e.preTouchX=a.getAbsX(),e.preTouchY=a.getAbsY());if(2==a.state){var g=a.getX(),l=a.getY(),k=a.getAbsX(),h=a.getAbsY(),k=50<Math.abs(k-e.preTouchX)||50<Math.abs(h-e.preTouchY);e.hitTest(g,l)&&!k&&this.setToggle(d)}d++}}return b}});var K=com.vizengine.view.ToggleButtonGroup;c.extend("com.vizengine.view.SelectView",
{select:function(a){for(var b=0;b<this.subViews.length;b++){var d=this.subViews[b];if(b==a){if(d.setVisible(!0),null!=d.onSelected)d.onSelected()}else d.setVisible(!1)}}});c.extend("com.vizengine.view.TextView",{text:null,html:null,init:function(){c.prototype.init.apply(this,arguments);this.setFontColor("#000000");this.setFontSize("14dp");this.setFontBold(!1);this.setLineSpace("4dp");this.setWordSpace("0dp");this.copyEnable=!com.vizengine.core.Platform.mobile},_createNativeView:function(){return createNativeObject("NativeTextView")},
setCopyEnable:function(a){this.copyEnable=c.parseBoolean(a)},dispatchTouch:function(){return c.prototype.dispatchTouch.apply(this,arguments)},dispatchLayout:function(){this._nativeView.setPadding(this.layoutParam.padding.left,this.layoutParam.padding.top,this.layoutParam.padding.right,this.layoutParam.padding.bottom);c.prototype.dispatchLayout.apply(this,arguments)},setContentGravity:function(a){c.prototype.setContentGravity.apply(this,arguments);this._nativeView.setContentGravity(this.layoutParam.contentGravity);
this.requestLayout()},setMaxLine:function(a){this.maxLine=a;this._nativeView.setMaxLine(a);this.requestLayout()},setText:function(a){a!=this.text&&(this.text=a,this._nativeView.setText(a),this.requestLayout())},getText:function(){return this.text},setHtml:function(a){this.html!=a&&(this._nativeView.setHtml(a),this.requestLayout())},_checkColor:function(a){return null==a||7>a.length||"#"!=a[0]?!1:!0},setFontFamily:function(a){this.fontFamily=a;this._nativeView.setFontFamily(a)},setFontColor:function(a){this._checkColor(a)&&
(this.fontColor=a,this._nativeView.setFontColor(a))},getFontColor:function(){return this.fontColor},setFontSize:function(a){this.fontSize=c.parseSize(a);this._nativeView.setFontSize(this.fontSize);this.requestLayout()},getFontSize:function(){return this.fontSize},setWordSpace:function(a){this.wordSpace=c.parseSize(a);this._nativeView.setWordSpace(this.wordSpace);this.requestLayout()},getWordSpace:function(){return this.wordSpace},setLineSpace:function(a){this.lineSpace=c.parseSize(a);this._nativeView.setLineSpace(this.lineSpace)},
getLineSpace:function(){return this.lineSpace},setFontBold:function(a){this.fontBold=c.parseBoolean(a);this._nativeView.setFontBold(this.fontBold?1:0)},getFontBold:function(){return this.fontBold},measureWidth:function(){if(this.layoutParam.width==m.WRAP){var a=this._nativeView.measureTextWidth()+this.layoutParam.padding.hspace();return null!=this.maxWidth&&a>this.maxWidth?this.maxWidth:a}return c.prototype.measureWidth.apply(this,arguments)},measureHeight:function(){if(this.layoutParam.height==m.WRAP){var a=
this.measureWidth(),a=this._nativeView.measureTextHeight(a)+this.layoutParam.padding.vspace();return null!=this.maxHeight&&a>this.maxHeight?this.maxHeight:a}return c.prototype.measureHeight.apply(this,arguments)}});c.extend("com.vizengine.view.TextareaView",{init:function(){c.prototype.init.apply(this,arguments);this.setFontSize("14dp");this.setFontColor("#000000");this.setFontBold(!1)},_createNativeView:function(){return createNativeObject("NativeTextareaView")},dispatchTouch:function(a){var b=c.prototype.dispatchTouch.apply(this,
arguments);this.isTouchInside(a)&&(window.__preventDefault__=!1);return b},setOnInputCallback:function(a){this.onInputCallback=a;this._nativeView.setOnInputCallback(a)},_checkColor:function(a){return null==a||7>a.length||"#"!=a[0]?!1:!0},setText:function(a){this.text=a;this._nativeView.setText(a);this.requestLayout()},getText:function(){return this.text=this._nativeView.getText()},setFontColor:function(a){this._checkColor(a)&&(this.fontColor=a,this._nativeView.setFontColor(a))},getFontColor:function(){return this.fontColor},
setMaxLength:function(a){this.maxLength=parseInt(a);this._nativeView.setMaxLength(this.maxLength)},setFontSize:function(a){this.fontSize=c.parseSize(a);this._nativeView.setFontSize(this.fontSize)},getFontSize:function(){return this.fontSize},setWordSpace:function(a){this.wordSpace=c.parseSize(a);this._nativeView.setWordSpace(this.wordSpace)},getWordSpace:function(){return this.wordSpace},setHint:function(a){this._nativeView.setHint(a)},setHintColor:function(a){this._nativeView.setHintColor(a)},setLineSpace:function(a){this.lineSpace=
c.parseSize(a);this._nativeView.setLineSpace(this.lineSpace)},getLineSpace:function(){return this.lineSpace},setFontBold:function(a){this.fontBold=c.parseBoolean(a);this._nativeView.setFontBold(this.fontBold?1:0)},getFontBold:function(){return this.fontBold}});c.extend("com.vizengine.view.InputView",{init:function(){c.prototype.init.apply(this,arguments);this.onConfirmCallback=this.onFocusChangeCallback=this.onInputCallback=null;var a=this;this._nativeView.setOnFocusChangeCallback(function(b){b&&
(v.focusedInputView=a);if(null!=a.onFocusChangeCallback)a.onFocusChangeCallback(b)});this.setFontSize("18dp");this.setFontColor("#000000");this.setContentGravity("centerVertical");this.setFontBold(!1)},_createNativeView:function(){return createNativeObject("NativeInputView")},measureHeight:function(){return this.layoutParam.height==m.WRAP?this._nativeView.measureContentHeight():c.prototype.measureHeight.apply(this,arguments)},setContentGravity:function(a){c.prototype.setContentGravity.apply(this,
arguments);this._nativeView.setContentGravity(this.layoutParam.contentGravity);this.requestLayout()},dispatchTouch:function(a){var b=c.prototype.dispatchTouch.apply(this,arguments);this.isTouchInside(a)&&this.touchable&&(window.__preventDefault__=!1);return b},dispatchLayout:function(){this._nativeView.setPadding(this.layoutParam.padding.left,this.layoutParam.padding.top,this.layoutParam.padding.right,this.layoutParam.padding.bottom);c.prototype.dispatchLayout.apply(this,arguments)},setOnInputCallback:function(a){this.onInputCallback=
a;this._nativeView.setOnInputCallback(a)},setOnFocusChangeCallback:function(a){this.onFocusChangeCallback=a},setOnConfirmCallback:function(a){this.onConfirmCallback=a;this._nativeView.setOnConfirmCallback(a)},clearFocus:function(){this._nativeView.setFocus(0)},setFocus:function(a){a=c.parseBoolean(a);this._nativeView.setFocus(a?1:0)},setText:function(a){this.text=a;this._nativeView.setText(a)},getText:function(){return""+this._nativeView.getText()},setHint:function(a){this._nativeView.setHint(a)},
setHintColor:function(a){this._nativeView.setHintColor(a)},setFontColor:function(a){this._nativeView.setFontColor(a)},setFontSize:function(a){this._nativeView.setFontSize(c.parseSize(a))},setFontBold:function(a){this.fontBold=c.parseBoolean(a);this._nativeView.setFontBold(this.fontBold?1:0)},getFontBold:function(){return this.fontBold},setInputType:function(a){this._nativeView.setInputType(a)}});var v=com.vizengine.view.InputView;v.focusedInputView=null;v.clearFocus=function(){null!=v.focusedInputView&&
v.focusedInputView.clearFocus()};var x=t.extend({init:function(){t.prototype.init.apply(this,arguments)},animateFrame:function(a,b){t.prototype.animateFrame.apply(this,arguments);if(a.verticalScroll){var d=a.getMinTranslateY(),f=a.getMaxTranslateY();if(a.translateY>f||a.translateY<d)a.startAnimation(null),d=a.velocityTrackerY.getVelocity(),a.forceMove(0,d)}else if(d=a.getMinTranslateX(),f=a.getMaxTranslateX(),a.translateX>f||a.translateX<d)a.startAnimation(null),d=a.velocityTrackerX.getVelocity(),
a.forceMove(d,0)}});c.extend("com.vizengine.view.ScrollView",{init:function(){c.prototype.init.apply(this,arguments);this.verticalScroll=!0;this.layoutParam.layout=p.VERTICAL;this.pageScrollEnable=!1;this.myGestureDetectors=[];this.maxTranslateY=this.maxTranslateX=0;this.onScrollEndCallback=null;var a=this,b=new H;b.callback=function(b,f,e){if(a.gestureEnable){if(0==e.state)a.startAnimation(null,!1),this.initTranslateY=a.translateY,this.initTranslateX=a.translateX,a.interceptState=0;else{if(2==a.interceptState)return!1;
if(a.verticalScroll){if(0==a.interceptState){e=Math.abs(b);c=Math.abs(f);if(10>(e>c?e:c))return!0;if(Math.abs(f)>Math.abs(b))a.interceptState=1;else return a.interceptState=2,!1}b=a.getMinTranslateY();e=a.getMaxTranslateY();f=this.initTranslateY+f;f>e&&(c=f-e,c*=.3+(.2-.2*c/a.frame.height),f=e+c);f<b&&(c=b-f,c*=.3+(.2-.2*c/a.frame.height),f=b-c);a.setTranslateY(f)}else{if(0==a.interceptState){e=Math.abs(b);var c=Math.abs(f);if(10>(e>c?e:c))return!0;if(Math.abs(b)>Math.abs(f))a.interceptState=1;else return a.interceptState=
2,!1}f=a.getMinTranslateX();e=a.getMaxTranslateX();b=this.initTranslateX+b;b>e&&(c=b-e,c*=.3+(.2-.2*c/a.frame.width),b=e+c);b<f&&(c=f-b,c*=.3+(.2-.2*c/a.frame.width),b=f-c);a.setTranslateX(b)}a.requestDraw()}return!0}};this.myGestureDetectors.push(b);b=new I;b.callback=function(b,f,c){a.gestureEnable&&(1==a.interceptState?a.fly(b,f):a.fly(0,0))};this.myGestureDetectors.push(b);this.gestureEnable=!0},setLayout:function(a){c.prototype.setLayout.apply(this,arguments);this.verticalScroll="horizontal"==
a?!1:!0},setGestureEnable:function(a){this.gestureEnable=c.parseBoolean(a)},hitTest:function(a,b){return this.frame.hitTest(a,b)},dispatchTouch:function(a){var b=this.touching,d=c.prototype.dispatchTouch.apply(this,arguments);if(this.isTouchInside(a))for(var f in this.myGestureDetectors)this.myGestureDetectors[f].detect(a)&&(d=!0);else if(b)for(f in a.state=3,this.myGestureDetectors)this.myGestureDetectors[f].detect(a)&&(d=!0);return d},isTouchInside:function(a){var b=this.verticalScroll?0:-this.translateX,
d=this.verticalScroll?-this.translateY:0,f=b+this.frame.width,c=d+this.frame.height,g;for(g in a.touchPoints){var l=a.touchPoints[g];if(l.x>b&&l.y>d&&l.x<f&&l.y<c)return!0}return!1},setPageScrollEnable:function(a){this.pageScrollEnable=c.parseBoolean(a)},_pullback:function(){var a=this;if(this.verticalScroll){var b=this.getMaxTranslateY();this.translateY>b?(d=new q,d.factor=2,f=new t,f.timeInterplator=d,f.fromTranslateY=this.translateY,f.toTranslateY=b,f.duration=800,f.callback=function(){a.onScrollEnd()},
this.startAnimation(f),this.requestDraw()):(b=this.getMinTranslateY(),this.translateY<b&&(d=new q,d.factor=2,f=new t,f.timeInterplator=d,f.fromTranslateY=this.translateY,f.toTranslateY=b,f.duration=800,f.callback=function(){a.onScrollEnd()},this.startAnimation(f),this.requestDraw()))}else if(b=this.getMaxTranslateX(),this.translateX>b){var d=new q;d.factor=2;var f=new t;f.timeInterplator=d;f.fromTranslateX=this.translateX;f.toTranslateX=b;f.duration=800;f.callback=function(){a.onScrollEnd()};this.startAnimation(f)}else b=
this.getMinTranslateX(),this.translateX<b&&(d=new q,d.factor=2,f=new t,f.timeInterplator=d,f.fromTranslateX=this.translateX,f.toTranslateX=b,f.duration=800,f.callback=function(){a.onScrollEnd()},this.startAnimation(f))},forceMove:function(a,b){if(this.verticalScroll){var d=.03,f=.5*Math.abs(b)/d,c=this.translateY,g=c+.5*d*f*f*(0<b?1:-1),l=this,d=new q,k=new t;k.timeInterplator=d;k.fromTranslateY=c;k.toTranslateY=g}else{var d=.03,f=.5*Math.abs(a)/d,c=this.translateX,g=c+.5*d*f*f*(0<a?1:-1),l=this,
d=new q,k=new t;k.timeInterplator=d;k.fromTranslateX=c;k.toTranslateX=g}k.duration=f;k.callback=function(){l._pullback()};this.startAnimation(k);this.requestDraw()},fly:function(a,b){var d=this;if(this.verticalScroll){var f=this.getMinTranslateY(),c=this.getMaxTranslateY();if(this.translateY>c||this.translateY<f){this.forceMove(a,b);return}c=.001;f=Math.abs(b)/c;g=.5*c*f*f*(0<b?1:-1);c=this.translateY+g;this.pageScrollEnable&&(c=0<g?Math.ceil(this.translateY/this.frame.height)*this.frame.height:Math.floor(this.translateY/
this.frame.height)*this.frame.height,f=500);g=new x;g.timeInterplator=new q(2);g.fromTranslateY=this.translateY;g.toTranslateY=c}else{f=this.getMinTranslateX();c=this.getMaxTranslateX();if(this.translateX>c||this.translateX<f){this.forceMove(a,b);return}var c=.001,f=Math.abs(a)/c,g=.5*c*f*f*(0<a?1:-1),c=this.translateX+g;this.pageScrollEnable&&(c=0<g?Math.ceil(this.translateX/this.frame.width)*this.frame.width:0>g?Math.floor(this.translateX/this.frame.width)*this.frame.width:Math.round(this.translateX/
this.frame.width)*this.frame.width,f=500);g=new x;g.timeInterplator=new q(2);g.fromTranslateX=this.translateX;g.toTranslateX=c}g.duration=f;g.callback=function(){d.onScrollEnd()};this.startAnimation(g);this.requestDraw()},onScrollEnd:function(){if(null!=this.onScrollEndCallback)this.onScrollEndCallback()},getMaxTranslateX:function(){return this.maxTranslateX},getMaxTranslateY:function(){return this.maxTranslateY},getMinTranslateY:function(){var a=0,b;for(b in this.subViews){var d=this.subViews[b],
d=-(d.frame.getBottom()+d.layoutParam.margin.bottom)+this.frame.height-this.layoutParam.padding.bottom;d<a&&(a=d)}return a},getMinTranslateX:function(){var a=0,b;for(b in this.subViews){var d=this.subViews[b],d=-(d.frame.getRight()+d.layoutParam.margin.right)+this.frame.width-this.layoutParam.padding.right;d<a&&(a=d)}return a},pageScrollForward:function(){if(this.verticalScroll){var a=this.translateY;null!=this.animation&&null!=this.animation.toTranslateY&&(a=this.animation.toTranslateY)}else a=this.translateX,
null!=this.animation&&null!=this.animation.toTranslateX&&(a=this.animation.toTranslateX);this.scrollToSmoothly(a-this.frame.width)},pageScrollBackward:function(){if(this.verticalScroll){var a=this.translateY;null!=this.animation&&null!=this.animation.toTranslateY&&(a=this.animation.toTranslateY);this.scrollToSmoothly(a+this.frame.height)}else a=this.translateX,null!=this.animation&&null!=this.animation.toTranslateX&&(a=this.animation.toTranslateX),this.scrollToSmoothly(a+this.frame.width)},startAnimation:function(){return c.prototype.startAnimation.apply(this,
arguments)},scrollToSmoothly:function(a,b){var d=this;if(this.verticalScroll){this.pageScrollEnable&&(a=this.translateY<a?Math.ceil(a/this.frame.height)*this.frame.height:this.translateX>a?Math.floor(a/this.frame.height)*this.frame.height:Math.round(a/this.frame.height)*this.frame.height);var c=this.translateY,e=this.getMinTranslateY(),g=this.getMaxTranslateY();a<e&&(a=e);a>g&&a>g;c<e&&(c=e);c>g&&(c=g);a==c?b&&b.call(d,!1):(e=new x,e.timeInterplator=new q(2),e.fromTranslateY=c,e.toTranslateY=a,e.duration=
500,e.callback=function(a){d.onScrollEnd();b&&b.call(d,a)},this.startAnimation(e,!1))}else{this.pageScrollEnable&&(a=this.translateX<a?Math.ceil(a/this.frame.width)*this.frame.width:this.translateX>a?Math.floor(a/this.frame.width)*this.frame.width:Math.round(a/this.frame.width)*this.frame.width);var e=this.getMinTranslateX(),g=this.getMaxTranslateX(),c=this.translateX;c<e&&(c=e);c>g&&(c=g);a<e&&(a=e);a>g&&(a=g);a==c?(log("not start anim due to not change:"+a),this.startAnimation(null),b&&b.call(d,
!1)):(e=new x,e.timeInterplator=new q(2),e.fromTranslateX=c,e.toTranslateX=a,e.duration=500,e.callback=function(a){d.onScrollEnd();b&&b.call(d,a)},log("start anim to :"+a),this.startAnimation(e))}}});var y=com.vizengine.view.ScrollView;u.extend("com.vizengine.view.ListViewAdaptor",{getCellView:function(a,b){null==a&&(a=new c,a.setHeight("100dp"));return a},getCount:function(){return 0}});var L=com.vizengine.view.ListViewAdaptor;y.extend("com.vizengine.view.ListView",{init:function(){y.prototype.init.apply(this,
arguments);this.adaptor=new L;this.layoutParam.layout=p.FRAME;this.cellInfos=[];this.reuseCells=[];this.lastVisiblePosition=this.firstVisiblePosition=-1;this.minTranslateX=Math.MIN_VALUE;this.maxTranslateX=0;this.minTranslateY=Math.MIN_VALUE;this.maxTranslateY=0},setAdaptor:function(a){this.adaptor=a},setLayout:function(a){this.verticalScroll="horizontal"==a?!1:!0},onScroll:function(){this.updateMinTranslateY();y.prototype.onScroll.apply(this,arguments);this.checkCells()},getMinTranslateY:function(){return this.minTranslateY},
getMinTranslateX:function(){return this.minTranslateX},dispatchLayout:function(){y.prototype.dispatchLayout.apply(this,arguments);this.checkCells()},_getLastVisibleCellTop:function(){return 0>this.lastVisiblePosition?0:this.cellInfos[this.lastVisiblePosition].top},_getLastVisibleCellHeight:function(){return 0>this.lastVisiblePosition?0:this.cellInfos[this.lastVisiblePosition].height},_getContentBottom:function(){var a=this._getLastVisibleCellTop()+this._getLastVisibleCellHeight(),b=0,b=this.verticalScroll?
this.frame.height:this.frame.width;a<b&&(a=b);return a},updateMinTranslateY:function(){var a=this.adaptor.getCount();this.lastVisiblePosition==a-1?this.verticalScroll?this.minTranslateY=-(this._getContentBottom()+this.layoutParam.padding.bottom)+this.frame.height:this.minTranslateX=-(this._getContentBottom()+this.layoutParam.padding.right)+this.frame.width:this.verticalScroll?this.minTranslateY=Math.MIN_VALUE:this.minTranslateX=Math.MIN_VALUE},checkCells:function(){this.packPreCells();this.packPostCells();
this.addPreCells();this.addPostCells()},updateCellInfo:function(a){for(var b=this.adaptor.getCount(),d=0;d<=a&&this.cellInfos.length<b;d++){var c=this.adaptor.getCellView(this.reuseCells.pop(),d);this.reuseCells.push(c);var c=this._measureCellHeight(c),e=0;0==d?e=this.verticalScroll?this.layoutParam.padding.top:this.layoutParam.padding.left:(e=this.cellInfos[d-1],e=e.top+e.height);d<this.cellInfos.length?(this.cellInfos[d].top=e,this.cellInfos[d].height=c):this.cellInfos.push({top:e,height:c})}},
ensureCellInfo:function(a){for(var b=this.adaptor.getCount();a>=this.cellInfos.length;){var d=this.cellInfos.length;if(d>=b)break;var c=this.adaptor.getCellView(this.reuseCells.pop(),d);this.reuseCells.push(c);var c=this._measureCellHeight(c),e=0;0==d?e=this.verticalScroll?this.layoutParam.padding.top:this.layoutParam.padding.left:(d=this.cellInfos[this.cellInfos.length-1],e=d.top+d.height);this.cellInfos.push({top:e,height:c})}},getFirstVisiblePosition:function(){return this.firstVisiblePosition},
getLastVisiblePosition:function(){return this.lastVisiblePosition},packPreCells:function(){if(!(0>this.firstVisiblePosition))for(var a=0,b=this.getScrollTop();this.firstVisiblePosition<this.cellInfos.length;){a=this.cellInfos[this.firstVisiblePosition].top+this.cellInfos[this.firstVisiblePosition].height;if(a>b)break;this._removeCellView(this.firstVisiblePosition);this.firstVisiblePosition++}},packPostCells:function(){if(!(0>this.lastVisiblePosition))for(var a=0,b=this.getScrollBottom();0<=this.lastVisiblePosition;){a=
this.cellInfos[this.lastVisiblePosition].top;if(a<b)break;this._removeCellView(this.lastVisiblePosition);this.lastVisiblePosition--}},_removeCellView:function(a){var b=this.cellInfos[a].view;null!=b&&(this.reuseCells.push(b),this.verticalScroll?b.setTranslateY(-10*this.cellInfos[a].height):b.setTranslateX(-10*this.cellInfos[a].height),this.cellInfos[a].view=null)},addPreCells:function(){if(0!=this.adaptor.getCount()){var a=0,b=this.getFirstVisiblePosition();0<=b&&(this.ensureCellInfo(b),a=this.cellInfos[b].top);
for(var d=this.getScrollTop();a>d;){var c=b-1;if(0>c)break;this.ensureCellInfo(c);var e=this.adaptor.getCellView(this.reuseCells.pop(),c),a=this.cellInfos[c].top;this._addCellView(e,c,a,this.cellInfos[c].height);b--;this.firstVisiblePosition--}}},addPostCells:function(){if(0!=this.adaptor.getCount()){var a=0,b=this.getLastVisiblePosition();0<=b&&(this.ensureCellInfo(b),a=this.cellInfos[b].top+this.cellInfos[b].height);for(var d=this.getScrollBottom();a<d;){var c=b+1;if(c>=this.adaptor.getCount())break;
this.ensureCellInfo(c);var e=this.adaptor.getCellView(this.reuseCells.pop(),c),g=this.cellInfos[c].height,a=this.cellInfos[c].top;this._addCellView(e,c,a,g);a+=g;b++;0>this.firstVisiblePosition&&(this.firstVisiblePosition=0);this.lastVisiblePosition++}}},_addCellView:function(a,b,d,c){this.cellInfos[b].view=a;a._top_=d;a._height_=c;if(null==a.parentView){this.addView(a,null,!1);var e=this;a._requestedLayout_=!1;a._dispatchLayout_=function(){this._requestedLayout_=!1;e.verticalScroll?(this.frame.x=
e.layoutParam.padding.left+this.layoutParam.margin.left,this.frame.y=e.layoutParam.padding.top+this.layoutParam.margin.top,this.frame.width=this.measureWidth(),this.frame.height=this._height_-this.layoutParam.margin.vspace(),this.dispatchLayout(),this.setTranslateY(this._top_+this.layoutParam.margin.top-this.frame.y)):(this.frame.x=e.layoutParam.padding.left+this.layoutParam.margin.left,this.frame.y=e.layoutParam.padding.top+this.layoutParam.margin.top,this.frame.height=this.measureHeight(),this.frame.width=
this._height_-this.layoutParam.margin.hspace(),this.dispatchLayout(),this.setTranslateX(this._top_+this.layoutParam.margin.left-this.frame.x))};a.requestLayout=function(){this._requestedLayout_||(this._requestedLayout_=!0,setTimeout(function(){a._dispatchLayout_()},0))}}a.requestLayout()},_measureCellHeight:function(a){var b=0;null==a.parentView?(a.parentView=this,b=this.verticalScroll?a.measureBoxHeight():a.measureBoxWidth(),a.parentView=null):b=this.verticalScroll?a.measureBoxHeight():a.measureBoxWidth();
return b},getScrollTop:function(){return this.verticalScroll?-this.translateY:-this.translateX},getScrollBottom:function(){return this.verticalScroll?-this.translateY+this.frame.height:-this.translateX+this.frame.width},notifyDataChanged:function(){var a=this.adaptor.getCount();this.lastVisiblePosition>=a&&(this.lastVisiblePosition=a-1,this.firstVisiblePosition>=this.lastVisiblePosition&&(this.firstVisiblePosition=this.lastVisiblePosition));this.updateCellInfo(this.lastVisiblePosition);for(var a=
[],b=this.firstVisiblePosition;b<=this.lastVisiblePosition&&0<=b;b++){var d=this.adaptor.getCellView(this.cellInfos[b].view,b);this._addCellView(d,b,this.cellInfos[b].top,this.cellInfos[b].height);a.push(d)}for(b=this.subViews.length-1;0<=b;b--)0>a.indexOf(this.subViews[b])&&this.subViews[b].setTranslateY(-1024);this.checkCells();0<this.frame.width&&0<this.frame.height&&this.fly(0,0)},reset:function(){this.firstVisiblePosition=this.lastVisiblePosition=-1;this.clearViews();this.cellInfos.length=0;
this.checkCells()}});var M=com.vizengine.view.ListView;c.extend("com.vizengine.view.PullToRefreshView",{init:function(){c.prototype.init.apply(this,arguments);this.headerViewContainer=new c;this.addView(this.headerViewContainer);this.headerView=null;this.listView=new M;this.addView(this.listView);var a=this;this.listView.onScrollCallback=function(){a.headerViewContainer.setTranslateY(a.listView.translateY);if(null!=a.listView.adaptor&&null!=a.listView.adaptor.onPull&&0<=a.listView.translateY&&0==
a.listView.maxTranslateY)a.listView.adaptor.onPull(a.listView.translateY,1)}},setLayout:function(a){c.prototype.setLayout.call(this,"frame")},dispatchTouch:function(a){c.prototype.dispatchTouch.apply(this,arguments);if(0==this.listView.maxTranslateY)if(0==a.state){if(null!=this.listView.adaptor&&null!=this.listView.adaptor.onPull)this.listView.adaptor.onPull(this.listView.translateY,0)}else if(2<=a.state&&null!=this.listView.adaptor&&null!=this.listView.adaptor.onPull){var b=this.listView.translateY>
this.headerView.frame.height?2:3;2==b&&(this.listView.maxTranslateY=this.headerView.frame.height);this.listView.adaptor.onPull(this.listView.translateY,b)}},setHeaderView:function(a){var b=a.measureBoxHeight();a.layoutParam.margin.top-=b;this.headerView=a;this.headerViewContainer.addView(a)},getHeaderView:function(){return this.headerView},setAdaptor:function(a){this.listView.setAdaptor(a)},notifyDataChanged:function(){this.listView.notifyDataChanged();this.listView.maxTranslateY=0;0<this.listView.translateY&&
this.listView._pullback()}});c.extend("com.vizengine.view.ScannerView",{init:function(){c.prototype.init.apply(this,arguments)},_createNativeView:function(){return createNativeObject("NativeScannerView")},setScannerRect:function(a,b,d,c){this._nativeView.setScannerRect(a,b,d,c)},scan:function(a){this._nativeView.scan(a)}});c.extend("com.vizengine.view.WebView",{_createNativeView:function(){return createNativeObject("NativeWebView")},setSrc:function(a,b){this._nativeView.setSrc(a,function(){b&&b()})},
setData:function(a){this._nativeView.setData(a);this.requestLayout()},measureHeight:function(){if(this.layoutParam.height==m.WRAP){var a=this.measureWidth();return this._nativeView.measureContentHeight(a)}return c.prototype.measureHeight.apply(this,arguments)}});c.extend("com.vizengine.view.Page",{_backPage:null,init:function(){c.prototype.init.apply(this,arguments)},updateStatusBarLight:function(){var a=n.defaultStatusBarLight;null!=this.statusBarLight&&(a=this.statusBarLight);com.vizengine.$.setStatusBarLight(a);
com.vizengine.$.setStatusBarHidden(this.statusBarHidden&&"true"==this.statusBarHidden?1:0)},onPageWillShown:function(a){},onPageDidShown:function(a){},onPageWillHidden:function(a){},onPageDidHidden:function(a){},backward:function(a){if(!(2>this._getPageStack().length)&&this.peek().pageInstance==this)if(this.parentView._switching)log("WARN: backward when page swithing");else{this.parentView._switching=!0;this.pop();var b=this.peekAndRestore();a=com.vizengine.core.RequestUtil.getRequestParam("?"+a);
a=n.getPageAnimation(a.frameworkParams.animation,!1);this._cancelPageAnimation();var d=this.parentView;d.addView(b.pageInstance,0);b.pageInstance.updateStatusBarLight();this.onPageWillHidden(!1);b.pageInstance.onPageWillShown(!1);var c=this;null!=a?(d.touchable=!1,a(this,b.pageInstance,function(){d.touchable=!0;d.removeView(c);c.onPageDidHidden(!1);b.pageInstance.onPageDidShown(!1);n.navigationListener&&n.navigationListener(b.pageInstance);d._switching=!1})):(d.removeView(this),this.onPageDidHidden(!1),
b.pageInstance.onPageDidShown(!1),d._switching=!1)}},forwardTo:function(a,b){var d=this.parentView;if(d._switching)log('WARN: forward To "'+a+'" when page swithing');else{d._switching=!0;a=c.resolvePath(this.getContextPath(),a);var f=this;this.loadPage(a,b,function(a){f._forwardToPage(a)})}},_forwardToPage:function(a){var b=n.getPageAnimation(a.pageParam.frameworkParams.animation,!0);this._cancelPageAnimation();this.push(a);var d=this.parentView;d.addView(a);var c=this;a.updateStatusBarLight();this.onPageWillHidden(!0);
a.onPageWillShown(!0);null!=b?(d.touchable=!1,b(this,a,function(){d.touchable=!0;d.removeView(c);c.onPageDidHidden(!0);a.onPageDidShown(!0);n.navigationListener&&n.navigationListener(a);d._switching=!1})):(d.removeView(this),this.onPageDidHidden(!0),a.onPageDidShown(!0),n.navigationListener&&n.navigationListener(a),d._switching=!1,this.requestLayout())},_cancelPageAnimation:function(){for(var a=this.parentView,b=0;b<a.subViews.length;b++)a.subViews[b].startAnimation(null)},_getPageStack:function(){null==
this.parentView.pageStack&&(this.parentView.pageStack=[]);return this.parentView.pageStack},push:function(a){this._getPageStack().push({pageInstance:a,pageParam:a.pageParam,pageCallback:a.pageCallback})},peek:function(a){null==a&&(a=0);var b=this._getPageStack();return 0==b.length?null:b[b.length-1-a]},peekAndRestore:function(a){a=this.peek(a);a.pageInstance.pageParam=a.pageParam;a.pageInstance.pageCallback=a.pageCallback;return a},pop:function(){var a=this._getPageStack();return 0==a.length?null:
a.pop()},loadPage:function(a,b,d){var f=com.vizengine.core.RequestUtil.getRequestParam(a),e=a.indexOf("?");0<=e&&(a=a.substring(0,e));module(a,function(e){var l=null;e instanceof n?l=e:e instanceof Function&&(c.parseBoolean(f.frameworkParams.singleInstance)?(null==e.instance&&(e.instance=e(f)),l=e.instance):l=e(f));null==l.contextPath&&(l.contextPath=a);l.pageParam=f;l.pageCallback=b;if("clearTop"==f.frameworkParams.launchMode){e=l._getPageStack();for(var k=0;k<e.length;k++)if(e[k].pageInstance.getContextPath()==
l.getContextPath()){e.length=k;break}}d(l)})}});var n=com.vizengine.view.Page;n.loadPage=function(a,b,d){var f=com.vizengine.core.RequestUtil.getRequestParam(a),e=a.indexOf("?");0<=e&&(a=a.substring(0,e));module(a,function(e){var l=null;e instanceof n?l=e:e instanceof Function&&(c.parseBoolean(f.frameworkParams.singleInstance)?(null==e.instance&&(e.instance=e(f)),l=e.instance):l=e(f));null==l.contextPath&&(l.contextPath=a);l.pageParam=f;l.pageCallback=b;d(l)})};n.navigationListener=null;n.defaultStatusBarLight=
!1;n.getPageAnimation=function(a,b){var d=n.pageAnimaions[a];return d?d:b?n.pageAnimaions.pushLeft:n.pageAnimaions.popRight};n.registAnimation=function(a,b){n.pageAnimaions[a]=b};n.pageAnimaions={"null":function(a,b,d){d()},pushLeft:function(a,b,d){var c=new q(2);a.setTranslateX(0);b.setTranslateX(a.frame.width);var e=new w;e.animateFrame=function(d,c){a.setTranslateX(0-a.frame.width*c);b.setTranslateX(a.frame.width*(1-c))};e.duration=700;e.timeInterplator=c;e.callback=function(){d();a.setTranslateX(0);
b.setTranslateX(0)};a.startAnimation(e)},popRight:function(a,b,d){var c=new q(2),e=new w;e.animateFrame=function(c,d){a.setTranslateX(a.frame.width*d);b.setTranslateX(a.frame.width*(d-1))};e.duration=700;e.timeInterplator=c;e.callback=function(){d();a.setTranslateX(0);b.setTranslateX(0)};a.setTranslateX(0);b.setTranslateX(-a.frame.width);a.startAnimation(e)},pushTop:function(a,b,d){var c=new q(2);a.setTranslateX(0);b.setTranslateX(0);a.setTranslateY(0);b.setTranslateY(a.frame.height);var e=new w;
e.animateFrame=function(c,d){b.setTranslateY(a.frame.height*(1-d))};e.duration=700;e.timeInterplator=c;e.callback=function(){d();b.setTranslateY(0)};a.startAnimation(e)},popBottom:function(a,b,c){var f=new q(2);a.setTranslateX(0);b.setTranslateX(0);a.setTranslateY(0);b.setTranslateY(0);var e=new w;e.animateFrame=function(b,c){a.setTranslateY(a.frame.height*c)};e.duration=700;e.timeInterplator=f;e.callback=function(){c();b.setTranslateX(0)};a.startAnimation(e)},alpha:function(a,b,c){var f=new q(2),
e=new w;e.animateFrame=function(c,d){a.setAlpha(1-d);b.setAlpha(d)};e.duration=700;e.timeInterplator=f;e.callback=function(){c();a.setAlpha(1);b.setAlpha(1)};a.startAnimation(e)}};c.extend("com.vizengine.view.MapViewInternal",{_createNativeView:function(){return createNativeObject("NativeMapView")}});c.extend("com.vizengine.view.MapView",{init:function(){c.prototype.init.apply(this,arguments);this.viewportChangeCallback=null;this.innerMapView=new com.vizengine.view.MapViewInternal;this.addView(this.innerMapView);
var a=this;this.innerMapView._nativeView.setViewportChangeCallback(function(){a.viewportChangeCallback&&a.viewportChangeCallback()})},clearViews:function(a){for(;1<this.subViews.length;)this.removeViewAt(1,a)},start:function(){this.innerMapView._nativeView.start()},stop:function(){this.innerMapView._nativeView.stop()},addView:function(a,b,d){a!=this.innerMapView&&a._nativeView.setTouchable(0);return"undefined"==typeof b?c.prototype.addView.apply(this,arguments):c.prototype.addView.call(this,a,b+1,
d)},addMarker:function(a){this.innerMapView._nativeView.addMarker(a._nativeView,a)},removeMarker:function(a){this.innerMapView._nativeView.removeMarker(a)},clearMarkers:function(){this.innerMapView._nativeView.clearMarkers()},selectMarker:function(a){this.innerMapView._nativeView.selectMarker(a)},updateMarker:function(a){this.innerMapView._nativeView.updateMarker(a._nativeView,a)},getCoordinate:function(a){return this.innerMapView._nativeView.getCoordinate(a)},getPoint:function(a){return this.innerMapView._nativeView.getPoint(a)},
setMapCenter:function(a,b){null==b&&(b=!1);this.innerMapView._nativeView.setMapCenter(a,b?1:0)},setZoom:function(a,b){null==b&&(b=!1);this.innerMapView._nativeView.setZoom(a,b?1:0)},setMapBound:function(a,b){null==b&&(b=!1);this.innerMapView._nativeView.setMapBound(a,b?1:0)},getZoom:function(){return this.innerMapView._nativeView.getZoom()},getMapCenter:function(){return this.getCoordinate({x:this.frame.width/2,y:this.frame.height/2})},disableRotateCamera:function(){this.innerMapView._nativeView.disableRotateCamera()}});
window.createRootView=function(a){var b=new c(a);b.checkAndHideKeyboard=function(a,b){var c=com.vizengine.view.InputView.focusedInputView;null!=c&&(c=c.getFrameInRootView(),(a<c.x||a>c.x+c.width||b<c.y||b>c.y+c.height)&&com.vizengine.view.InputView.clearFocus())};b.latestEvent=null;b.nativeTouch=function(a,c){var e=com.vizengine.gesture.TouchEvent,g=null;switch(a){case 0:g=latestEvent=new e;for(e=g.state=0;e<c.length/2;e++){var h=new z;h.absX=h.x=c[2*e];h.absY=h.y=c[2*e+1];g.touchPoints[e]=h}return b.dispatchTouch(g);
case 2:g=new e;g.state=2;for(e=0;e<c.length/2;e++)h=new z,h.absX=h.x=c[2*e],h.absY=h.y=c[2*e+1],g.touchPoints[e]=h;0==g.touchPoints.length&&(g.touchPoints=latestEvent.touchPoints,g.ghost=!0);e=b.dispatchTouch(g);b.checkAndHideKeyboard(g.getAbsX(),g.getAbsY());return e;case 1:g=latestEvent=new e;g.state=1;for(e=0;e<c.length/2;e++)h=new z,h.absX=h.x=c[2*e],h.absY=h.y=c[2*e+1],g.touchPoints[e]=h;return b.dispatchTouch(g)}return!1};b.onKeyboardChange=function(a){var c=v.focusedInputView;if(null!=c)if(0<
a){var e=this.frame,c=c.getFrameInRootView().getBottom();a=e.getBottom()-a-20;c>a&&(e=new com.vizengine.animation.TranslateAnimation,e.fromTranslateY=0,e.toTranslateY=a-c,e.duration=300,e.timeInterplator=new com.vizengine.animation.DecelerateInterpolator(2),e.callback=function(){window.rootView.subViews[0].requestLayout()},this.subViews[0].startAnimation(e))}else e=new com.vizengine.animation.TranslateAnimation,e.fromTranslateY=this.subViews[0].translateY,e.toTranslateY=0,e.duration=300,e.timeInterplator=
new com.vizengine.animation.DecelerateInterpolator(2),e.callback=function(){b.subViews[0].requestLayout()},this.subViews[0].startAnimation(e)};b.initRootView=function(a){a instanceof Function&&(a=a());a.setClipToBounds(!0);b.clearViews();b.addView(a);b.resize();a instanceof n&&(a.push(a),a.updateStatusBarLight(),a.onPageWillShown(!0),a.onPageDidShown(!0),n.navigationListener&&n.navigationListener(a))};b.isLayouting=!1;b.isLayoutDirty=!0;b.resize=function(){this.isLayoutDirty=!1;this.isLayouting=!0;
var a=window.nativeRootView.getViewportWidth(),b=window.nativeRootView.getViewportHeight();0<a&&0<b&&(this.frame.width=a,this.frame.height=b,this.dispatchLayout(),this.requestDraw(),this.setVisible(!0));this.isLayouting=!1;this.isLayoutDirty&&this.resize()};b.interceptMethod("requestLayout",function(){var a=this._origin.apply(this,arguments);this.isLayouting?this.isLayoutDirty=!0:(this.isLayouting=!0,setTimeout(function(){b.resize()},0));return a});return b}});
