<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
		<meta name="description" content="">
		<meta name="author" content="ThemeBucket">
		<link rel="shortcut icon" href="#" type="image/png">
		<title>商品管理</title>
		<link rel="stylesheet" type="text/css" href="js/ios-switch/switchery.css" />
		<link href="css/style.css" rel="stylesheet">
		<link href="css/style-responsive.css" rel="stylesheet">
		<link href="js/iCheck/skins/minimal/green.css" rel="stylesheet">
		<link rel="stylesheet" href="js/control/css/zyUpload.css" type="text/css">
		<link href="js/iCheck/skins/flat/green.css" rel="stylesheet">
		<link href="css/cityPlus.css" rel="stylesheet">
		<link href="css/bootstrapValidator.css" rel="stylesheet">

		<link rel="stylesheet" type="text/css" href="css/select2.min.css"/>
		<script src="js/jquery-1.10.2.min.js"></script>
		<script src="js/ysh_comm.js"></script>
		<script type="text/javascript">
			checkPermission();
		</script>
	</head>

	<body style="background: white;" class="children-body">
		<section>
			<div>
				<section class="panel">
					<div class="panel-body">
						<div class="page-heading">
							<h3>运费模板添加</h3>
							<ul class="breadcrumb">
								<li>
									<a href="#">运费管理</a>
								</li>
								<li class="active">运费模板添加</li>
							</ul>
						</div>
					</div>
				</section>

				<section class="wrapper">
					<section class="panel">
						<div class="panel-body">
							<div class="row">
								<div class="col-lg-1" style="text-align: right;margin-top: 7px;">
									<span>模板名称</span>
								</div>
								<div class="col-lg-3">
									<input type="text" class="form-control" id="txt_modelname">
								</div>
							</div>
							<div class="row" style="height: 14px;"></div>
							<div class="row">
								<div class="col-lg-1" style="text-align: right;margin-top: 7px;">
									<span>商品地址</span>
								</div>
								<div class="col-lg-2" style="text-align: right;">
									<select class="form-control m-bot15" id="StateProvinceId">

                            		</select>
								</div>
								<div class="col-lg-2">
									<select class="form-control m-bot15" id="Cityid">

                            		</select>
								</div>
								<div class="col-lg-2">
									<select class="form-control m-bot15" id="DistrictCounty">

                            		</select>
								</div>
							</div>
							<div class="row">
								<div class="col-lg-1" style="text-align: right;margin-top: 10px;">
									<span>是否包邮</span>
								</div>
								<div class="col-lg-6 icheck">
									<div class="minimal-green single-row">
										<div class="radio single-row">
											<input type="radio" name="rad_isbaoyou" value="2" checked="checked" onclick="radioClick(this);">
											<label>自定义邮费</label>
										</div>
										<div class="radio single-row">
											<input type="radio" name="rad_isbaoyou" value="1" onclick="radioClick(this);">
											<label>卖家承担邮费</label>
										</div>
									</div>
								</div>
							</div>
							<div class="row" style="height: 14px;"></div>
							<div class="row">
								<div class="col-lg-1" style="text-align: right;margin-top: 10px;">
									<span>计价方式</span>
								</div>
								<div class="col-lg-9 icheck">
									<div class="minimal-green single-row">
										<div class="radio ">
											<input tabindex="3" type="radio" value="3" name="rad_pricemode" onclick="radioClick(this);">
											<label>按件数</label>
										</div>
										<div class="radio single-row">
											<input tabindex="3" type="radio" value="4" name="rad_pricemode" checked="checked" onclick="radioClick(this);">
											<label>按重量</label>
										</div>
									</div>
								</div>
							</div>
							<div class="row" style="height: 14px;"></div>
							<div class="row">
								<div class="col-lg-1" style="text-align: right;margin-top: 10px;">
									<span>运送方式</span>
								</div>
								<div class="col-lg-11 icheck">
									<div class="minimal-green single-row">
										<div class="row" style="width: 100%;">
											<div class="checkbox">
												<input type="radio" id="ck_kd" value="1" name="rad_deliverymode" onclick="Deliverymodechoose(1);">
												<label>快递</label>
											</div>
										</div>
									</div>
									<div class="minimal-green single-row ShippingDetails" id="kd_specialfreight" style="display: none;">
										<div class="row">
											<div class="col-lg-1" style="text-align: right;margin-top: 7px;">
												<span>默认运费</span>
											</div>
											<div class="col-lg-1">
												<input type="text" class="form-control" value="1" id="kd_DefaultMinWeight" onBlur="CheckMRInput(this);">
											</div>
											<div class="col-lg-1" style="margin-top: 7px;">
												<span class="tj_1">kg</span>内,
											</div>
											<div class="col-lg-1">
												<input type="text" class="form-control" value="1" id="kd_DefaultPrice" onBlur="CheckMRInput(this);">
											</div>
											<div class="col-lg-1" style="margin-top: 7px;">
												<span>元</span>，每增加
											</div>
											<div class="col-lg-1">
												<input type="text" class="form-control" value="1" id="kd_ContinuedWeight" onBlur="CheckMRInput(this);">
											</div>
											<div class="col-lg-1" style="margin-top: 7px;">
												<span class="tj_1">kg</span>,增加运费
											</div>
											<div class="col-lg-1">
												<input type="text" class="form-control" value="1" id="kd_ContinuedPrice" onBlur="CheckMRInput(this);">
											</div>
											<div class="col-lg-1" style="margin-top: 7px;">
												<span>元</span>
											</div>
										</div>
										<div class="row" style="width: 100%;">
											<div class="col-lg-12">
												<section class="panel">
													<div class="panel-heading">
														<div class="text-right">
															<button class="btn btn-success" type="button" id="btn_KDBatchShutdown">为指定地区添加运费</button>
														</div>
													</div>
													<div class="panel-body">
														<table id="kd" class="table table-striped table-condensed table-hover talbe-border" data-unique-id="Id">
															<thead>
																<tr>
																	<th data-field="Id" data-align="center">序号</th>
																	<th data-field="AreaName" data-align="center">运送到</th>
																	<th data-field="DefaultMinWeight" data-align="center">首<span class="tj_2">重</span>(<span class="tj_1">kg</span>)</th>
																	<th data-field="DefaultPrice" data-align="center">首费(元)</th>
																	<th data-field="ContinuedWeight" data-align="center">续<span class="tj_2">重</span>(<span class="tj_1">kg</span>)</th>
																	<th data-field="ContinuedPrice" data-align="center">续费(元)</th>
																	<th data-field="Id" data-align="center" data-formatter="kd_operationFormatter">操作</th>
																</tr>
															</thead>
														</table>

													</div>
												</section>
											</div>
										</div>

									</div>

									<div class="minimal-green single-row">
										<div class="row" style="width: 100%;">
											<div class="checkbox ">
												<input type="radio" id="ck_ems" value="3" name="rad_deliverymode" onclick="Deliverymodechoose(2);">
												<label>EMS</label>
											</div>
										</div>
										<div class="minimal-green single-row ShippingDetails" id="ems_specialfreight" style="display: none;">
											<div class="row">
												<div class="col-lg-1" style="text-align: right;margin-top: 7px;">
													<span>默认运费</span>
												</div>
												<div class="col-lg-1">
													<input type="text" class="form-control" value="1" id="ems_DefaultMinWeight" onBlur="CheckMRInput(this);">
												</div>
												<div class="col-lg-1" style="margin-top: 7px;">
													<span class="tj_1">kg</span>内,
												</div>
												<div class="col-lg-1">
													<input type="text" class="form-control" value="1" id="ems_DefaultPrice" onBlur="CheckMRInput(this);">
												</div>
												<div class="col-lg-1" style="margin-top: 7px;">
													<span>元</span>，每增加
												</div>
												<div class="col-lg-1">
													<input type="text" class="form-control" value="1" id="ems_ContinuedWeight" onBlur="CheckMRInput(this);">
												</div>
												<div class="col-lg-1" style="margin-top: 7px;">
													<span class="tj_1">kg</span>,增加运费
												</div>
												<div class="col-lg-1">
													<input type="text" class="form-control" value="1" id="ems_ContinuedPrice" onBlur="CheckMRInput(this);">
												</div>
												<div class="col-lg-1" style="margin-top: 7px;">
													<span>元</span>
												</div>
											</div>
											<div class="row" style="width: 100%;">
												<div class="col-lg-12">
													<section class="panel">
														<div class="panel-heading">
															<div class="text-right">
																<button class="btn btn-success" type="button" id="btn_EMSBatchShutdown">为指定地区添加运费</button>
															</div>
														</div>
														<div class="panel-body">
															<table id="ems" class="table table-striped table-condensed table-hover talbe-border" data-unique-id="Id">
																<thead>
																	<tr>
																		<th data-field="Id" data-align="center">序号</th>
																		<th data-field="AreaName" data-align="center">运送到</th>
																		<th data-field="DefaultMinWeight" data-align="center">首<span class="tj_2">重</span>(<span class="tj_1">kg</span>)</th>
																		<th data-field="DefaultPrice" data-align="center">首费(元)</th>
																		<th data-field="ContinuedWeight" data-align="center">续<span class="tj_2">重</span>(<span class="tj_1">kg</span>)</th>
																		<th data-field="ContinuedPrice" data-align="center">续费(元)</th>
																		<th data-field="Id" data-align="center" data-formatter="ems_operationFormatter">操作</th>
																	</tr>
																</thead>
															</table>

														</div>
													</section>
												</div>
											</div>
										</div>
									</div>
									<div class="minimal-green single-row">
										<div class="row" style="width: 100%;">
											<div class="checkbox ">
												<input type="radio" id="ck_py" value="2" name="rad_deliverymode" onclick="Deliverymodechoose(3);">
												<label>平邮</label>
											</div>
										</div>
										<div class="minimal-green single-row ShippingDetails" id="py_specialfreight" style="display: none;">
											<div class="row">
												<div class="col-lg-1" style="text-align: right;margin-top: 7px;">
													<span>默认运费</span>
												</div>
												<div class="col-lg-1">
													<input type="text" class="form-control" value="1" id="py_DefaultMinWeight" onBlur="CheckMRInput(this);">
												</div>
												<div class="col-lg-1" style="margin-top: 7px;">
													<span class="tj_1">kg</span>内,
												</div>
												<div class="col-lg-1">
													<input type="text" class="form-control" value="1" id="py_DefaultPrice" onBlur="CheckMRInput(this);">
												</div>
												<div class="col-lg-1" style="margin-top: 7px;">
													<span>元</span>，每增加
												</div>
												<div class="col-lg-1">
													<input type="text" class="form-control" value="1" id="py_ContinuedWeight" onBlur="CheckMRInput(this);">
												</div>
												<div class="col-lg-1" style="margin-top: 7px;">
													<span class="tj_1">kg</span>,增加运费
												</div>
												<div class="col-lg-1">
													<input type="text" class="form-control" value="1" id="py_ContinuedPrice" onBlur="CheckMRInput(this);">
												</div>
												<div class="col-lg-1" style="margin-top: 7px;">
													<span>元</span>
												</div>
											</div>
											<div class="row" style="width: 100%;">
												<div class="col-lg-12">
													<section class="panel">
														<div class="panel-heading">
															<div class="text-right">
																<button class="btn btn-success" type="button" id="btn_PYBatchShutdown">为指定地区添加运费</button>
															</div>
														</div>
														<div class="panel-body">
															<table id="py" class="table table-striped table-condensed table-hover talbe-border" data-unique-id="Id">
																<thead>
																	<tr>
																		<th data-field="Id" data-align="center">序号</th>
																		<th data-field="AreaName" data-align="center">运送到</th>
																		<th data-field="DefaultMinWeight" data-align="center">首<span class="tj_2">重</span>(<span class="tj_1">kg</span>)</th>
																		<th data-field="DefaultPrice" data-align="center">首费(元)</th>
																		<th data-field="ContinuedWeight" data-align="center">续<span class="tj_2">重</span>(<span class="tj_1">kg</span>)</th>
																		<th data-field="ContinuedPrice" data-align="center">续费(元)</th>
																		<th data-field="Id" data-align="center" data-formatter="py_operationFormatter">操作</th>
																	</tr>
																</thead>
															</table>

														</div>
													</section>
												</div>
											</div>

										</div>
									</div>
								</div>
							</div>
							<div class="ShippingDetails">
								<div class="row" style="height: 6px;border-bottom: solid #000000;"></div>
								<div class="row" style="height: 7px;"></div>

								<div class="row">
									<div class="col-lg-1" style="text-align: right;margin-top: 10px;">
										<span>可选</span>
									</div>
									<div class="col-lg-11 icheck">
										<div class="minimal-green single-row">
											<div class="row" style="width: 100%;">
												<div class="checkbox ">
													<input type="checkbox" id="ck_zdtjby" onclick="Deliverymodechoose(4);">
													<label>指定条件包邮</label>
												</div>
											</div>
										</div>
										<div class="minimal-green single-row" id="kx_zdtjby" style="display: none;">
											<div class="row" style="width: 100%;">
												<div class="col-lg-12">
													<section class="panel">
														<div class="panel-heading">
															<div class="text-right">
																<button class="btn btn-success" type="button" id="btn_KXBatchShutdown">添加指定条件</button>
															</div>
														</div>
														<div class="panel-body">
															<table id="zd" class="table table-striped table-condensed table-hover talbe-border" data-unique-id="Id">
																<thead>
																	<tr>
																		<th data-field="Id" data-align="center">序号</th>
																		<th data-field="AreaName" data-align="center">地区</th>
																		<th data-field="DeliveryMode" data-align="center">运送方式</th>
																		<th data-field="CourierFirm" data-align="center">快递</th>
																		<th data-field="FreeShippingTerm" data-align="center">包邮条件</th>
																		<th data-field="MinWeight" data-align="center">最低重量</th>
																		<th data-field="MinPrice" data-align="center">最低金额</th>
																		<th data-field="Id" data-align="center" data-formatter="zd_operationFormatter">操作</th>
																	</tr>
																</thead>
															</table>

														</div>
													</section>
												</div>
											</div>

										</div>
									</div>
								</div>
							</div>
							<div class="row">
								<div class="col-lg-12" style="text-align: center;">
									<button class="btn btn-primary" id="btn_SaveAll">保存并返回</button>
									<button class="btn btn-primary" id="btn_Cancle">取消</button>
								</div>
							</div>
						</div>
					</section>
				</section>
			</div>
		</section>

		<!-- Modal -->
		<div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal_Delivery" class="modal fade" data-backdrop="static">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<label hidden="hidden" id="lbl_ysfs"></label>
						<button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
						<h4 class="modal-title">添加运送方式</h4>
					</div>
					<div class="modal-body">
						<div class=" form">
							<form class="cmxform form-horizontal adminex-form" id="sub_form_ysfs">
								<div class="form-group ">
									<label for="ccomment" class="control-label col-lg-2">运送到:</label>
									<div class="col-lg-5">
										<select class="form-control input-lg m-bot15" id="md_StateProvinceId">

										                            </select>
									</div>
									<div class="col-lg-5">
										<select class="form-control input-lg m-bot15" id="md_Cityid">

										                            </select>
									</div>
								</div>
								<div class="form-group ">
									<label for="cname" class="control-label col-lg-2">首<span class="tj_2">重</span>:</label>
									<div class="col-lg-10">
										<input class="form-control " id="md_shouzhong" name="md_shouzhong" />
									</div>
								</div>
								<div class="form-group ">
									<label for="cemail" class="control-label col-lg-2">首费:</label>
									<div class="col-lg-10">
										<input class="form-control " id="md_shoufei" name="md_shoufei" />
									</div>
								</div>
								<div class="form-group ">
									<label for="curl" class="control-label col-lg-2">续<span class="tj_2">重</span>:</label>
									<div class="col-lg-10">
										<input class="form-control " id="md_xuzhong" name="md_xuzhong" />
									</div>
								</div>
								<div class="form-group ">
									<label for="ccomment" class="control-label col-lg-2">续费:</label>
									<div class="col-lg-10">
										<input class="form-control " id="md_xufei" name="md_xufei" />
									</div>
								</div>
							</form>
						</div>
					</div>
					<div class="modal-footer">

						<button type="button" class="btn btn-success" id="btn_save">保存</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
					</div>
				</div>
			</div>
		</div>
		<!-- modal -->

		<!-- Modal -->
		<div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal_Specific" class="modal fade" data-backdrop="static">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
						<h4 class="modal-title">添加指定条件</h4>
					</div>
					<div class="modal-body">
						<div class=" form">
							<form class="cmxform form-horizontal adminex-form" id="sub_form_zdtj">
								<div class="form-group ">
									<label for="ccomment" class="control-label col-lg-2">选择地区:</label>
									<div class="col-lg-5">
										<select class="form-control input-lg m-bot15" id="zd_StateProvinceId">

										                            </select>
									</div>
									<div class="col-lg-5">
										<select class="form-control input-lg m-bot15" id="zd_Cityid">

										                            </select>
									</div>
								</div>
								<div class="form-group ">
									<label for="cname" class="control-label col-lg-2">运送方式:</label>
									<div class="col-lg-10">
										<select class="form-control input-lg m-bot15" id="zd_yunsongfangshi">

										                            </select>
									</div>
								</div>
								<div class="form-group ">
									<label for="cemail" class="control-label col-lg-2">快递:</label>
									<div class="col-lg-10">
										<select class="form-control input-lg m-bot15" id="zd_kuaidi">

										                            </select>
									</div>
								</div>
								<div class="form-group ">
									<label for="curl" class="control-label col-lg-2">包邮条件:</label>
									<div class="col-lg-10">
										<select class="form-control input-lg m-bot15" id="zd_baoyoutiaojian">

										                            </select>
									</div>
								</div>
								<div class="form-group ">
									<label for="ccomment" class="control-label col-lg-2">最低重量:</label>
									<div class="col-lg-10">
										<input class="form-control " id="zd_zuidizhongliang" name="zd_zuidizhongliang" value="0"/>
									</div>
								</div>
								<div class="form-group ">
									<label for="ccomment" class="control-label col-lg-2">最低金额:</label>
									<div class="col-lg-10">
										<input class="form-control " id="zd_zuidijine" name="zd_zuidijine" value="0"/>
									</div>
								</div>
							</form>
						</div>
					</div>
					<div class="modal-footer">

						<button type="button" class="btn btn-success" id="btn_zdsave">保存</button>
						<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
					</div>
				</div>
			</div>
		</div>
		<!-- modal -->

		<!-- Placed js at the end of the document so the pages load faster -->
		<script src="js/jquery-1.10.2.min.js"></script>
		<script src="js/jquery-ui-1.9.2.custom.min.js"></script>
		<script src="js/jquery-migrate-1.2.1.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/modernizr.min.js"></script>
		<script src="js/jquery.nicescroll.js"></script>
		<!-- 引用核心层插件 -->
		<script type="text/javascript" src="js/core/zyFile.js"></script>
		<!-- 引用控制层插件 -->
		<script type="text/javascript" src="js/control/js/zyUpload.js"></script>
		<!-- 引用初始化JS -->
		<script type="text/javascript" src="js/zyUpload.js"></script>
		<!--		<script src="js/iCheck/jquery.icheck.js"></script>
		<script src="js/icheck-init.js"></script>-->
		<!--common scripts for all pages-->
		<script src="js/scripts.js"></script>
		<script src="js/ios-switch/switchery.js"></script>
		<script src="js/ios-switch/ios-init.js"></script>
		<script src="js/Popt.js"></script>
		<script src="js/cityJson.js"></script>
		<script src="js/citySet.js"></script>
		<script type="text/javascript" src="js/ckeditor/ckeditor.js"></script>
		<!--pickers plugins-->
		<script type="text/javascript" src="js/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
		<script type="text/javascript" src="js/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js"></script>
		<script type="text/javascript" src="js/bootstrap-daterangepicker/moment.min.js"></script>
		<script type="text/javascript" src="js/bootstrap-daterangepicker/daterangepicker.js"></script>
		<script type="text/javascript" src="js/bootstrap-colorpicker/js/bootstrap-colorpicker.js"></script>
		<script type="text/javascript" src="js/bootstrap-timepicker/js/bootstrap-timepicker.js"></script>

		<!--bootstrap Table-->
		<script src='js/bootstrap-table.js'></script>
		<script src='js/bootstrap-table-zh-CN.js'></script>
		<script src='js/bootstrap-editable.js'></script>
		<script src='js/bootstrap-table-editable.js'></script>

		<!--pickers initialization-->
		<script src="js/pickers-init.js"></script>

		<!--common scripts for all pages-->
		<script src="js/scripts.js"></script>
		<script src="js/ysh_comm.js"></script>
		<script src="js/layer.js"></script>
		<script src="js/bootstrapValidator.js"></script>

		<script>
			var kdarray = new Array();
			var emsarray = new Array();
			var pyarray = new Array();
			var zdtjarray = new Array();
			$(document).ready(function() {
				$("#kd").bootstrapTable();
				$("#ems").bootstrapTable();
				$("#py").bootstrapTable();
				$("#zd").bootstrapTable();
				//获取省市区县列表
				getPCD("", "#StateProvinceId");
				getPCD($("#StateProvinceId").find("option:selected").val(), "#Cityid");
				getPCD($("#Cityid").find("option:selected").val(), "#DistrictCounty");
				//摸态框 地址省市绑定
				getPCD("", "#md_StateProvinceId");
				getPCD($("#md_StateProvinceId").find("option:selected").val(), "#md_Cityid");
				getPCD("", "#zd_StateProvinceId");
				getPCD($("#zd_StateProvinceId").find("option:selected").val(), "#zd_Cityid");
				//特定条件下拉列表
				binddropdownlist();
				checkbaoyouState()
			});
			$(document).delegate("#StateProvinceId", "change", function() {
				getPCD($("#StateProvinceId").find("option:selected").val(), "#Cityid");
				getPCD($("#Cityid").find("option:selected").val(), "#DistrictCounty");
			}).delegate("#Cityid", "change", function() {
				getPCD($("#Cityid").find("option:selected").val(), "#DistrictCounty");
			});
			$(document).delegate("#md_StateProvinceId", "change", function() {
				getPCD($("#md_StateProvinceId").find("option:selected").val(), "#md_Cityid");
			});
			$(document).delegate("#zd_StateProvinceId", "change", function() {
				getPCD($("#zd_StateProvinceId").find("option:selected").val(), "#zd_Cityid");
			});

			$("#zd_baoyoutiaojian").on("change", function(){
				checkbaoyouState()
			})

			function checkbaoyouState(){
				var baoyoudictionaryID  = $("#zd_baoyoutiaojian").val();
				if(baoyoudictionaryID == 1){
					$("#zd_zuidijine").attr("readonly", "readonly");
					$("#zd_zuidizhongliang").removeAttr("readonly");
				}else if(baoyoudictionaryID == 2){
					$("#zd_zuidizhongliang").attr("readonly", "readonly");
					$("#zd_zuidijine").removeAttr("readonly");
				}else if(baoyoudictionaryID == 3){
					$("#zd_zuidizhongliang").removeAttr("readonly");
					$("#zd_zuidijine").removeAttr("readonly");
				}
			}

			function kd_operationFormatter(value, row, index) {
				var result = [
					'<button onclick="DelData(' + value + ',1' + ')">删除</button>'
				];
				return result;
			}

			function ems_operationFormatter(value, row, index) {
				var result = [
					'<button onclick="DelData(' + value + ',2' + ')">删除</button>'
				];
				return result;
			}

			function py_operationFormatter(value, row, index) {
				var result = [
					'<button onclick="DelData(' + value + ',3' + ')">删除</button>'
				];
				return result;
			}

			function zd_operationFormatter(value, row, index) {
				var result = [
					'<button onclick="DelData(' + value + ',4' + ')">删除</button>'
				];
				return result;
			}
			//获取省市区方法
			function getPCD(a, b) {
				getDataList(yshurl + "GetAreaInfo", {
					pParentAreaNum: a,
					pPageIndex: 0,
					pPageSize: 100
				}, function(d) {
					if (d.state == 0 && d.aaData[0].length > 0) {
						var htmlstr = "";
						if (b == "#md_Cityid" || b == "#zd_Cityid")
							htmlstr = '<option value="0">全部</option>';
						for (var i = 0; i < d.aaData[0].length; i++) {
							htmlstr += '<option value="' + d.aaData[0][i].AreaID + '">' + d.aaData[0][i].AreaName + '</option>';
						}
						$(b).html(htmlstr);
					} else {
						console.log("获取地区列表接口出错");
					}
				});
			}
			//是否包邮选择
			function radioClick(obj) {
				if ($(obj).val() == "2") {
					$(".ShippingDetails").show();
				} else if ($(obj).val() == "1") {
					$(".ShippingDetails").hide();
				} else if ($(obj).val() == "3") {
					$(".tj_1").text("件");
					$(".tj_2").text("件");
				} else if ($(obj).val() == "4") {
					$(".tj_1").text("kg");
					$(".tj_2").text("重");
				}
				setIframeHeight();
			}
			//运送方式
			function Deliverymodechoose(id) {
				if (id == 1) {
					if ($("#ck_kd").attr("checked") == 'checked') {
						if ($('input:radio[name="rad_isbaoyou"]:checked').val() == "2") {
							$("#kd_specialfreight").show();
						}
					} else {
						$("#kd_specialfreight").hide();
					}
				} else if (id == 2) {
					if ($("#ck_ems").attr("checked") == 'checked') {
						if ($('input:radio[name="rad_isbaoyou"]:checked').val() == "2") {
							$("#ems_specialfreight").show();
						}
					} else {
						$("#ems_specialfreight").hide();
					}
				} else if (id == 3) {
					if ($("#ck_py").attr("checked") == 'checked') {
						if ($('input:radio[name="rad_isbaoyou"]:checked').val() == "2") {
							$("#py_specialfreight").show();
						}
					} else {
						$("#py_specialfreight").hide();
					}
				} else if (id == 4) {
					if ($("#ck_zdtjby").attr("checked") == 'checked') {
						$("#kx_zdtjby").show();
					} else {
						$("#kx_zdtjby").hide();
					}
				}
				setIframeHeight();
			}
			//快递添加
			$("#btn_KDBatchShutdown").click(function() {
				$("#lbl_ysfs").val("kd");
				$('#myModal_Delivery').modal('show');
				//BindData("#kd");
			});
			//ems添加
			$("#btn_EMSBatchShutdown").click(function() {
				$("#lbl_ysfs").val("ems");
				$('#myModal_Delivery').modal('show');
				//BindData("#ems");
			});
			//平邮添加
			$("#btn_PYBatchShutdown").click(function() {
				$("#lbl_ysfs").val("py");
				$('#myModal_Delivery').modal('show');
				//BindData("#py");
			});
			//指定条件包邮
			$("#btn_KXBatchShutdown").click(function() {
				$('#myModal_Specific').modal('show');
				//ZDBindData("#zd");
			});
			//绑定数据
			var BindData = function(tab_type, da) {
					//var randomId = 10000 + ~~(Math.random() * 10000);
					$(tab_type).bootstrapTable('insertRow', {
						index: 1,
						row: {
							AreaName: da.AreaName,
							DefaultMinWeight: da.DefaultMinWeight,
							DefaultPrice: da.DefaultPrice,
							ContinuedWeight: da.ContinuedWeight,
							ContinuedPrice: da.ContinuedPrice,
							Id: da.Id
						}
					});
					setIframeHeight();
				}
				//指定条件包邮绑定数据
			var ZDBindData = function(tab_type, da) {
					//var randomId = 100 + ~~(Math.random() * 100);
					$(tab_type).bootstrapTable('insertRow', {
						index: 1,
						row: {
							AreaName: da.AreaName,
							DeliveryMode: da.DeliveryMode,
							CourierFirm: da.CourierFirm,
							FreeShippingTerm: da.FreeShippingTerm,
							MinWeight: da.MinWeight,
							MinPrice: da.MinPrice,
							Id: da.Id
						}
					});
					setIframeHeight();
				}
				//删除临时数据
			function DelData(id, type) {
				if (type == 1) {
					var duixiang = $("#kd").bootstrapTable('getRowByUniqueId', id);
					$("#kd").bootstrapTable('remove', {
						field: 'Id',
						values: [id]
					});
					MoveObj(kdarray, duixiang);
				} else if (type == 2) {
					var duixiang = $("#ems").bootstrapTable('getRowByUniqueId', id);
					$("#ems").bootstrapTable('remove', {
						field: 'Id',
						values: [id]
					});
					MoveObj(emsarray, duixiang);
				} else if (type == 3) {
					var duixiang = $("#py").bootstrapTable('getRowByUniqueId', id);
					$("#py").bootstrapTable('remove', {
						field: 'Id',
						values: [id]
					});
					MoveObj(pyarray, duixiang);
				} else if (type == 4) {
					var duixiang = $("#zd").bootstrapTable('getRowByUniqueId', id);
					$("#zd").bootstrapTable('remove', {
						field: 'Id',
						values: [id]
					});
					MoveObj(zdtjarray, duixiang);
				}
			}
			//绑定下拉列表
			function binddropdownlist() {
				getDataList(yshurl + "GetDropdownlistspecificconditions", {}, function(d) {
					if (d.state == 0 && d.many[0].length > 0) { //运送方式
						var htmlstr = ''; //'<option value="-1">全部</option>';
						for (var i = 0; i < d.many[0].length; i++) {
							htmlstr += '<option value="' + d.many[0][i].dictionaryID + '">' + d.many[0][i].datastatus + '</option>';
						}
						$("#zd_yunsongfangshi").html(htmlstr);
					}
					if (d.state == 0 && d.many[1].length > 0) { //快递
						var htmlstr = ''; //'<option value="-1">全部</option>';
						for (var i = 0; i < d.many[1].length; i++) {
							htmlstr += '<option value="' + d.many[1][i].dictionaryID + '">' + d.many[1][i].datastatus + '</option>';
						}
						$("#zd_kuaidi").html(htmlstr);
					}
					if (d.state == 0 && d.many[2].length > 0) { //包邮条件
						var htmlstr = ''; //'<option value="-1">全部</option>';
						for (var i = 0; i < d.many[2].length; i++) {
							htmlstr += '<option value="' + d.many[2][i].dictionaryID + '">' + d.many[2][i].datastatus + '</option>';
						}
						$("#zd_baoyoutiaojian").html(htmlstr);
					}
				});
			}
			//获取运输方式参数值
			function GetysfsParam() {
				var data = {
					Id: new Date().getTime(),
					AreaName: $("#md_StateProvinceId").find("option:selected").text() + $("#md_Cityid").find("option:selected").text(),
					md_StateProvinceId: $("#md_StateProvinceId").find("option:selected").val(),
					md_Cityid: $("#md_Cityid").find("option:selected").val(),
					DefaultMinWeight: $("#md_shouzhong").val(),
					DefaultPrice: $("#md_shoufei").val(),
					ContinuedWeight: $("#md_xuzhong").val(),
					ContinuedPrice: $("#md_xufei").val()
				};
				return data;
			}
			//获取特定条件参数值
			function GettdtjParam() {
				var data = {
					Id: new Date().getTime(),
					AreaName: $("#zd_StateProvinceId").find("option:selected").text() + $("#zd_Cityid").find("option:selected").text(),
					zd_StateProvinceId: $("#zd_StateProvinceId").find("option:selected").val(),
					zd_Cityid: $("#zd_Cityid").find("option:selected").val(),
					DeliveryMode: $("#zd_yunsongfangshi").find("option:selected").text(),
					DeliveryModeId: $("#zd_yunsongfangshi").find("option:selected").val(),
					CourierFirm: $("#zd_kuaidi").find("option:selected").text(),
					CourierFirmId: $("#zd_kuaidi").find("option:selected").val(),
					FreeShippingTerm: $("#zd_baoyoutiaojian").find("option:selected").text(),
					FreeShippingTermId: $("#zd_baoyoutiaojian").find("option:selected").val(),
					MinWeight: $("#zd_zuidizhongliang").val(),
					MinPrice: $("#zd_zuidijine").val()
				};
				return data;
			}
			//运送方式保存
			$("#btn_save").click(function() {
				$('#sub_form_ysfs').data('bootstrapValidator').validate();
				if ($("#sub_form_ysfs").data('bootstrapValidator').isValid()) {
					var ss = GetysfsParam();
					if ($("#lbl_ysfs").val() == "kd") {
						if (CheckIsRepeat(kdarray, ss, 1)) {
							ysh_alert("地址重复", "warning");
							return;
						}
						kdarray.push(ss);
						BindData("#kd", ss);
					} else if ($("#lbl_ysfs").val() == "ems") {
						if (CheckIsRepeat(emsarray, ss, 1)) {
							ysh_alert("地址重复", "warning");
							return;
						}
						emsarray.push(ss);
						BindData("#ems", ss);
					} else if ($("#lbl_ysfs").val() == "py") {
						if (CheckIsRepeat(pyarray, ss, 1)) {
							ysh_alert("地址重复", "warning");
							return;
						}
						pyarray.push(ss);
						BindData("#py", ss);
					}
					$('#myModal_Delivery').modal('hide');
				}
			});
			//特定条件保存
			$("#btn_zdsave").click(function() {
				$('#sub_form_zdtj').data('bootstrapValidator').validate();
				if ($("#sub_form_zdtj").data('bootstrapValidator').isValid()) {
					var bb = GettdtjParam();
					if (CheckIsRepeat(zdtjarray, bb, 2)) {
						ysh_alert("地址重复", "warning");
						return;
					}
					zdtjarray.push(bb);
					ZDBindData("#zd", bb);
					$('#myModal_Specific').modal('hide');
				}
			});
			//清空
			function Clear() {
				$("#md_shouzhong").val('');
				$("#md_shoufei").val('');
				$("#md_xuzhong").val('');
				$("#md_xufei").val('');
				$("#zd_zuidizhongliang").val(0);
				$("#zd_zuidijine").val(0);
			}
			$('#myModal_Delivery').on('hidden.bs.modal', function() {
				Clear();
			});
			$('#myModal_Specific').on('hidden.bs.modal', function() {
				Clear();
			});
			//移除数组中的对象
			function MoveObj(shuzu, duixiang) {
				var pIndex = $.inArray(duixiang, shuzu);
				shuzu.splice(pIndex, 1);
			}
			//判断重复
			function CheckIsRepeat(shuzu, duixiang, type) {
				if (type == 1) {
					for (var i = 0; i < shuzu.length; i++) {
						if (shuzu[i].md_StateProvinceId == duixiang.md_StateProvinceId && shuzu[i].md_Cityid == duixiang.md_Cityid) {
							return true;
						}
						if (shuzu[i].md_StateProvinceId == duixiang.md_StateProvinceId && shuzu[i].md_Cityid == '0') {
							return true;
						}
						if (shuzu[i].md_StateProvinceId == duixiang.md_StateProvinceId && duixiang.md_Cityid == '0') {
							return true;
						}
					}
				} else if (type == 2) {
					for (var i = 0; i < shuzu.length; i++) {
						if (shuzu[i].zd_StateProvinceId == duixiang.zd_StateProvinceId && shuzu[i].zd_Cityid == duixiang.zd_Cityid) {
							return true;
						}
						if (shuzu[i].zd_StateProvinceId == duixiang.zd_StateProvinceId && shuzu[i].zd_Cityid == '0') {
							return true;
						}
						if (shuzu[i].zd_StateProvinceId == duixiang.zd_StateProvinceId && duixiang.zd_Cityid == '0') {
							return true;
						}
					}
				}
				return false;
			}
			//保存数据
			$("#btn_SaveAll").click(function() {
				if ($("#txt_modelname").val() == '') {
					ysh_alert("模板名称不能为空", "warning");
					return;
				}
				if (CheckIsExist($("#txt_modelname").val())) {
					ysh_alert("模板名称重复", "warning");
					return;
				}
				var tempdata = {
					TempletName: $("#txt_modelname").val(),
					StateProvinceId: $("#StateProvinceId").find("option:selected").val(),
					Cityid: $("#Cityid").find("option:selected").val(),
					DistrictCounty: $("#DistrictCounty").find("option:selected").val(),
					Isbaoyou: $('input:radio[name="rad_isbaoyou"]:checked').val(),
					PricingMode: $('input:radio[name="rad_pricemode"]:checked').val() == '3' ? '2' : '1'
				};
				var itemdata = {
					kd: {
						mr: {
							DeliveryMode: $("#ck_kd").val(),
							DefaultMinWeight: $("#kd_DefaultMinWeight").val(),
							DefaultPrice: $("#kd_DefaultPrice").val(),
							ContinuedWeight: $("#kd_ContinuedWeight").val(),
							ContinuedPrice: $("#kd_ContinuedPrice").val(),
							AreaId: 0,
							IsDefault: 1
						},
						zd: kdarray
					},
					ems: {
						mr: {
							DeliveryMode: $("#ck_ems").val(),
							DefaultMinWeight: $("#ems_DefaultMinWeight").val(),
							DefaultPrice: $("#ems_DefaultPrice").val(),
							ContinuedWeight: $("#ems_ContinuedWeight").val(),
							ContinuedPrice: $("#ems_ContinuedPrice").val(),
							AreaId: 0,
							IsDefault: 1
						},
						zd: emsarray
					},
					py: {
						mr: {
							DeliveryMode: $("#ck_py").val(),
							DefaultMinWeight: $("#py_DefaultMinWeight").val(),
							DefaultPrice: $("#py_DefaultPrice").val(),
							ContinuedWeight: $("#py_ContinuedWeight").val(),
							ContinuedPrice: $("#py_ContinuedPrice").val(),
							AreaId: 0,
							IsDefault: 1
						},
						zd: pyarray
					}
				};
				//var IsBaoyou = $('input:radio[name="rad_isbaoyou"]:checked').val();
				if (tempdata.Isbaoyou == '1') { //包邮
					if ($("#ck_kd").attr("checked") == undefined && $("#ck_ems").attr("checked") == undefined && $("#ck_py").attr("checked") == undefined) {
						ysh_alert("请选一种运送方式", "warning");
						return;
					}
					//插入运费主模板
					var returnID = InsertMasterTemplate(tempdata); //(d.many[0][0])[0].InsertID;
					if (returnID > 0) { //插入运送方式（循环）只插入默认值
						if ($("#ck_kd").attr("checked") == 'checked') { //快递
							itemdata.kd.mr.TempId = returnID;
							//插入默认运费详情
							var returnItemID = InsertItemTemplate(itemdata.kd.mr);
						}
						if ($("#ck_ems").attr("checked") == 'checked') { //ems
							itemdata.ems.mr.TempId = returnID;
							//插入默认运费详情
							var returnItemID = InsertItemTemplate(itemdata.ems.mr);
						}
						if ($("#ck_py").attr("checked") == 'checked') { //平邮
							itemdata.py.mr.TempId = returnID;
							//插入默认运费详情
							var returnItemID = InsertItemTemplate(itemdata.py.mr);
						}
						//window.location.href = 'freightList.html';
					}
				} else if (tempdata.Isbaoyou == '2') { //自定义邮费
					if ($("#ck_kd").attr("checked") == undefined && $("#ck_ems").attr("checked") == undefined && $("#ck_py").attr("checked") == undefined) {
						ysh_alert("请选一种运送方式", "warning");
						return;
					}
					//插入运费主模板
					var returnID = InsertMasterTemplate(tempdata);
					if (returnID > 0) { //插入运送方式（循环）
						if ($("#ck_kd").attr("checked") == 'checked') { //快递
							itemdata.kd.mr.TempId = returnID;
							//插入默认运费详情
							var returnItemID = InsertItemTemplate(itemdata.kd.mr);
							//插入特定运费详情
							for (var i = 0; i < itemdata.kd.zd.length; i++) {
								var aa = itemdata.kd.zd;
								var bb = {
									DeliveryMode: $("#ck_kd").val(),
									DefaultMinWeight: aa[i].DefaultMinWeight,
									DefaultPrice: aa[i].DefaultPrice,
									ContinuedWeight: aa[i].ContinuedWeight,
									ContinuedPrice: aa[i].ContinuedPrice,
									AreaId: -1,
									TempId: returnID,
									IsDefault: 0
								}
								var zditemID = InsertItemTemplate(bb);
								if (zditemID > 0) { //插入指定运费地址
									var cc = {
										LogisItemId: zditemID,
										LogisItemType: 2,
										ProvinceId: aa[i].md_StateProvinceId,
										CityId: aa[i].md_Cityid
									}
									InsertLogisAreaMap(cc);
								}
							}
						}
						if ($("#ck_ems").attr("checked") == 'checked') { //ems
							itemdata.ems.mr.TempId = returnID;
							//插入默认运费详情
							var returnItemID = InsertItemTemplate(itemdata.ems.mr);
							//插入特定运费详情
							for (var i = 0; i < itemdata.ems.zd.length; i++) {
								var aa = itemdata.ems.zd;
								var bb = {
									DeliveryMode: $("#ck_ems").val(),
									DefaultMinWeight: aa[i].DefaultMinWeight,
									DefaultPrice: aa[i].DefaultPrice,
									ContinuedWeight: aa[i].ContinuedWeight,
									ContinuedPrice: aa[i].ContinuedPrice,
									AreaId: -1,
									TempId: returnID,
									IsDefault: 0
								}
								var zditemID = InsertItemTemplate(bb);
								if (zditemID > 0) { //插入指定运费地址
									var cc = {
										LogisItemId: zditemID,
										LogisItemType: 2,
										ProvinceId: aa[i].md_StateProvinceId,
										CityId: aa[i].md_Cityid
									}
									InsertLogisAreaMap(cc);
								}
							}
						}
						if ($("#ck_py").attr("checked") == 'checked') { //平邮
							itemdata.py.mr.TempId = returnID;
							//插入默认运费详情
							var returnItemID = InsertItemTemplate(itemdata.py.mr);
							//插入特定运费详情
							for (var i = 0; i < itemdata.py.zd.length; i++) {
								var aa = itemdata.py.zd;
								var bb = {
									DeliveryMode: $("#ck_py").val(),
									DefaultMinWeight: aa[i].DefaultMinWeight,
									DefaultPrice: aa[i].DefaultPrice,
									ContinuedWeight: aa[i].ContinuedWeight,
									ContinuedPrice: aa[i].ContinuedPrice,
									AreaId: -1,
									TempId: returnID,
									IsDefault: 0
								}
								var zditemID = InsertItemTemplate(bb);
								if (zditemID > 0) { //插入指定运费地址
									var cc = {
										LogisItemId: zditemID,
										LogisItemType: 2,
										ProvinceId: aa[i].md_StateProvinceId,
										CityId: aa[i].md_Cityid
									}
									InsertLogisAreaMap(cc);
								}
							}
						}
						//插入可选指定条件包邮
						if ($("#ck_zdtjby").attr("checked") == 'checked') {
							for (var i = 0; i < zdtjarray.length; i++) {
								var zdtjdata = {
									TempId: returnID,
									DeliveryMode: zdtjarray[i].DeliveryModeId,
									CourierFirm: zdtjarray[i].CourierFirmId,
									FreeShippingTerm: zdtjarray[i].FreeShippingTermId,
									MinWeight: zdtjarray[i].MinWeight,
									MinPrice: zdtjarray[i].MinPrice
								};
								var freeshipID = InsertIntoLogisFreeShipping(zdtjdata);
								if (freeshipID > 0) { //插入指定条件包邮地址
									var zddzdata = {
										LogisItemId: freeshipID,
										LogisItemType: 1,
										ProvinceId: zdtjarray[i].zd_StateProvinceId,
										CityId: zdtjarray[i].zd_Cityid
									};
									InsertLogisAreaMap(zddzdata);
								}
							}
						}
						//window.location.href = 'freightList.html';
					}
				}
				ysh_msg("保存成功", 1500, function() {
					window.location.href = 'freightList.html';
				});
			});
			//取消
			$("#btn_Cancle").click(function() {
					window.location.href = 'freightList.html';
				})
				//插入运费主要模板
			function InsertMasterTemplate(data) {
				var returnID = 0;
				getDataList(yshurl + "AM_InsertIntoOrd_LogisticalTemp", data, function(d) {
					returnID = (d.many[0][0])[0].InsertID;
				});
				return returnID;
			}
			//插入运费运送方式
			function InsertItemTemplate(data) {
				var returnID = 0;
				getDataList(yshurl + "AM_InsertOrd_LogisticalItem", data, function(d) {
					returnID = (d.many[0][0])[0].InsertID;
				});
				return returnID;
			}
			//插入运费选定地址
			function InsertLogisAreaMap(data) {
				var returnID = 0;
				getDataList(yshurl + "AM_InsertIntoOrd_Logis_Area_Map", data, function(d) {
					returnID = d.state;
				});
				return returnID;
			}
			//插入指定条件运费
			function InsertIntoLogisFreeShipping(data) {
				var returnID = 0;
				getDataList(yshurl + "AM_InsertIntoOrd_LogisFreeShipping", data, function(d) {
					returnID = (d.many[0][0])[0].InsertID;
				});
				return returnID;
			}
			//表单验证
			$('#sub_form_ysfs').bootstrapValidator({
				message: '错误',
				feedbackIcons: {
					valid: 'glyphicon glyphicon-ok',
					invalid: 'glyphicon glyphicon-remove',
					validating: 'glyphicon glyphicon-refresh'
				},
				fields: {
					md_shouzhong: {
						validators: {
							numeric: {
								message: '首重必须为数字'
							},
							notEmpty: {
								message: '首重不能为空'
							}
						}
					},
					md_shoufei: {
						validators: {
							numeric: {
								message: '首费必须为数字'
							},
							notEmpty: {
								message: '首费不能为空'
							}
						}
					},
					md_xuzhong: {
						validators: {
							numeric: {
								message: '续重必须为数字'
							},
							notEmpty: {
								message: '续重不能为空'
							}
						}
					},
					md_xufei: {
						validators: {
							numeric: {
								message: '续费必须为数字'
							},
							notEmpty: {
								message: '续费不能为空'
							}
						}
					}
				}
			});
			//表单验证
			$('#sub_form_zdtj').bootstrapValidator({
				message: '错误',
				feedbackIcons: {
					valid: 'glyphicon glyphicon-ok',
					invalid: 'glyphicon glyphicon-remove',
					validating: 'glyphicon glyphicon-refresh'
				},
				fields: {
					zd_zuidizhongliang: {
						validators: {
							numeric: {
								message: '最低重量必须为数字'
							},
							notEmpty: {
								message: '最低重量不能为空'
							}
						}
					},
					zd_zuidijine: {
						validators: {
							numeric: {
								message: '最低金额必须为数字'
							},
							notEmpty: {
								message: '最低金额不能为空'
							}
						}
					}
				}
			});
			$('#myModal_Delivery').on('hide.bs.modal', function() {
				$('#sub_form_ysfs').data('bootstrapValidator').resetForm();
			});
			$('#myModal_Specific').on('hide.bs.modal', function() {
				$('#sub_form_zdtj').data('bootstrapValidator').resetForm();
			});
			//判断模板名称是否重复
			function CheckIsExist(tempName) {
				var ret = false;
				getDataList(yshurl + "AM_CheckTempName", {
					TempletName: tempName //$("#txt_modelname").val()
				}, function(d) {
					if (d.aaData.length > 0)
						ret = true;
				});
				return ret;
			}
			//验证默认输入
			function CheckMRInput(obj) {
				var res = /^\d+(\.\d+)?$/;
				if (!res.test($(obj).val())) {
					ysh_alert("请输入非负数字", "warning");
					$(obj).val(1);
				}
			}
		</script>

	</body>

</html>