<!DOCTYPE html>
<html lang="en">

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
		<meta name="description" content="">
		<meta name="author" content="ThemeBucket">
		<link rel="shortcut icon" href="#" type="image/png">
		<link rel="stylesheet" type="text/css" href="js/bootstrap-datepicker/css/datepicker-custom.css" />
		<link rel="stylesheet" type="text/css" href="js/bootstrap-timepicker/css/timepicker.css" />
		<link rel="stylesheet" type="text/css" href="js/bootstrap-colorpicker/css/colorpicker.css" />
		<link rel="stylesheet" type="text/css" href="js/bootstrap-daterangepicker/daterangepicker-bs3.css" />
		<link rel="stylesheet" type="text/css" href="js/bootstrap-datetimepicker/css/datetimepicker-custom.css" />
		<title>溯源管理</title>
		<link href="css/style.css" rel="stylesheet">
		<link href="css/jquery.stepy.css" rel="stylesheet">
		<link href="css/style-responsive.css" rel="stylesheet">
		<link rel="stylesheet" href="js/control/css/zyUpload.css" type="text/css">
		<link href="css/bootstrapValidator.css" rel="stylesheet">
		<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
			  <script src="js/html5shiv.js"></script>
			  <script src="js/respond.min.js"></script>
			  <![endif]-->
		<!-- Placed js at the end of the document so the pages load faster -->
		<script src="js/jquery-1.10.2.min.js"></script>
		<script src="js/jquery-ui-1.9.2.custom.min.js"></script>
		<script src="js/jquery-migrate-1.2.1.min.js"></script>
		<script src="js/jquery.stepy.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/modernizr.min.js"></script>
		<script src="js/jquery.nicescroll.js"></script>

		<!--pickers plugins-->
		<script type="text/javascript" src="js/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
		<script type="text/javascript" src="js/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js"></script>
		<script type="text/javascript" src="js/bootstrap-daterangepicker/moment.min.js"></script>
		<script type="text/javascript" src="js/bootstrap-daterangepicker/daterangepicker.js"></script>
		<script type="text/javascript" src="js/bootstrap-colorpicker/js/bootstrap-colorpicker.js"></script>
		<script type="text/javascript" src="js/bootstrap-timepicker/js/bootstrap-timepicker.js"></script>
		<script type="text/javascript" src="js/bootstrapValidator.js"></script>
		<!--bootstrap Table-->
		<script src='js/bootstrap-table.js'></script>
		<script src='js/bootstrap-table-zh-CN.js'></script>
		<script src='js/bootstrap-editable.js'></script>
		<script src='js/bootstrap-table-editable.js'></script>

		<!--pickers initialization-->
		<script src="js/pickers-init.js"></script>

		<!--common scripts for all pages-->
		<script src="js/layer.js"></script>
		<script src="js/scripts.js"></script>
		<script src="js/ysh_comm.js"></script>
		<script src="js/MD5.js"></script>

		<script type="text/javascript" src="http://api.map.baidu.com/api?v=2.0&ak=M1y9cKcVm2bdLTYcve2cXooMu4mzkxno  "></script>
		<script src="http://api.map.baidu.com/library/MarkerTool/1.2/src/MarkerTool_min.js" type="text/javascript"></script>
		<script type="text/javascript" src="http://api.map.baidu.com/library/CityList/1.4/src/CityList_min.js"></script>
		<script type="text/javascript" src="js/tuodong.js"></script>
		<script src="js/adddate.js"></script>

		<script type="text/javascript">
			checkPermission();
		</script>
	</head>

	<body style="background: #EFF0F4;">
		<section>
			<div>
				<section class="panel">
					<div class="panel-body">
						<div class="page-heading">
							<h3>溯源管理</h3>
						</div>
					</div>
				</section>

				<section class="wrapper">
					<div class="row">
						<div class="col-md-12">
							<div class="square-widget">
								<div class="widget-container">
									<div class="stepy-tab">
									</div>
									<form id="default" class="form-horizontal" novalidate="novalidate">

										<fieldset title="产品详情">
											<legend>产品详情</legend>
											<!--<form id="product_form">-->
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">溯源码</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" id="SuyuanCode" name="SuyuanCode" readonly="readonly" class="form-control" />
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">产品名称</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" placeholder="产品名称" id="Goods_Name" name="Goods_Name" class="form-control" />

												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">产品品牌</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" placeholder="产品品牌" id="Productbrand" name="Productbrand" class="form-control" />
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">批次号</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" readonly="readonly" id="Batch_ID" name="Batch_ID" class="form-control" />
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">追溯信息认证机构/商户编码</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" readonly="readonly" id="Seller_ID" name="Seller_ID" class="form-control" />
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">生产日期/采摘日期</label>
												<div class="col-md-6 col-sm-6">
													<div data-date-viewmode="years" data-date-format="yyyy-mm-dd" data-date="2016-01-01" class="input-append date dpYears">
														<input type="text" readonly="" value="" size="16" class="form-control" id="ProductionDate" name="ProductionDate" />
														<span class="input-group-btn add-on">
                                                            <button class="btn btn-primary" type="button"><i class="fa fa-calendar"></i></button>
                                                          </span>
													</div>
												</div>
												<div class="col-md-2 col-sm-2">
													<div class="btn btn-primary" onclick="cleanDate('#ProductionDate')">清除日期</div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">保质期</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" id="ShelfLifeDate" name="ShelfLifeDate" class="form-control" />
												</div>
												<!--<div class="col-md-6 col-sm-6">
													<div data-date-viewmode="years" data-date-format="yyyy-mm-dd" data-date="2016-01-01" class="input-append date dpYears">
														<input type="text" readonly="" value="" size="16" class="form-control" id="ShelfLifeDate" name="ShelfLifeDate" />
														<span class="input-group-btn add-on">
                                                            <button class="btn btn-primary" type="button"><i class="fa fa-calendar"></i></button>
                                                         </span>
													</div>
												</div>
												<div class="col-md-2 col-sm-2">
													<div class="btn btn-primary" onclick="cleanDate('#ShelfLifeDate')">清除日期</div>
												</div>-->
											</div>
											<div id="show_message"></div>
											<!--</form>-->
										</fieldset>

										<fieldset title="生产基地">
											<legend>生产基地</legend>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">选择基地</label>
												<div class="col-md-6 col-sm-6">
													<select id="baseList" name="baseList" class="form-control">
														<option value="0">空</option>
													</select>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">基地名称</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" placeholder="基地名称" id="BaseName" name="BaseName" class="form-control" readonly="readonly" />
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">基地地址</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" placeholder="基地地址" id="BaseAdd" name="BaseAdd" class="form-control" readonly="readonly" />
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">基地类型</label>
												<div class="col-md-6 col-sm-6">
													<select id="BaseType" name="BaseType" class="form-control" disabled="disabled">
														<option value="0">空</option>
													</select>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">基地介绍</label>
												<div class="col-md-6 col-sm-6">
													<textarea style="resize: none;" rows="5" cols="60" placeholder="基地介绍" class="form-control" id="BaseContent" name="BaseContent" readonly="readonly"></textarea>
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<span class="col-md-2 col-sm-2 control-label">基地图片</span>
												<div class="col-md-6 col-sm-6">
													<div id="probase_Introduce">

													</div>
													<div id="jdjs">

													</div>
												</div>
												<div class="col-md-2 col-sm-2">
													<button id="jdjs_btn" type="button" disabled="disabled">上传基地图片</button>
												</div>
											</div>

										</fieldset>
										<fieldset title="生长环境">
											<legend>生长环境</legend>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">地块信息</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" id="BaseTab" name="BaseTab" class="form-control" readonly="readonly" />
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">所属农场</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" id="BaseFram" name="BaseFram" class="form-control" readonly="readonly" />
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">原产地</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" id="Provenance" name="Provenance" class="form-control" readonly="readonly" />
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<!--<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">天气/温度/空气质量</label>
												<div class="col-md-6 col-sm-6">
													<textarea  style="resize: none;" rows="5" cols="60" class="form-control" id="Atmosphere" name="Atmosphere"></textarea>
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>-->
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">日照</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" id="Sunshine" name="Sunshine" class="form-control" readonly="readonly" />
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">湿度</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" id="Humidity" name="Humidity" class="form-control" readonly="readonly" />
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">空气质量</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" id="Atmosphere" name="Atmosphere" class="form-control" readonly="readonly" />
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">气候特征</label>
												<div class="col-md-6 col-sm-6">
													<textarea style="resize: none;" rows="5" cols="60" class="form-control" id="Climate" name="Climate" readonly="readonly"></textarea>
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">地理位置经纬度</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" id="Coordinates" class="form-control" readonly="readonly" />
												</div>
												<div style="float: left;width: 5px; padding-left: 15px;">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
												<!--<tr>-->
												<!--<td>-->
												<!--<input type="button" value="开始标注" id="biaozhu" onclick="show()" disabled="disabled" style="width:100px;height:30px;">-->
												<!--</td>-->
												<!--</tr>-->
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label"></label>
												<div class="col-md-6 col-sm-6">
													<div id="allMap" style="width:100%;height:360px;overflow: hidden;margin:0 auto;font-family:'微软雅黑';">

													</div>
												</div>
												<div class="col-md-1 col-sm-1">

												</div>
											</div>

											<!--<div class="show_map">-->
											<!--<div id="show_map" style="width:786px;height:300px; margin-left: ;"></div>-->
											<!--<div id="drag">-->
											<!--<div class="title">-->
											<!--<h2>1.选择位置>2.标注位置>3.保存位置</h2>-->
											<!--<div>-->
											<!--<a class="max" href="javascript:;" title="最大化"></a>-->
											<!--<a class="revert" href="javascript:;" title="还原"></a>-->
											<!--<a class="close" href="javascript:;" title="关闭"></a>-->
											<!--</div>-->
											<!--</div>-->
											<!--<div class="content">-->
											<!--<div id="f_container">-->
											<!--<div id="container"></div>-->
											<!--</div>-->
											<!--<div id="allmap" style="width:596px;height:360px;"></div>-->
											<!--<div style="margin-top: 10px;text-align: right">-->
											<!--<input type="hidden" id="lat"> <input type="hidden" id="lng">-->
											<!--<input type="button" onclick="showMap();" class="btn" value="保存">-->
											<!--<input type="button" onclick="dhide()" class="btn" value="取消">-->
											<!--</div>-->
											<!--</div>-->
											<!--</div>-->
											<!--</div>-->
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">面积</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" id="Area" name="Area" class="form-control" readonly="readonly" />
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">承包人</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" id="Contractor" name="Contractor" class="form-control" readonly="readonly" />
												</div>
												<div class="col-md-1 col-sm-1">
													<div style="margin-left: -15px;font-size: 20px;"><span style="color: red;">*</span></div>
												</div>
											</div>
										</fieldset>
										<fieldset title="农残检测">
											<legend>农残检测</legend>
											<div class="form-group">
												<div class="row clearfix">
													<div class="col-xs-6">
														<p>生长期图片</p>
														<div id="grownPics_pic"></div>
														<div id="grownPics">

														</div>
													</div>
													<div class="col-xs-2">
														<button type="button" id="grow_btn">上传生长期图片</button>
													</div>
												</div>
												<div class="row clearfix">
													<div class="col-xs-6">
														<p>检测信息图片</p>
														<div id="jcPics_pic"></div>
														<div id="jcPics">

														</div>
													</div>
													<div class="col-xs-2">
														<button type="button" id="jc_btn">上传检测信息图片</button>
													</div>
													<!--<div class="col-xs-12">-->
														<!--<p>检测信息</p>-->
														<!--<img id="detecview" style="display:none;margin: 5px;width: 100px;height: 100px;" />-->
														<!--<input id="file_upload" type="file" accept=".gif, .jpeg, .png, .jpg" />-->
														<!--<div class="image_container">-->
															<!--<button type="button" id="saveImg">保存</button>-->
														<!--</div>-->
													<!--</div>-->
												</div>
												<div class="row">
													<div class="col-lg-12">
														<section class="panel">
															<div class="panel-heading">
																<div class="col-md-3 col-sm-3" style="text-align: left;">生产记录</div>
																<div class="text-right">
																	<button class="btn btn-success" type="button" id="btn_Add">添加</button>
																</div>
															</div>
															<div class="panel-body">
																<table id="bs" class="table table-striped table-condensed table-hover talbe-border">
																	<thead>
																		<tr>
																			<!--<th data-field="status" data-align="center" data-checkbox="true"></th>-->
																			<th data-field="RecordId" data-align="center">编号</th>
																			<th data-field="DateTime" data-align="center">日期(月)</th>
																			<th data-field="Suppliername" data-align="center">投入品</th>
																			<th data-field="brand" data-align="center">品牌</th>
																			<th data-field="Enterprise" data-align="center">厂家</th>
																			<th data-field="Consumption" data-align="center">用量/kg</th>
																			<th data-field="datastatus" data-align="center">记录类型</th>
																			<th data-field="Operation" data-align="center" data-formatter="operationFormatter">操作</th>
																		</tr>
																	</thead>
																</table>
															</div>
														</section>
													</div>

												</div>
											</div>
										</fieldset>

										<fieldset title="供应企业">
											<legend>供应企业</legend>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">企业名称</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" readonly="readonly" id="SellerName" name="SellerName" class="form-control" />
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">营业执照</label>
												<div class="col-md-6 col-sm-6">
													<img id="yyzzpic" style="width: 100px;height: 100px;">
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">联系方式</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" readonly="readonly" id="SellerTel" name="SellerTel" class="form-control" />
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">法人代表</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" readonly="readonly" id="SellerRepresent" name="SellerRepresent" class="form-control" />
												</div>
											</div>
										</fieldset>
										<fieldset title="注册商家">
											<legend>注册商家</legend>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">负责人</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" readonly="readonly" id="Legal_Represent" name="Legal_Represent" class="form-control" />
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">联系方式</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" readonly="readonly" id="Tel" name="Tel" class="form-control" />
												</div>
											</div>
											<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">联系地址</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" readonly="readonly" id="Addr" name="Addr" class="form-control" />
												</div>
											</div>
											<!--<div class="form-group">
												<label class="col-md-2 col-sm-2 control-label">邮箱</label>
												<div class="col-md-6 col-sm-6">
													<input type="text" readonly id="Email" name="Email" class="form-control" />
												</div>
											</div>-->
											<button type="button" class="btn btn-info finish" id="btn_finish">返回 </button>
										</fieldset>
									</form>
								</div>
							</div>
						</div>
					</div>
				</section>
				<!-- Modal -->
				<div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal" class="modal fade">
					<div class="modal-dialog">
						<div class="modal-content">
							<form id="sub_form">
								<div class="modal-header">
									<button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
									<h4 class="modal-title" id="tip_title">添加生产记录</h4>
								</div>
								<div class="modal-body">
									<div class="form-horizontal">
										<input type="hidden" name="RecordId" id="RecordId" />
										<div class="form-group ">
											<label for="SupplierId" class="control-label col-lg-3">名称</label>
											<div class="col-lg-8">
												<select class="form-control m-bot15" id="SupplierId" name="SupplierId">
												</select>
											</div>
										</div>
										<div class="form-group ">
											<label for="brand" class="control-label col-lg-3">品牌</label>
											<div class="col-lg-8">
												<input class="form-control " readonly="readonly" id="brand" name="brand" type="text" />
											</div>
										</div>
										<div class="form-group ">
											<label for="Enterprise" class="control-label col-lg-3">厂家</label>
											<div class="col-lg-8">
												<input class="form-control " readonly="readonly" id="Enterprise" name="Enterprise" type="text" />
											</div>
										</div>
										<div class="form-group ">
											<label for="Consumption" class="control-label col-lg-3">用量/kg</label>
											<div class="col-lg-8">
												<input class="form-control " maxlength="10" id="Consumption" name="Consumption" type="number" />
											</div>
										</div>
										<div class="form-group ">
											<label for="RecordClassId" class="control-label col-lg-3">记录类型</label>
											<div class="col-lg-8">
												<select class="form-control m-bot15" id="RecordClassId" name="RecordClassId"></select>
											</div>
										</div>
										<div class="form-group ">
											<label for="curl" class="control-label col-lg-3">投入日期(月)</label>
											<div class="col-lg-8">
												<!-- <div data-date-viewmode="years" data-date-format="yyyy-mm-dd" data-date="2016-01-01" class="input-append date dpYears">
													<input type="text" readonly="" value="" size="16" class="form-control" id="DateTime" name="DateTime" required>
													<span class="input-group-btn add-on">
                                                            <button class="btn btn-primary" type="button"><i class="fa fa-calendar"></i></button>
                                                          </span>
												</div> -->
													<input type="text" value="" size="16" class="form-control" id="DateTime" name="DateTime" required onclick="SelectDate(this,'yyyy-MM-dd')">

											</div>
										</div>
									</div>
								</div>
								<div class="modal-footer">
									<button type="button" class="btn btn-default" data-dismiss="modal" id="closeBtn">取消</button>
									<button type="button" class="btn btn-success" id="saveBtn">保存</button>
								</div>
							</form>
						</div>
					</div>
				</div>
				<!-- modal -->
			</div>
		</section>
		<script src="js/jquery.validate.min.js"></script>
		<!-- 引用核心层插件 -->
		<script type="text/javascript" src="js/core/zyFile.js"></script>
		<!-- 引用控制层插件 -->
		<script type="text/javascript" src="js/control/js/zyUpload.js"></script>
		<!-- 引用初始化JS -->
		<script type="text/javascript" src="js/zyUpload.js"></script>

		<script type="text/javascript" src="js/fill-form.js"></script>

		<script>
			var $table = $("#bs");
			var checkList = new Array();
			var data = [];
			var editdata = {};
			var stepIndex = 1; //页签索引
			function operationFormatter(value, row, index) {
				var result = [
					'<button type="button" onclick=edit(' + index + ') class="btn btn-info" >编辑</button>', '<button  type="button" class="btn btn-danger" onclick=del(' + index + ')>删除</button>'
				];
				return result.join(' ');
			}
			var ProbaseID = 0;
			var Batch_ID;
			var MerchantId;
			var inmarkinfoid = ysh_GetQueryString("inmarkinfoid");
			var onSelect = null;
			var onSuccess = null;
			var onFailure = null;
			var onComplete = null;
			var baseList = null;
			var baseInfo = null;
			//初始化加载
			$(document).ready(function() {
				
				$("#jdjs_btn").click(function() {
					$("#grow_btn").show();
					$("#grownPics").html('');
					$("#jdjs").append('<div id="zyUpload" class="zyUpload"></div>');
					$(this).hide();
					initZyUpload_jdjs();
					setIframeHeight();
				});
				

				function initZyUpload_jdjs() {
					ZYFILE.uploadFile = [];
					// 初始化插件
					$("#zyUpload").zyUpload({
						width: "800px", // 宽度
						height: "400px", // 宽度
						itemWidth: "100px", // 文件项的宽度
						itemHeight: "80px", // 文件项的高度
						url: "http://f.yshfresh.com/upload", // 上传文件的路径
						multiple: true, // 是否可以多个文件上传
						dragDrop: true, // 是否可以拖动上传文件
						del: true, // 是否可以删除文件
						finishDel: true // 是否在上传文件完成后删除预览
					});
					$(".upload_preview").css('overflow-y', 'scroll').css('max-height', '180px');
					// 选择文件的回调方法
					onSelect = function(files, allFiles) {
							//					alert("选中图片了:" + allFiles[0])
						}
						// 上传文件成功的回调方法
					onSuccess = function(file, response) {
							getDataList(yshurl + 'InsertPicture', {
								Picurl: JSON.parse(response).aaData[0].fileurl,
								PicType: 5,
								OwnId: ProbaseID
							}, function(res) {
								console.info(res);
							});
						}
						//上传文件失败的回调方法
					onFailure = function(file) {
							alert("上传图片失败了:" + file)
						}
						//上传文件完成的回调方法
					onComplete = function(responseInfo) {
						ysh_msg("图片上传完成");
					}
				}
				$("#grow_btn").click(function() {
					$("#jdjs_btn").show();
					$("#jdjs").html('');
					$("#grownPics").append('<div id="zyUpload" class="zyUpload"></div>');
					$(this).hide();
					initZyUpload_grows();
					setIframeHeight();
				});

				$("#jc_btn").click(function(){
					$("#jcPics").append('<div id="zyUpload_JC" class="zyUpload"></div>');
					$(this).hide();
					initZyUpload_jc();
					setIframeHeight();
				})
				function initZyUpload_jc(){
					ZYFILE.uploadFile = [];
					// 初始化插件
					$("#zyUpload_JC").zyUpload({
						width: "800px", // 宽度
						height: "400px", // 宽度
						itemWidth: "100px", // 文件项的宽度
						itemHeight: "80px", // 文件项的高度
						url: "http://f.yshfresh.com/upload", // 上传文件的路径
						multiple: true, // 是否可以多个文件上传
						dragDrop: true, // 是否可以拖动上传文件
						del: true, // 是否可以删除文件
						finishDel: true // 是否在上传文件完成后删除预览
					});
					$(".upload_preview").css('overflow-y', 'scroll').css('max-height', '180px');
					// 选择文件的回调方法
					onSelect = function(files, allFiles) {
						//					alert("选中图片了:" + allFiles[0])
					}
					// 上传文件成功的回调方法
					onSuccess = function(file, response) {
						getDataList(yshurl + 'InsertPicture', {
							Picurl: JSON.parse(response).aaData[0].fileurl,
							PicType: 7,
							OwnId: inmarkinfoid
						}, function(res) {
							console.info(res);
						});
					}
					//上传文件失败的回调方法
					onFailure = function(file) {
						alert("上传图片失败了:" + file)
					}
					//上传文件完成的回调方法
					onComplete = function(responseInfo) {
						//				alert("上传图片完成：" + JSON.stringify(responseInfo))
						ysh_msg("图片上传完成");
						getPic();
					}
				}
				function initZyUpload_grows() {
					ZYFILE.uploadFile = [];
					// 初始化插件
					$("#zyUpload").zyUpload({
						width: "800px", // 宽度
						height: "400px", // 宽度
						itemWidth: "100px", // 文件项的宽度
						itemHeight: "80px", // 文件项的高度
						url: "http://f.yshfresh.com/upload", // 上传文件的路径
						multiple: true, // 是否可以多个文件上传
						dragDrop: true, // 是否可以拖动上传文件
						del: true, // 是否可以删除文件
						finishDel: true // 是否在上传文件完成后删除预览
					});
					$(".upload_preview").css('overflow-y', 'scroll').css('max-height', '180px');
					// 选择文件的回调方法
					onSelect = function(files, allFiles) {
							//					alert("选中图片了:" + allFiles[0])
						}
						// 上传文件成功的回调方法
					onSuccess = function(file, response) {
							getDataList(yshurl + 'InsertPicture', {
								Picurl: JSON.parse(response).aaData[0].fileurl,
								PicType: 6,
								OwnId: inmarkinfoid
							}, function(res) {
								console.info(res);
							});
						}
						//上传文件失败的回调方法
					onFailure = function(file) {
							alert("上传图片失败了:" + file)
						}
						//上传文件完成的回调方法
					onComplete = function(responseInfo) {
						//				alert("上传图片完成：" + JSON.stringify(responseInfo))
						ysh_msg("图片上传完成");
						getPic();
					}
				}
				//初始化表格
				$table.bootstrapTable({
					pagination: true, //分页
					onCheck: function(row) {
						checkList.push(row.Id);
						$.unique(checkList);
					},
					onUncheck: function(row) {
						$.unique(checkList);
						var pIndex = $.inArray(row.Id, checkList);
						checkList.splice(pIndex, 1);
					},
					onCheckAll: function(rows) {
						$.each(rows, function(index) {
							checkList.push(rows[index].Id);
						});
						$.unique(checkList);
					},
					onUncheckAll: function(rows) {
						$.unique(checkList);
						var filterarray = $.grep(checkList, function(value) {
							var isDel = false;
							for(var i = 0; i < rows.length; i++) {
								if(rows[i] == value) {
									isDel = true;
									break;
								}
							}
							return !isDel;
						});
						checkList = filterarray;
					},
					escape: true,
					clickToSelect: true,
					pageList: [10]
				});
				//初始化下拉列表
				GetProSupplier(0);
				//获取溯源信息
				getDataList(yshurl + "GetSuyuanInfoByInmarkinfoId", {
					inmarkinfoid: inmarkinfoid
				}, function(res) {
					if(res && res.state == 0 && res.aaData) {
						if(res.aaData.length > 0) {
							$("#SuyuanCode").val(res.aaData[0].SuyuanCode);
							$("#Goods_Name").val(res.aaData[0].Goods_Name);
							$("#Productbrand").val(res.aaData[0].Productbrand);
							$("#Batch_ID").val(res.aaData[0].Batch_ID);
							$("#Seller_ID").val(res.aaData[0].Seller_ID);
							if(res.aaData[0].ProductionDate != "0000-00-00 00:00:00" && res.aaData[0].ShelfLifeDate != "1969-12-31T16:00:00.000Z") {
								$("#ProductionDate").val(new Date(res.aaData[0].ProductionDate).Format("yyyy-MM-dd"));
							} else {
								$("#ProductionDate").val("")
							}
							if(res.aaData[0].ShelfLifeDate != "0000-00-00 00:00:00" && res.aaData[0].ShelfLifeDate != "1969-12-31T16:00:00.000Z") {
								$("#ShelfLifeDate").val(res.aaData[0].ShelfLifeDate);
							} else {
								$("#ProductionDate").val("")
							}
							$("#SellerName").val(res.aaData[0].SellerName);
							$("#SellerTel").val(res.aaData[0].SellerTel);
							$("#SellerRepresent").val(res.aaData[0].SellerRepresent);
							$("#Legal_Represent").val(res.aaData[0].Legal_Represent);
							$("#Tel").val(res.aaData[0].Tel);
							$("#Addr").val(res.aaData[0].Addr);
//							ProbaseID = res.aaData[0].ProbaseID || 0
							Batch_ID = res.aaData[0].Batch_ID
							MerchantId = res.aaData[0].MerchantId1;
							getDataList(yshurl + 'GETMerchantProbaseList', {
								merchantid: MerchantId
							}, function(d) {
								baseList = d.aaData;
								if(baseList && baseList.length>0){
									ProbaseID = baseList[0].Id
								}
							}, true);
							getData();
							if(ProbaseID){
								getPic();
							}
						}
					} else {
						ysh_msg("服务器错误，请稍后再试");
					}
				});
				loadBaseList();
				$('#default').stepy({
					back: function(index) { //上一步操作
						//验证
						//						if (!checkFrom(stepIndex)) {
						//							return false;
						//						}
						//保存
						Save(stepIndex);
						stepIndex = index;
						setTimeout(function() {
							setIframeHeight();
						}, 300);
					},
					next: function(index) { //下一步操作
						if(!checkFrom(stepIndex)) {
							return false;
						}
						//保存
						Save(stepIndex);
						stepIndex = index;
						setIframeHeight();
						setTimeout(function() {
							setIframeHeight();
						}, 300);
					},
					backLabel: '上一步',
					block: true,
					nextLabel: '下一步',
					titleClick: true,
					titleTarget: '.stepy-tab'
				});
				$('#baseList').on('change', function() {
					ProbaseID = $(this).val();
					loadBaseInfo(ProbaseID);
				});
				setIframeHeight();
				//初始化结束
			});
			//加载基地列表
			function loadBaseList() {
				if(baseList && baseList.length > 0) {
					var opsHtml = '',
						baseId;
					for(var i = 0, l = baseList.length; i < l; i++) {
						opsHtml += '<option value="' + baseList[i].Id + '">' + baseList[i].BaseName + '</option>';
					}
					$('#baseList').html(opsHtml);
					$('#baseList').val(ProbaseID);
					if(ProbaseID){
						loadBaseInfo(ProbaseID);
					}
				}
			}

			function handleEmptyProperty(o) {
				for(var i in o) {
					if(!o[i]) {
						o[i] = '暂无';
					}
				}
				return o;
			}

			function loadMap(co) {
				$("#allMap").empty()
				var map = new BMap.Map("allMap");
				var coordi = co.split(",");
				var point = new BMap.Point(parseFloat(coordi[0]), parseFloat(coordi[1]));
				map.centerAndZoom(point, 15);
				var marker = new BMap.Marker(point);
				map.panBy(205, 165);
				map.addOverlay(marker);
			};
			//加载基地信息
			function loadBaseInfo(id) {
				getDataList(yshurl + 'GETProbaseInfobyId', {
					probaseid: id
				}, function(d) {
					if(d.many.length > 0 && d.many[0].length > 0) {
						baseInfo = d.many[0][0];
						baseInfo = handleEmptyProperty(baseInfo);
					}
				});
				if(baseInfo) {
					$("#BaseName").val(baseInfo.BaseName);
					$("#BaseAdd").val(baseInfo.BaseAdd);
					$("#BaseType").val(baseInfo.BaseType);
					$("#BaseContent").val(baseInfo.BaseContent);
					$("#BaseTab").val(baseInfo.BaseTab);
					$("#BaseFram").val(baseInfo.BaseFram);
					$("#Provenance").val(baseInfo.Provenance);
					$("#Sunshine").val(baseInfo.Sunshine);
					$("#Humidity").val(baseInfo.Humidity);
					$("#Atmosphere").val(baseInfo.Atmosphere);
					$("#Climate").val(baseInfo.Climate);
					$("#Coordinates").val(baseInfo.Coordinates);
					$("#Area").val(baseInfo.Area);
					$("#Contractor").val(baseInfo.Contractor);
					loadMap(baseInfo.Coordinates);
				}
				if(ProbaseID){
					getPic();
				}
			}
			//获取生产记录
			function getData() {
				getDataList(yshurl + "GetSuyuanRecordListByBacthId", {
					Batch_ID: Batch_ID
				}, function(d) {
					data = d.aaData;
					for(var i = 0; i < data.length; i++) {
						data[i].DateTime = new Date(data[i].DateTime).Format("yyyy-MM");
					}
					$table.bootstrapTable('load', d.aaData);
					setIframeHeight();
				});
			}
			//清空生产记录表单
			function clearEle() {
				$("#SupplierId").val(-1);
				$("#brand").val("");
				$("#Enterprise").val("");
				$("#Consumption").val("0");
				$("#RecordClassId")[0].selected = true;
				$("#DateTime").val('');
			}
			//获取生产记录表单数据
			function initEle(data) {
				$("#RecordId").val(data.RecordId);
				$("#SupplierId").val(data.SupplierId);
				$("#brand").val(data.brand);
				$("#Enterprise").val(data.Enterprise);
				$("#Consumption").val(data.Consumption);
				$("#RecordClassId").val(data.RecordClassId);
				$("#DateTime").val(data.DateTime);
			}
			//添加
			$("#btn_Add").click(function() {
				$("#saveBtn").attr("ekey", "add");
				clearEle();
				$('#myModal').modal('show');
			});
			$('#myModal').on('hidden.bs.modal', function() {
				clearEle();
			});
			$('#myModal').on('hide.bs.modal', function() {
				$('#sub_form').data('bootstrapValidator').resetForm();
			});
			//编辑
			function edit(index) {
				$("#saveBtn").attr("ekey", "edit");
				clearEle();
				editdata = data[index];
				initEle(editdata);
				$("#tip_title").text('编辑生产记录');
				$("#myModal").modal();
			}
			//删除生产记录
			function del(index) {
				ysh_confirm("确定要删除数据？", "是", "否", function(ret) {
					if(ret) {
						var RecordId = data[index].RecordId;
						getDataList(yshurl + "DelSuyuanRecord", {
							RecordId: RecordId
						}, function(res) {
							if(res && res.state == 0 && res.aaData) {
								ysh_msg("删除成功");
								getData();
							} else {
								ysh_msg("删除失败");
							}
						})
					}
				});
			}
			//保存生产记录
			$("#saveBtn").click(function() {
				$('#sub_form').data('bootstrapValidator').validate();
				if($("#sub_form").data('bootstrapValidator').isValid()) {
					var type = $(this).attr("ekey");
					var param = convertParams("sub_form");
					var nowTime = new Date()
					param.Batch_ID = Batch_ID;
					param.ProbaseID = ProbaseID;
					param.CreatePerson = 'zh';
					if(new Date(param.DateTime) <= nowTime) {
						param.DateTime = new Date(param.DateTime).Format("yyyy-MM-dd");
						if(type == 'add') {
							InsertSuyuanRecord(param);
						} else {
							UpdateSuyuanRecord(param);
						}
					} else {
						ysh_alert("投入日期不能大于当前时间！", "error")
					}
				}
			});
			//新增生产记录
			function InsertSuyuanRecord(param) {
				getDataList(yshurl + "InsertSuyuanRecord", param, function(res) {
					if(res && res.state == 0) {
						ysh_msg("添加成功");
						getData();
						$("#closeBtn").click();
					} else {
						ysh_msg("添加失败");
					}
				});
			}
			//修改生产记录
			function UpdateSuyuanRecord(param) {
				getDataList(yshurl + "UpdateSuyuanRecord", param, function(res) {
					if(res && res.state == 0) {
						ysh_msg("修改成功");
						getData();
						$("#closeBtn").click();
					} else {
						ysh_msg("修改失败");
					}
				});
			}
			//修改数据
			function Save(index) {

				if(index == 1) { //产品详情
					var da = {
						inmarkinfoid: inmarkinfoid,
						Goods_Name: $("#Goods_Name").val(),
						Productbrand: $("#Productbrand").val(),
						ProductionDate: $("#ProductionDate").val(),
						ShelfLifeDate: $("#ShelfLifeDate").val()
					}
					getDataList(yshurl + "UpdateSuyuanProductDetails", da, function(d) {
						if(d && d.state == 0) {} else {
							ysh_msg("修改失败");
						}
					});
				}
				if(index == 2 && ProbaseID) { //基地详情

					var da = {
						ProbaseID: ProbaseID,
						inmarkinfoid: inmarkinfoid,
						BaseName: $("#BaseName").val(),
						BaseAdd: $("#BaseAdd").val(),
						BaseType: $("#BaseType").val(),
						BaseContent: $("#BaseContent").val()
					}
					getDataList(yshurl + "UpdateSuyuanProductionBase", da, function(d) {
						console.log(d);
						if(d && d.state == 0) {
							ProbaseID = d.aaData[0][0].ProbaseID
						} else {
							ysh_msg("修改失败");
						}
					});
				}
				if(index == 3) { //生长环境
					var da = {
						ProbaseID: ProbaseID,
						BaseTab: $("#BaseTab").val(),
						BaseFram: $("#BaseFram").val(),
						Provenance: $("#Provenance").val(),
						Sunshine: $("#Sunshine").val(),
						Humidity: $("#Humidity").val(),
						Atmosphere: $("#Atmosphere").val(),
						Coordinates: $("#Coordinates").val(),
						Climate: $("#Climate").val(),
						Area: $("#Area").val(),
						Contractor: $("#Contractor").val(),
					}
					getDataList(yshurl + "UpdateSuyuanGrowthEnvironment", da, function(d) {
						console.log(d)
						if(d && d.state == 0) {} else {
							ysh_msg("修改失败");
						}
					});
				}
			}
			//验证数据
			function checkFrom(index) {
				switch(index) {
					case 1:
						var Goods_Name = $("#Goods_Name").val();
						//						var Productbrand = $("#Productbrand").val();
						var ProductionDate = $("#ProductionDate").val();
						var ShelfLifeDate = $("#ShelfLifeDate").val();
						if(Goods_Name == "") {
							ysh_msg("商品名称、生产日期、保质期不能为空!");
							return false;
						}
						if(ProductionDate && ShelfLifeDate) {
							if(Date.parse(ProductionDate) > new Date()) {
								ysh_msg("生产日期应该小于等于当前日期!");
								return false;
							}
						}
						break;
					case 2:
						var BaseName = $("#BaseName").val() || "";
						var BaseAdd = $("#BaseAdd").val();
						var BaseContent = $("#BaseContent").val();
						if(BaseName == "" || BaseAdd == "" || BaseContent == "") {
							ysh_msg("基地名称、基地地址、基地介绍不能为空!");
							return false;
						}
						break;
					case 3:
						var BaseTab = $("#BaseTab").val();
						var BaseFram = $("#BaseFram").val();
						var Provenance = $("#Provenance").val();
						var Sunshine = $("#Sunshine").val();
						var Humidity = $("#Humidity").val();
						var Atmosphere = $("#Atmosphere").val();
						var Climate = $("#Climate").val();
						var Coordinates = $("#Coordinates").val();
						var Area = $("#Area").val();
						var Contractor = $("#Contractor").val();
						if(BaseTab == "" || BaseFram == "" || Provenance == "" || Sunshine == "" || Humidity == "" || Atmosphere == "" || Climate == "" || Coordinates == "" || Area == "" || Contractor == "") {
							ysh_msg("地块信息、所属农场、原产地、日照、温度、空气质量、气候特征、地理位置、面积、承包人不能为空!");
							return false;
						}
						break;
					default:
				}
				return true;
			}
			var img_url = '';
			//获取所有图片
			function getPic() {
				getDataList(yshurl + "GetSuyuanInfoPictures", {
					ProbaseID: ProbaseID,
					inmarkinfoid: inmarkinfoid,
					MerchantId: MerchantId,
				}, function(res) {
					if(res && res.state == 0) {
						var pic5 = res.many[0].pic5;
						var imgHtml = createImgHtml(pic5)
						$("#probase_Introduce").html(imgHtml);
						var pic6 = res.many[1].pic6;
						imgHtml = createImgHtml(pic6);
						$("#grownPics_pic").empty()
						$("#grownPics_pic").append(imgHtml);
						var pic7 = res.many[2].pic7;
						if(pic7.length > 0) {
							var imgHtml2 = createImgHtml(pic7);
							$("#jcPics_pic").empty()
							$("#jcPics_pic").append(imgHtml2);
//							$("#detecview").attr("src", "http://f.yshfresh.com" + pic7[0].Picurl).show();
						}
						var pic9 = res.many[3].pic9;
						if(pic9.length > 0)
							$("#yyzzpic").attr("src", "http://f.yshfresh.com" + pic9[0].Picurl).show();
					}
				});
			}
			//显示图片
			function createImgHtml(data) {
				var html = '';
				for(var i = 0; i < data.length; i++) {
					if(data[i].Picurl){
						html += '<img  style="width:100px;height:100px;margin: 5px;" src="' + "http://f.yshfresh.com" + data[i].Picurl + '">';
					}
				}
				return html;
			}
			//绑定图片
			upLoadHeadImg("file_upload", "detecview", 100, 100, function(data) {
				if(data) {
					getDataList("http://f.yshfresh.com/upload/base64", {
						img: data
					}, function(d) {
						var index = d.aaData[0].indexOf('/');
						console.log(d.aaData[0].substring(index));
						img_url = d.aaData[0].substring(index);
						$("#detecview").attr("src", "http://f.yshfresh.com" + d.aaData[0].substring(index)).show();
					});
				}
			});
			$("#btn_finish").click(function() {
				window.location.href = 'Admin_TraceabilityManagement.html'
			})

			function GetProSupplier(SupplierId) {
				getDataList(yshurl + 'GetProSupplier', {
					pId: SupplierId
				}, function(res) {
					var selObj = $("#SupplierId");
					var optionstr = "<option value=\"-1\" brand = \"\" Enterprise = \"\">请选择投入品</option>";
					for(var i = 0; i < res.many[0].length; i++) {
						optionstr += "<option value=\"" + res.many[0][i].Id + "\" brand = \"" + res.many[0][i].Brand + "\" Enterprise = \"" + res.many[0][i].Enterprise + "\" >" + res.many[0][i].Suppliername + "</option>";
					}
					selObj.html(optionstr);
					$("#SupplierId").change(function() {
						$("#brand").val($(this).children('option:selected').attr("brand"));
						$("#Enterprise").val($(this).children('option:selected').attr("Enterprise"));
					});
					var optionstr1 = "";
					for(var i = 0; i < res.many[1].length; i++) {
						optionstr1 += '<option value="' + res.many[1][i].RecordClassId + '">' + res.many[1][i].datastatus + '</option>';
					}
					$("#RecordClassId").append(optionstr1);
					optionstr1 = "";
					for(var i = 0; i < res.many[2].length; i++) {
						optionstr1 += '<option value="' + res.many[2][i].BaseTypeId + '">' + res.many[2][i].datastatus + '</option>';
					}
					$("#BaseType").append(optionstr1);
				});
			}

			//保存图片
			$("#saveImg").click(function() {
					if(img_url == "") {
						ysh_alert("你还没有添加图片!")
					} else {
						getDataList(yshurl + 'InsertPicture', {
							Picurl: img_url,
							PicType: 7,
							OwnId: inmarkinfoid
						}, function(res) {
							ysh_msg("图片上传成功!")
						});
					}
				})
				//表单验证
			$(function() {
				$('#sub_form').bootstrapValidator({
					message: 'This value is not valid',
					feedbackIcons: {
						valid: 'glyphicon glyphicon-ok',
						invalid: 'glyphicon glyphicon-remove',
						validating: 'glyphicon glyphicon-refresh'
					},
					submitHandler: function(validator, form, submitButton) {
						// Do nothing
					},
					fields: {
						Consumption: {
							validators: {
								notEmpty: {
									message: '用量不能为空'
								},
								regexp: {
									regexp: /^[0-9]+(.[0-9]+)?$/,
									message: '请输入有效的数字'
								}
							}
						},
						DateTime: {
							validators: {
								notEmpty: {
									message: '日期不能为空'
								}
							}
						}
					}
				});
			})

			function cleanDate(str) {
				$(str).val('')
			}
		</script>
		<!--<script type="text/javascript">-->
		<!--var marker, oDrag = document.getElementById("drag");-->
		<!--// 百度地图API功能-->
		<!--var map = new BMap.Map("allmap"); // 创建Map实例-->
		<!--map.enableScrollWheelZoom(true);-->
		<!--map.addControl(new BMap.ScaleControl({-->
		<!--anchor: BMAP_ANCHOR_BOTTOM_RIGHT-->
		<!--})); // 右下比例尺-->
		<!--map.setDefaultCursor("Crosshair"); //鼠标样式-->
		<!--map.addControl(new BMap.NavigationControl({-->
		<!--anchor: BMAP_ANCHOR_TOP_RIGHT-->
		<!--})); //右上角，仅包含平移和缩放按钮-->
		<!--var cityList = new BMapLib.CityList({-->
		<!--container: 'container',-->
		<!--map: map-->
		<!--});-->
		<!--map.addEventListener("click", showInfo);-->

		<!--function showInfo(e) {-->
		<!--map.clearOverlays();-->
		<!--marker = new BMap.Marker(new BMap.Point(e.point.lng, e.point.lat)); // 创建标注-->
		<!--map.addOverlay(marker);-->
		<!--//获取经纬度-->
		<!--document.getElementById("lng").value = e.point.lng;-->
		<!--document.getElementById("lat").value = e.point.lat;-->
		<!--document.getElementById("Coordinates").value = e.point.lng + "," + e.point.lat-->
		<!--}-->

		<!--function show() {-->
		<!--map.centerAndZoom('成都', 12); // 初始化地图,设置城市和地图级别。-->
		<!--oDrag.style.display = "block";-->
		<!--}-->

		<!--function dhide() {-->
		<!--map.clearOverlays();-->
		<!--document.getElementById("lng").value = '';-->
		<!--document.getElementById("lat").value = '';-->
		<!--oDrag.style.display = "none";-->
		<!--}-->

		<!--function showMap() {-->
		<!--oDrag.style.display = "none";-->
		<!--var map1 = new BMap.Map("show_map");-->
		<!--var lng = document.getElementById("lng").value;-->
		<!--var lat = document.getElementById("lat").value;-->
		<!--map1.centerAndZoom(new BMap.Point(lng, lat), map.getZoom());-->
		<!--var marker1 = new BMap.Marker(new BMap.Point(lng, lat)); // 创建标注-->
		<!--map1.addOverlay(marker1); // 将标注添加到地图中-->
		<!--}-->
		<!--</script>-->
	</body>

</html>