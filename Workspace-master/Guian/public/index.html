<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>源生汇</title>
    <link rel='icon' href='favicon.ico' mce_href='favicon.ico' type='image/x-icon'>
    <link rel='shortcut icon' href='favicon.ico' mce_href='favicon.ico' type='image/x-icon'>
    <link href="lib/css/animate.css" rel="stylesheet">
    <link rel="stylesheet" href="lib/css/bootstrap.min.css" />
    <link rel="stylesheet" href="lib/css/main.css" />
    <link rel="stylesheet" href="lib/css/zm.css" />
    <link rel="stylesheet" href="lib/css/jquery.flipcountdown.css" />
  </head>
  <body style="width: 100%;height: 100%;">
    <div id="app"></div>
    <div class="touch_div">
      <p id="smPopName"></p>
      <p id="smPopnm"></p>
      <p id="smPopcy"></p>
      <p id="smPopjg"></p>
      <p id="smPopsx"></p>
    </div>
    <div id="mask"></div>    
    <script src="lib/js/jquery.js"></script>
    <!-- <script src="lib/js/echarts.min.js"></script> -->
    <script src="//cdn.bootcss.com/echarts/3.3.0/echarts.min.js"></script>
    <script src="lib/js/data.js"></script>
    <script src="lib/js/jquery.flipcountdown.js"></script>
    <!-- <script src="lib/js/laytpl.js"></script> -->
    <script>
      var config = {
        gaxq: {
          scroll1:{},
          scroll2:{},
          scroll3:{},
          flag:true,
          scrollPro: {},
          scrollProList2: {},
          scrollProList1: {},
          scrollCop: {},
          scrollCopList1: {},
          scrollCopList2: {},
          scrollData: {},
          scrollDataList1: {},
          scrollDataList2: {}
        },
        index: {
          scroll1: {},
          scrollCop: {},
          scrollCopList: {}
        },
        chaye: {
          scroll1: {},
          scrollData: {},
          scrollDataList1: {}
        },
        fsk: {
          scroll1: {},
          scrollData: {},
          scrollDataList1: {}
        },
        barWidth: 20,
        charts: {
          // sydsjyChart: {
          //   // legend: {
          //   //     data: ['公司', '交易数'],
          //   //     // align: 'left',
          //   //     orient: 'horizontal',
          //   //     x: 'center',
          //   //     y: 'top',
          //   //     textStyle: {
          //   //       color: '#ffffff'
          //   //     }
          //   // },
            // grid: {
            //     left: '3%',
            //     right: '4%',
            //     bottom: '4%',
            //     containLabel: true
            // },
          //   barWidth: 10,
          //   tooltip: {},
          //   xAxis: {
          //       data: [1,2,3,4,5,6,7,8,9,10,11,12],
          //       silent: false,
          //       splitLine: {
          //           show: false
          //       },
          //       axisLine: {
          //         lineStyle: {
          //             color: '#fff'
          //         }
          //       }
          //   },
          //   yAxis: {
          //       axisLine: {
          //         lineStyle: {
          //             color: '#fff'
          //         }
          //       }
          //   },
          //   series: [
          //     // {
          //     //     name: '公司',
          //     //     type: 'bar',
          //     //     data: [],
          //     //     animationDelay: function (idx) {
          //     //         return idx * 10;
          //     //     },
          //     //     itemStyle: {
          //     //       normal: {
          //     //         color: function(value) {
          //     //            if(value.data<=200){                   
          //     //                 return '#e9751b'
          //     //            }else if(value.data>200 && value.data<=300){
          //     //                 return '#f92572'
          //     //            }else if(value.data>300 && value.data<=400){
          //     //                 return '#d3b4d3'
          //     //            }else if(value.data>400 && value.data<=500){
          //     //                 return '#e48fb3'
          //     //            }else if(value.data>500 && value.data<=600){
          //     //                 return '#d0b5cf'
          //     //            }else if(value.data>600 && value.data<=700){
          //     //                 return '#1b67ca'
          //     //            }
          //     //         }
          //     //       }
          //     //     }
          //     // }, 
          //     {
          //       name: '交易数',
          //       type: 'bar',
          //       data: [],
          //       animationDelay: function (idx) {
          //           return idx * 10 + 100;
          //       },
          //       itemStyle: {
          //         normal: {
          //           color: function(value) {
          //               switch (value.dataIndex)
          //               {
          //                 case 0:
          //                   return '#e7751f'
          //                   break;
          //                 case 1:
          //                   return '#f82471'
          //                   break;
          //                 case 2:
          //                   return '#2caa1b'
          //                   break;
          //                 case 3:
          //                   return '#4daee3'
          //                   break;
          //               case 4:
          //                   return '#f3cb1c'
          //                   break;
          //                 case 5:
          //                   return '#d4b2d3'
          //                   break;
          //                 case 6:
          //                   return '#1c65cb'
          //                   break;
          //                 case 7:
          //                   return '#e48eb3'
          //                   break;
          //                 case 8:
          //                   return '#3e1a6c'
          //                   break;
          //               case 9:
          //                   return '#a2d355'
          //                   break;
          //                 case 10:
          //                   return '#d1b4d0'
          //                   break;
          //                 case 11:
          //                   return '#861ba5'
          //                   break;
          //                 case 12:
          //                   return '#196910'
          //                   break;
          //               }
          //             }
          //         }
          //       }
          //     }
          //   ],
          //   animationEasing: 'elasticOut',
          //   animationDelayUpdate: function (idx) {
          //       return idx * 5;
          //   }
          // }
          sydsjyChart: {
            title : {
              
            },
            tooltip : {
                trigger: 'axis'
            },
            legend: {
                data:['公司','交易数'],
                y: 'top', // 'center' | 'bottom' | {number}
                    textStyle: {color: '#fff'},
            },
            grid: {
                left: '3%',
                right: '4%',
                bottom: '4%',
                containLabel: true
            },
            calculable : true,
            xAxis : [
                {
                    type : 'category',
                    boundaryGap : false,
                    data : [1,2,3,4,5,6,7,8,9,10,11,12],
                    axisLabel: {
                            show: true,
                            textStyle: {
                                color: '#fff'
                            }
                        }
                }
            ],
            yAxis : [
                {
                    type : 'value',
                    axisLabel: {
                            show: true,
                            textStyle: {
                                color: '#fff'
                            }
                        }
                }
            ],
            series : [              
                {
                    name:'公司',
                    type:'line',
                    smooth:true,
                    itemStyle: {normal: {areaStyle: {type: 'default'}, color: '#db811e'}},      
                    data:[10, 12, 21, 54, 260, 830, 710]
                },
                {
                    name:'交易数',
                    type:'line',
                    smooth:true,
                    itemStyle: {normal: {areaStyle: {type: 'default'}, color: '#4dace9'}},
                    data:[30, 182, 434, 791, 390, 330, 410]
                }
            ]
          }
        },
        issmPopShow: false
      }
      function getDataList(url, param, fcs, is_check) {
        var sesskey = window.localStorage.getItem("sesskey") || null
        if (sesskey)
          sesskey = JSON.parse(sesskey)
        if (!sesskey && url.indexOf('getSesskey') == -1) {
          getDataList("http://api2.yshfresh.com/api/ysh/" + 'getSesskey', {}, function(rd) {
            if (rd.sesskey) {
              sesskey = rd.sesskey;
              localStorage.setItem("sesskey", JSON.stringify(sesskey))
              getDataList(url, param, fcs, is_check);
            } else {
              alert('获取sesskey失败');
            }
          });
          return;
        }
        var pa = {};
        for (k in param) {
          pa[k] = param[k];
        }
        pa.sesskey = sesskey;

        $.ajax({
          type: "post",
          url: url,
          async: false,
          data: pa,
          success: function(ret) {
            if (ret.log&&ret.log != "") {
              console.info(ret.log);
            }
            if (ret.state == 401) {
              window.localStorage.removeItem("sesskey")
              getDataList(url, param, fcs, is_check);
            }
            if (ret.state != 0) {
              console.log('错误码：' + ret.state + '\n' + JSON.stringify(ret.msg));
            }
            var str = ret;
            if (Object.prototype.toString.call(str) === "[object String]") {
              try {
                ret = JSON.parse(ret)
              } catch (e) {
                console.log("无法解析服务器返回数据")
                console.log("捕获异常为：  " + e)
              }
            }

            //校验数据
            if (is_check == true) {
              if (ret) {
                switch (ret.state) {
                  case 0:
                    //正常数据
                    if (ret.aaData && ret.aaData instanceof Array) {
                      fcs && fcs(ret);
                    } else {
                      alert("数据异常")
                    }
                    break;
                    case 1:
                    //需要登录
                    
                    break;
                    case 2:
                    //权限不足
                    
                    break;
                  }
                } else {
                  alert("服务器无响应，请稍后再试")
                }
              } else {
                fcs && fcs(ret);
              }
            },
          error: function() {
          }
        })
      }
      function setmiddle(els){
        for(var i = 0, l = els.length; i < l; i++){
          els[i].each(function(index, el) {
            var ph = $(el).parent().height()
            $(el).height(ph)
            $(el).css('line-height', ph + 'px') 
          })          
        }           
      }
      function Marquee(demo, demo1) {

        var deH = demo1.offsetHeight;
        if(demo.scrollTop >= deH) {
          demo.scrollTop = 0;
        } else {
          demo.scrollTop++
        }
      }
      function showPopup(){
        var popup = document.getElementById("popup");
        $(popup).stop().animate({
          height: "toggle",
          width: "toggle"
        });
      }          
      function showMask() {
        document.getElementById("mask").style.display = "block";
      }
      function Showtouch_div(t, l, name) {
        var touch_div = document.getElementsByClassName("touch_div")[0];
        touch_div.style.display = "block";
        
        // touch_div.css({top:t+10,left:l+10});
        touch_div.style.left = l + 10 + "px";
        touch_div.style.top = t + 10 + "px";
        $('#smPopName').text(name)
        if(name == '马场镇'){
          $('#smPopnm').text('农贸市场：02家')
          $('#smPopcy').text('餐饮门店：32家')
          $('#smPopjg').text('机构学校：13家')
          $('#smPopsx').text('生鲜门店：08家')
        }else{
          $('#smPopnm').text('农贸市场：05家')
          $('#smPopcy').text('餐饮门店：36家')
          $('#smPopjg').text('机构学校：17家')
          $('#smPopsx').text('生鲜门店：08家')
        }        
        config.issmPopShow = true
      }
      function closesmPop(){
        $('.touch_div').hide()
        $('#smPopName').text('')
        $('#smPopnm').text('')
        $('#smPopcy').text('')
        $('#smPopjg').text('')
        $('#smPopsx').text('')
        config.issmPopShow = false
      }
      Date.prototype.Format = function (fmt) { //author: meizz 
        var o = {
            "M+": this.getMonth() + 1, //月份 
            "d+": this.getDate(), //日 
            "h+": this.getHours(), //小时 
            "m+": Math.floor(this.getMinutes()*Math.random()), //分 
            "s+": this.getSeconds(), //秒 
            "q+": Math.floor((this.getMonth() + 3) / 3), //季度 
            "S": this.getMilliseconds() //毫秒 
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in o)
        if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        return fmt;
      }
    </script>
    <script src="dist/build.js"></script>
  </body>
</html>
<script>
  $(function(){ 
    $(document).on('click', '.show-sm-pop', function(event) {
      event.preventDefault();
      var name = $(this).data('name')
      Showtouch_div(event.clientY, event.clientX, name)
    });
    $(document).click(function(event){
      if(config.issmPopShow && event.target.className != 'show-sm-pop'){
        closesmPop()
      }
    })
  })
</script>


