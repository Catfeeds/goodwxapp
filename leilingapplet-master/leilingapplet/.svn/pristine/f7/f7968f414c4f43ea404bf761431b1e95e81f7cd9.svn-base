<?php
namespace app\index\controller;
use app\index\model\CarModel ;
use app\index\model\Configuration;
use app\index\model\City;
use app\index\model\Dealer;
use think\Request;
class Car extends Base{

	/**
	 * [getCar 获取试驾车的详情]
	 * @return [type] [description]
	 */
	public function getCar()
	{
		
		$id = input('param.car_model_id');//车型id
		$city = input('param.city');//所在城市
		$response = array();
		$car = new CarModel();
		$carinfo = $car->get($id);//车型详情
		// dump($car->getLastSql());
		// $response['getcarsql'] = $car->getLastSql();
		// dump($carinfo);
		$response['carinfo'] = $carinfo;
		$configuration = new Configuration();
		$configurationinfo = $configuration->all(['car_model_id'=>$id]);//车型配置
		// dump($configurationinfo);
		$response['configurationinfo'] = $configurationinfo;
		$cityModel = new City();
		$citycode = $cityModel->get(['city_name'=>$city])['city_code'];//地理信息城市码
		// dump($citycode);
		$response['citycode'] = $citycode;
		$dealer = new Dealer();
		$dealerinfo = $dealer->all(['dealer_city_code'=>$citycode]);//4s店的地理信息详情
		// dump($dealerinfo);
		$response['dealerinfo'] = $dealerinfo;
		exit(json_encode($response));
	}

	
}