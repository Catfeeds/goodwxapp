<?php

class Model_AppConfig extends PhalApi_Model_NotORM {

    protected function getTableName($id) {
        return 'app_config';
    }

    public function getAppConfig($os) {
        $os = (int)$os;
        //$config = $this->getORM()->select('config')->where('os',$os)->fetchOne();
        $config = $this->getORM()->where('os',$os)->or('os', 3)->fetchAll();
        if(!empty($config)) {
            foreach($config as &$per) {
                if(!$per['event']) {
                    $per['event'] = "";
                }
                if(!$per['event_data']) {
                    $per['event_data'] = 0;
                }
                if(!$per['detail']) {
                    $per['detail'] = 0;
                }
            }
        }

        return $config;
    }

    public function getPayType($os) {
        $os = (int)$os;
        $config_list = $this->getORM()->where('os', $os)->where('event = "pay_type" or event = "is_auditing"')
            ->fetchAll();
        $pay['pay_type'] = '1,2';
        $pay['is_auditing'] = '0';
        foreach($config_list as $config) {
            if($config['event'] == 'pay_type') {
                $pay['pay_type'] = $config['event_data'];
            }
            if($config['event'] == 'is_auditing') {
                $pay['is_auditing'] = $config['event_data'];
            }
        }

        return $pay;
    }






}
